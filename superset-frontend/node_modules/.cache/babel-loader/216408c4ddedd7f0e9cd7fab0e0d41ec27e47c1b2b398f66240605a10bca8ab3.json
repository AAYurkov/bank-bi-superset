{"ast":null,"code":"import _omit from \"lodash/omit\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();function _EMOTION_STRINGIFIED_CSS_ERROR__() {return \"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop).\";}var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\n\nimport { Input } from 'src/components/Input';\nimport { FormItem } from 'src/components/Form';\nimport jsonStringify from 'json-stringify-pretty-compact';\nimport Button from 'src/components/Button';\nimport { AntdForm, AsyncSelect, Col, Row } from 'src/components';\nimport rison from 'rison';\nimport { ensureIsArray, isFeatureEnabled, FeatureFlag, getCategoricalSchemeRegistry, styled, SupersetClient, t, getClientErrorObject, css } from '@superset-ui/core';\nimport Modal from 'src/components/Modal';\nimport { JsonEditor } from 'src/components/AsyncAceEditor';\nimport ColorSchemeControlWrapper from 'src/dashboard/components/ColorSchemeControlWrapper';\nimport FilterScopeModal from 'src/dashboard/components/filterscope/FilterScopeModal';\nimport withToasts from 'src/components/MessageToasts/withToasts';\nimport { fetchTags, OBJECT_TYPES } from 'src/features/tags/tags';\nimport { loadTags } from 'src/components/Tags/utils';\nimport { applyColors, getColorNamespace, getFreshLabelsColorMapEntries } from 'src/utils/colorScheme';\nimport getOwnerName from 'src/utils/getOwnerName';\nimport { useDispatch } from 'react-redux';\nimport { setColorScheme, setDashboardMetadata } from 'src/dashboard/actions/dashboardState';\nimport { areObjectsEqual } from 'src/reduxUtils';import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"@emotion/react/jsx-runtime\";\nconst StyledFormItem = styled(FormItem)`\n  margin-bottom: 0;\n`;\nconst StyledJsonEditor = styled(JsonEditor)`\n  border-radius: ${({ theme }) => theme.borderRadius}px;\n  border: 1px solid ${({ theme }) => theme.colors.secondary.light2};\n`;var _ref = process.env.NODE_ENV === \"production\" ? { name: \"1blj7km\", styles: \"margin-top:1em\" } : { name: \"1gtq0eh-PropertiesModal\", styles: \"margin-top:1em;label:PropertiesModal;/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9hcnl1cmtvdi9zdXBlcnNldC9zdXBlcnNldC1mcm9udGVuZC9zcmMvZGFzaGJvYXJkL2NvbXBvbmVudHMvUHJvcGVydGllc01vZGFsL2luZGV4LnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUEwY2tCIiwiZmlsZSI6Ii9Vc2Vycy9hcnl1cmtvdi9zdXBlcnNldC9zdXBlcnNldC1mcm9udGVuZC9zcmMvZGFzaGJvYXJkL2NvbXBvbmVudHMvUHJvcGVydGllc01vZGFsL2luZGV4LnRzeCIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9uIChBU0YpIHVuZGVyIG9uZVxuICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlXG4gKiBkaXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvblxuICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZVxuICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZVxuICogXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlXG4gKiB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsXG4gKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhblxuICogXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcbiAqIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZVxuICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9uc1xuICogdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmltcG9ydCB7IHVzZUNhbGxiYWNrLCB1c2VFZmZlY3QsIHVzZU1lbW8sIHVzZVJlZiwgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBvbWl0IH0gZnJvbSAnbG9kYXNoJztcbmltcG9ydCB7IElucHV0IH0gZnJvbSAnc3JjL2NvbXBvbmVudHMvSW5wdXQnO1xuaW1wb3J0IHsgRm9ybUl0ZW0gfSBmcm9tICdzcmMvY29tcG9uZW50cy9Gb3JtJztcbmltcG9ydCBqc29uU3RyaW5naWZ5IGZyb20gJ2pzb24tc3RyaW5naWZ5LXByZXR0eS1jb21wYWN0JztcbmltcG9ydCBCdXR0b24gZnJvbSAnc3JjL2NvbXBvbmVudHMvQnV0dG9uJztcbmltcG9ydCB7IEFudGRGb3JtLCBBc3luY1NlbGVjdCwgQ29sLCBSb3cgfSBmcm9tICdzcmMvY29tcG9uZW50cyc7XG5pbXBvcnQgcmlzb24gZnJvbSAncmlzb24nO1xuaW1wb3J0IHsgZW5zdXJlSXNBcnJheSwgaXNGZWF0dXJlRW5hYmxlZCwgRmVhdHVyZUZsYWcsIGdldENhdGVnb3JpY2FsU2NoZW1lUmVnaXN0cnksIHN0eWxlZCwgU3VwZXJzZXRDbGllbnQsIHQsIGdldENsaWVudEVycm9yT2JqZWN0LCBjc3MsIH0gZnJvbSAnQHN1cGVyc2V0LXVpL2NvcmUnO1xuaW1wb3J0IE1vZGFsIGZyb20gJ3NyYy9jb21wb25lbnRzL01vZGFsJztcbmltcG9ydCB7IEpzb25FZGl0b3IgfSBmcm9tICdzcmMvY29tcG9uZW50cy9Bc3luY0FjZUVkaXRvcic7XG5pbXBvcnQgQ29sb3JTY2hlbWVDb250cm9sV3JhcHBlciBmcm9tICdzcmMvZGFzaGJvYXJkL2NvbXBvbmVudHMvQ29sb3JTY2hlbWVDb250cm9sV3JhcHBlcic7XG5pbXBvcnQgRmlsdGVyU2NvcGVNb2RhbCBmcm9tICdzcmMvZGFzaGJvYXJkL2NvbXBvbmVudHMvZmlsdGVyc2NvcGUvRmlsdGVyU2NvcGVNb2RhbCc7XG5pbXBvcnQgd2l0aFRvYXN0cyBmcm9tICdzcmMvY29tcG9uZW50cy9NZXNzYWdlVG9hc3RzL3dpdGhUb2FzdHMnO1xuaW1wb3J0IHsgZmV0Y2hUYWdzLCBPQkpFQ1RfVFlQRVMgfSBmcm9tICdzcmMvZmVhdHVyZXMvdGFncy90YWdzJztcbmltcG9ydCB7IGxvYWRUYWdzIH0gZnJvbSAnc3JjL2NvbXBvbmVudHMvVGFncy91dGlscyc7XG5pbXBvcnQgeyBhcHBseUNvbG9ycywgZ2V0Q29sb3JOYW1lc3BhY2UsIGdldEZyZXNoTGFiZWxzQ29sb3JNYXBFbnRyaWVzLCB9IGZyb20gJ3NyYy91dGlscy9jb2xvclNjaGVtZSc7XG5pbXBvcnQgZ2V0T3duZXJOYW1lIGZyb20gJ3NyYy91dGlscy9nZXRPd25lck5hbWUnO1xuaW1wb3J0IHsgdXNlRGlzcGF0Y2ggfSBmcm9tICdyZWFjdC1yZWR1eCc7XG5pbXBvcnQgeyBzZXRDb2xvclNjaGVtZSwgc2V0RGFzaGJvYXJkTWV0YWRhdGEsIH0gZnJvbSAnc3JjL2Rhc2hib2FyZC9hY3Rpb25zL2Rhc2hib2FyZFN0YXRlJztcbmltcG9ydCB7IGFyZU9iamVjdHNFcXVhbCB9IGZyb20gJ3NyYy9yZWR1eFV0aWxzJztcbmNvbnN0IFN0eWxlZEZvcm1JdGVtID0gc3R5bGVkKEZvcm1JdGVtKSBgXG4gIG1hcmdpbi1ib3R0b206IDA7XG5gO1xuY29uc3QgU3R5bGVkSnNvbkVkaXRvciA9IHN0eWxlZChKc29uRWRpdG9yKSBgXG4gIGJvcmRlci1yYWRpdXM6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuYm9yZGVyUmFkaXVzfXB4O1xuICBib3JkZXI6IDFweCBzb2xpZCAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmNvbG9ycy5zZWNvbmRhcnkubGlnaHQyfTtcbmA7XG5jb25zdCBQcm9wZXJ0aWVzTW9kYWwgPSAoeyBhZGRTdWNjZXNzVG9hc3QsIGFkZERhbmdlclRvYXN0LCBjb2xvclNjaGVtZTogY3VycmVudENvbG9yU2NoZW1lLCBkYXNoYm9hcmRJZCwgZGFzaGJvYXJkSW5mbzogY3VycmVudERhc2hib2FyZEluZm8sIGRhc2hib2FyZFRpdGxlLCBvbkhpZGUgPSAoKSA9PiB7IH0sIG9ubHlBcHBseSA9IGZhbHNlLCBvblN1Ym1pdCA9ICgpID0+IHsgfSwgc2hvdyA9IGZhbHNlLCB9KSA9PiB7XG4gICAgY29uc3QgZGlzcGF0Y2ggPSB1c2VEaXNwYXRjaCgpO1xuICAgIGNvbnN0IFtmb3JtXSA9IEFudGRGb3JtLnVzZUZvcm0oKTtcbiAgICBjb25zdCBbaXNMb2FkaW5nLCBzZXRJc0xvYWRpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuICAgIGNvbnN0IFtpc0FkdmFuY2VkT3Blbiwgc2V0SXNBZHZhbmNlZE9wZW5dID0gdXNlU3RhdGUoZmFsc2UpO1xuICAgIGNvbnN0IFtjb2xvclNjaGVtZSwgc2V0Q3VycmVudENvbG9yU2NoZW1lXSA9IHVzZVN0YXRlKGN1cnJlbnRDb2xvclNjaGVtZSk7XG4gICAgY29uc3QgW2pzb25NZXRhZGF0YSwgc2V0SnNvbk1ldGFkYXRhXSA9IHVzZVN0YXRlKCcnKTtcbiAgICBjb25zdCBbZGFzaGJvYXJkSW5mbywgc2V0RGFzaGJvYXJkSW5mb10gPSB1c2VTdGF0ZSgpO1xuICAgIGNvbnN0IFtvd25lcnMsIHNldE93bmVyc10gPSB1c2VTdGF0ZShbXSk7XG4gICAgY29uc3QgW3JvbGVzLCBzZXRSb2xlc10gPSB1c2VTdGF0ZShbXSk7XG4gICAgY29uc3Qgc2F2ZUxhYmVsID0gb25seUFwcGx5ID8gdCgnQXBwbHknKSA6IHQoJ1NhdmUnKTtcbiAgICBjb25zdCBbdGFncywgc2V0VGFnc10gPSB1c2VTdGF0ZShbXSk7XG4gICAgY29uc3QgY2F0ZWdvcmljYWxTY2hlbWVSZWdpc3RyeSA9IGdldENhdGVnb3JpY2FsU2NoZW1lUmVnaXN0cnkoKTtcbiAgICBjb25zdCBvcmlnaW5hbERhc2hib2FyZE1ldGFkYXRhID0gdXNlUmVmKHt9KTtcbiAgICBjb25zdCB0YWdzQXNTZWxlY3RWYWx1ZXMgPSB1c2VNZW1vKCgpID0+IHtcbiAgICAgICAgY29uc3Qgc2VsZWN0VGFncyA9IHRhZ3MubWFwKCh0YWcpID0+ICh7XG4gICAgICAgICAgICB2YWx1ZTogdGFnLmlkLFxuICAgICAgICAgICAgbGFiZWw6IHRhZy5uYW1lLFxuICAgICAgICB9KSk7XG4gICAgICAgIHJldHVybiBzZWxlY3RUYWdzO1xuICAgIH0sIFt0YWdzLmxlbmd0aF0pO1xuICAgIGNvbnN0IGhhbmRsZUVycm9yUmVzcG9uc2UgPSBhc3luYyAocmVzcG9uc2UpID0+IHtcbiAgICAgICAgY29uc3QgeyBlcnJvciwgc3RhdHVzVGV4dCwgbWVzc2FnZSB9ID0gYXdhaXQgZ2V0Q2xpZW50RXJyb3JPYmplY3QocmVzcG9uc2UpO1xuICAgICAgICBsZXQgZXJyb3JUZXh0ID0gZXJyb3IgfHwgc3RhdHVzVGV4dCB8fCB0KCdBbiBlcnJvciBoYXMgb2NjdXJyZWQnKTtcbiAgICAgICAgaWYgKHR5cGVvZiBtZXNzYWdlID09PSAnb2JqZWN0JyAmJiAnanNvbl9tZXRhZGF0YScgaW4gbWVzc2FnZSkge1xuICAgICAgICAgICAgZXJyb3JUZXh0ID0gbWVzc2FnZS5qc29uX21ldGFkYXRhO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiBtZXNzYWdlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgZXJyb3JUZXh0ID0gbWVzc2FnZTtcbiAgICAgICAgICAgIGlmIChtZXNzYWdlID09PSAnRm9yYmlkZGVuJykge1xuICAgICAgICAgICAgICAgIGVycm9yVGV4dCA9IHQoJ1lvdSBkbyBub3QgaGF2ZSBwZXJtaXNzaW9uIHRvIGVkaXQgdGhpcyBkYXNoYm9hcmQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBNb2RhbC5lcnJvcih7XG4gICAgICAgICAgICB0aXRsZTogdCgnRXJyb3InKSxcbiAgICAgICAgICAgIGNvbnRlbnQ6IGVycm9yVGV4dCxcbiAgICAgICAgICAgIG9rQnV0dG9uUHJvcHM6IHsgZGFuZ2VyOiB0cnVlLCBjbGFzc05hbWU6ICdidG4tZGFuZ2VyJyB9LFxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIGNvbnN0IGxvYWRBY2Nlc3NPcHRpb25zID0gdXNlQ2FsbGJhY2soKGFjY2Vzc1R5cGUgPSAnb3duZXJzJywgaW5wdXQgPSAnJywgcGFnZSwgcGFnZVNpemUpID0+IHtcbiAgICAgICAgY29uc3QgcXVlcnkgPSByaXNvbi5lbmNvZGUoe1xuICAgICAgICAgICAgZmlsdGVyOiBpbnB1dCxcbiAgICAgICAgICAgIHBhZ2UsXG4gICAgICAgICAgICBwYWdlX3NpemU6IHBhZ2VTaXplLFxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIFN1cGVyc2V0Q2xpZW50LmdldCh7XG4gICAgICAgICAgICBlbmRwb2ludDogYC9hcGkvdjEvZGFzaGJvYXJkL3JlbGF0ZWQvJHthY2Nlc3NUeXBlfT9xPSR7cXVlcnl9YCxcbiAgICAgICAgfSkudGhlbihyZXNwb25zZSA9PiAoe1xuICAgICAgICAgICAgZGF0YTogcmVzcG9uc2UuanNvbi5yZXN1bHRcbiAgICAgICAgICAgICAgICAuZmlsdGVyKChpdGVtKSA9PiBpdGVtLmV4dHJhLmFjdGl2ZSAhPT0gdW5kZWZpbmVkID8gaXRlbS5leHRyYS5hY3RpdmUgOiB0cnVlKVxuICAgICAgICAgICAgICAgIC5tYXAoKGl0ZW0pID0+ICh7XG4gICAgICAgICAgICAgICAgdmFsdWU6IGl0ZW0udmFsdWUsXG4gICAgICAgICAgICAgICAgbGFiZWw6IGl0ZW0udGV4dCxcbiAgICAgICAgICAgIH0pKSxcbiAgICAgICAgICAgIHRvdGFsQ291bnQ6IHJlc3BvbnNlLmpzb24uY291bnQsXG4gICAgICAgIH0pKTtcbiAgICB9LCBbXSk7XG4gICAgY29uc3QgaGFuZGxlRGFzaGJvYXJkRGF0YSA9IHVzZUNhbGxiYWNrKGRhc2hib2FyZERhdGEgPT4ge1xuICAgICAgICBjb25zdCB7IGlkLCBkYXNoYm9hcmRfdGl0bGUsIHNsdWcsIGNlcnRpZmllZF9ieSwgY2VydGlmaWNhdGlvbl9kZXRhaWxzLCBvd25lcnMsIHJvbGVzLCBtZXRhZGF0YSwgaXNfbWFuYWdlZF9leHRlcm5hbGx5LCB9ID0gZGFzaGJvYXJkRGF0YTtcbiAgICAgICAgY29uc3QgZGFzaGJvYXJkSW5mbyA9IHtcbiAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgdGl0bGU6IGRhc2hib2FyZF90aXRsZSxcbiAgICAgICAgICAgIHNsdWc6IHNsdWcgfHwgJycsXG4gICAgICAgICAgICBjZXJ0aWZpZWRCeTogY2VydGlmaWVkX2J5IHx8ICcnLFxuICAgICAgICAgICAgY2VydGlmaWNhdGlvbkRldGFpbHM6IGNlcnRpZmljYXRpb25fZGV0YWlscyB8fCAnJyxcbiAgICAgICAgICAgIGlzTWFuYWdlZEV4dGVybmFsbHk6IGlzX21hbmFnZWRfZXh0ZXJuYWxseSB8fCBmYWxzZSxcbiAgICAgICAgICAgIG1ldGFkYXRhLFxuICAgICAgICB9O1xuICAgICAgICBmb3JtLnNldEZpZWxkc1ZhbHVlKGRhc2hib2FyZEluZm8pO1xuICAgICAgICBzZXREYXNoYm9hcmRJbmZvKGRhc2hib2FyZEluZm8pO1xuICAgICAgICBzZXRPd25lcnMob3duZXJzKTtcbiAgICAgICAgc2V0Um9sZXMocm9sZXMpO1xuICAgICAgICBzZXRDdXJyZW50Q29sb3JTY2hlbWUobWV0YWRhdGEuY29sb3Jfc2NoZW1lKTtcbiAgICAgICAgY29uc3QgbWV0YURhdGFDb3B5ID0gb21pdChtZXRhZGF0YSwgW1xuICAgICAgICAgICAgJ3Bvc2l0aW9ucycsXG4gICAgICAgICAgICAnc2hhcmVkX2xhYmVsX2NvbG9ycycsXG4gICAgICAgICAgICAnbWFwX2xhYmVsX2NvbG9ycycsXG4gICAgICAgICAgICAnY29sb3Jfc2NoZW1lX2RvbWFpbicsXG4gICAgICAgIF0pO1xuICAgICAgICBzZXRKc29uTWV0YWRhdGEobWV0YURhdGFDb3B5ID8ganNvblN0cmluZ2lmeShtZXRhRGF0YUNvcHkpIDogJycpO1xuICAgICAgICBvcmlnaW5hbERhc2hib2FyZE1ldGFkYXRhLmN1cnJlbnQgPSBtZXRhZGF0YTtcbiAgICB9LCBbZm9ybV0pO1xuICAgIGNvbnN0IGZldGNoRGFzaGJvYXJkRGV0YWlscyA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICAgICAgc2V0SXNMb2FkaW5nKHRydWUpO1xuICAgICAgICAvLyBXZSBmZXRjaCB0aGUgZGFzaGJvYXJkIGRldGFpbHMgYmVjYXVzZSBub3QgYWxsIGNvZGVcbiAgICAgICAgLy8gdGhhdCByZW5kZXJzIHRoaXMgY29tcG9uZW50IGhhdmUgYWxsIHRoZSB2YWx1ZXMgd2UgbmVlZC5cbiAgICAgICAgLy8gQXQgc29tZSBwb2ludCB3aGVuIHdlIGhhdmUgYSBtb3JlIGNvbnNpc3RlbnQgZnJvbnRlbmRcbiAgICAgICAgLy8gZGF0YW1vZGVsLCB0aGUgZGFzaGJvYXJkIGNvdWxkIHByb2JhYmx5IGp1c3QgYmUgcGFzc2VkIGFzIGEgcHJvcC5cbiAgICAgICAgU3VwZXJzZXRDbGllbnQuZ2V0KHtcbiAgICAgICAgICAgIGVuZHBvaW50OiBgL2FwaS92MS9kYXNoYm9hcmQvJHtkYXNoYm9hcmRJZH1gLFxuICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGRhc2hib2FyZCA9IHJlc3BvbnNlLmpzb24ucmVzdWx0O1xuICAgICAgICAgICAgY29uc3QganNvbk1ldGFkYXRhT2JqID0gZGFzaGJvYXJkLmpzb25fbWV0YWRhdGE/Lmxlbmd0aFxuICAgICAgICAgICAgICAgID8gSlNPTi5wYXJzZShkYXNoYm9hcmQuanNvbl9tZXRhZGF0YSlcbiAgICAgICAgICAgICAgICA6IHt9O1xuICAgICAgICAgICAgaGFuZGxlRGFzaGJvYXJkRGF0YSh7XG4gICAgICAgICAgICAgICAgLi4uZGFzaGJvYXJkLFxuICAgICAgICAgICAgICAgIG1ldGFkYXRhOiBqc29uTWV0YWRhdGFPYmosXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHNldElzTG9hZGluZyhmYWxzZSk7XG4gICAgICAgIH0sIGhhbmRsZUVycm9yUmVzcG9uc2UpO1xuICAgIH0sIFtkYXNoYm9hcmRJZCwgaGFuZGxlRGFzaGJvYXJkRGF0YV0pO1xuICAgIGNvbnN0IGdldEpzb25NZXRhZGF0YSA9ICgpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGpzb25NZXRhZGF0YU9iaiA9IGpzb25NZXRhZGF0YT8ubGVuZ3RoXG4gICAgICAgICAgICAgICAgPyBKU09OLnBhcnNlKGpzb25NZXRhZGF0YSlcbiAgICAgICAgICAgICAgICA6IHt9O1xuICAgICAgICAgICAgcmV0dXJuIGpzb25NZXRhZGF0YU9iajtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoXykge1xuICAgICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBoYW5kbGVPbkNoYW5nZU93bmVycyA9IChvd25lcnMpID0+IHtcbiAgICAgICAgY29uc3QgcGFyc2VkT3duZXJzID0gZW5zdXJlSXNBcnJheShvd25lcnMpLm1hcChvID0+ICh7XG4gICAgICAgICAgICBpZDogby52YWx1ZSxcbiAgICAgICAgICAgIGZ1bGxfbmFtZTogby5sYWJlbCxcbiAgICAgICAgfSkpO1xuICAgICAgICBzZXRPd25lcnMocGFyc2VkT3duZXJzKTtcbiAgICB9O1xuICAgIGNvbnN0IGhhbmRsZU9uQ2hhbmdlUm9sZXMgPSAocm9sZXMpID0+IHtcbiAgICAgICAgY29uc3QgcGFyc2VkUm9sZXMgPSBlbnN1cmVJc0FycmF5KHJvbGVzKS5tYXAociA9PiAoe1xuICAgICAgICAgICAgaWQ6IHIudmFsdWUsXG4gICAgICAgICAgICBuYW1lOiByLmxhYmVsLFxuICAgICAgICB9KSk7XG4gICAgICAgIHNldFJvbGVzKHBhcnNlZFJvbGVzKTtcbiAgICB9O1xuICAgIGNvbnN0IGhhbmRsZU93bmVyc1NlbGVjdFZhbHVlID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBwYXJzZWRPd25lcnMgPSAob3duZXJzIHx8IFtdKS5tYXAoKG93bmVyKSA9PiAoe1xuICAgICAgICAgICAgdmFsdWU6IG93bmVyLmlkLFxuICAgICAgICAgICAgbGFiZWw6IGdldE93bmVyTmFtZShvd25lciksXG4gICAgICAgIH0pKTtcbiAgICAgICAgcmV0dXJuIHBhcnNlZE93bmVycztcbiAgICB9O1xuICAgIGNvbnN0IGhhbmRsZVJvbGVzU2VsZWN0VmFsdWUgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHBhcnNlZFJvbGVzID0gKHJvbGVzIHx8IFtdKS5tYXAoKHJvbGUpID0+ICh7XG4gICAgICAgICAgICB2YWx1ZTogcm9sZS5pZCxcbiAgICAgICAgICAgIGxhYmVsOiBgJHtyb2xlLm5hbWV9YCxcbiAgICAgICAgfSkpO1xuICAgICAgICByZXR1cm4gcGFyc2VkUm9sZXM7XG4gICAgfTtcbiAgICBjb25zdCBoYW5kbGVPbkNhbmNlbCA9ICgpID0+IG9uSGlkZSgpO1xuICAgIGNvbnN0IG9uQ29sb3JTY2hlbWVDaGFuZ2UgPSAoY29sb3JTY2hlbWUgPSAnJywgeyB1cGRhdGVNZXRhZGF0YSA9IHRydWUgfSA9IHt9KSA9PiB7XG4gICAgICAgIC8vIGNoZWNrIHRoYXQgY29sb3Jfc2NoZW1lIGlzIHZhbGlkXG4gICAgICAgIGNvbnN0IGNvbG9yQ2hvaWNlcyA9IGNhdGVnb3JpY2FsU2NoZW1lUmVnaXN0cnkua2V5cygpO1xuICAgICAgICBjb25zdCBqc29uTWV0YWRhdGFPYmogPSBnZXRKc29uTWV0YWRhdGEoKTtcbiAgICAgICAgLy8gb25seSBmaXJlIGlmIHRoZSBjb2xvcl9zY2hlbWUgaXMgcHJlc2VudCBhbmQgaW52YWxpZFxuICAgICAgICBpZiAoY29sb3JTY2hlbWUgJiYgIWNvbG9yQ2hvaWNlcy5pbmNsdWRlcyhjb2xvclNjaGVtZSkpIHtcbiAgICAgICAgICAgIE1vZGFsLmVycm9yKHtcbiAgICAgICAgICAgICAgICB0aXRsZTogdCgnRXJyb3InKSxcbiAgICAgICAgICAgICAgICBjb250ZW50OiB0KCdBIHZhbGlkIGNvbG9yIHNjaGVtZSBpcyByZXF1aXJlZCcpLFxuICAgICAgICAgICAgICAgIG9rQnV0dG9uUHJvcHM6IHsgZGFuZ2VyOiB0cnVlLCBjbGFzc05hbWU6ICdidG4tZGFuZ2VyJyB9LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBvbkhpZGUoKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQSB2YWxpZCBjb2xvciBzY2hlbWUgaXMgcmVxdWlyZWQnKTtcbiAgICAgICAgfVxuICAgICAgICBqc29uTWV0YWRhdGFPYmouY29sb3Jfc2NoZW1lID0gY29sb3JTY2hlbWU7XG4gICAgICAgIGpzb25NZXRhZGF0YU9iai5sYWJlbF9jb2xvcnMgPSBqc29uTWV0YWRhdGFPYmoubGFiZWxfY29sb3JzIHx8IHt9O1xuICAgICAgICBzZXRDdXJyZW50Q29sb3JTY2hlbWUoY29sb3JTY2hlbWUpO1xuICAgICAgICBkaXNwYXRjaChzZXRDb2xvclNjaGVtZShjb2xvclNjaGVtZSkpO1xuICAgICAgICAvLyB1cGRhdGUgbWV0YWRhdGEgdG8gbWF0Y2ggc2VsZWN0aW9uXG4gICAgICAgIGlmICh1cGRhdGVNZXRhZGF0YSkge1xuICAgICAgICAgICAgc2V0SnNvbk1ldGFkYXRhKGpzb25TdHJpbmdpZnkoanNvbk1ldGFkYXRhT2JqKSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IG9uRmluaXNoID0gKCkgPT4ge1xuICAgICAgICBjb25zdCB7IHRpdGxlLCBzbHVnLCBjZXJ0aWZpZWRCeSwgY2VydGlmaWNhdGlvbkRldGFpbHMgfSA9IGZvcm0uZ2V0RmllbGRzVmFsdWUoKTtcbiAgICAgICAgbGV0IGN1cnJlbnRKc29uTWV0YWRhdGEgPSBqc29uTWV0YWRhdGE7XG4gICAgICAgIC8vIHZhbGlkYXRlIGN1cnJlbnRKc29uTWV0YWRhdGFcbiAgICAgICAgbGV0IG1ldGFkYXRhO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKCFjdXJyZW50SnNvbk1ldGFkYXRhLnN0YXJ0c1dpdGgoJ3snKSB8fFxuICAgICAgICAgICAgICAgICFjdXJyZW50SnNvbk1ldGFkYXRhLmVuZHNXaXRoKCd9JykpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1ldGFkYXRhID0gSlNPTi5wYXJzZShjdXJyZW50SnNvbk1ldGFkYXRhKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGFkZERhbmdlclRvYXN0KHQoJ0pTT04gbWV0YWRhdGEgaXMgaW52YWxpZCEnKSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY29sb3JOYW1lc3BhY2UgPSBnZXRDb2xvck5hbWVzcGFjZShtZXRhZGF0YT8uY29sb3JfbmFtZXNwYWNlKTtcbiAgICAgICAgLy8gY29sb3Igc2NoZW1lIGluIGpzb24gbWV0YWRhdGEgaGFzIHByZWNlZGVuY2Ugb3ZlciBzZWxlY3Rpb25cbiAgICAgICAgY29uc3QgdXBkYXRlZENvbG9yU2NoZW1lID0gbWV0YWRhdGE/LmNvbG9yX3NjaGVtZSB8fCBjb2xvclNjaGVtZTtcbiAgICAgICAgY29uc3Qgc2hvdWxkR29GcmVzaCA9IHVwZGF0ZWRDb2xvclNjaGVtZSAhPT0gb3JpZ2luYWxEYXNoYm9hcmRNZXRhZGF0YS5jdXJyZW50LmNvbG9yX3NjaGVtZTtcbiAgICAgICAgY29uc3Qgc2hvdWxkUmVzZXRDdXN0b21MYWJlbHMgPSAhYXJlT2JqZWN0c0VxdWFsKG9yaWdpbmFsRGFzaGJvYXJkTWV0YWRhdGEuY3VycmVudC5sYWJlbF9jb2xvcnMgfHwge30sIG1ldGFkYXRhPy5sYWJlbF9jb2xvcnMgfHwge30pO1xuICAgICAgICBjb25zdCBjdXJyZW50Q3VzdG9tTGFiZWxzID0gT2JqZWN0LmtleXMobWV0YWRhdGE/LmxhYmVsX2NvbG9ycyB8fCB7fSk7XG4gICAgICAgIGNvbnN0IHByZXZDdXN0b21MYWJlbHMgPSBPYmplY3Qua2V5cyhvcmlnaW5hbERhc2hib2FyZE1ldGFkYXRhLmN1cnJlbnQubGFiZWxfY29sb3JzIHx8IHt9KTtcbiAgICAgICAgY29uc3QgcmVzZXR0YWJsZUN1c3RvbUxhYmVscyA9IGN1cnJlbnRDdXN0b21MYWJlbHMubGVuZ3RoID4gMCA/IGN1cnJlbnRDdXN0b21MYWJlbHMgOiBwcmV2Q3VzdG9tTGFiZWxzO1xuICAgICAgICBjb25zdCBmcmVzaEN1c3RvbUxhYmVscyA9IHNob3VsZFJlc2V0Q3VzdG9tTGFiZWxzICYmIHJlc2V0dGFibGVDdXN0b21MYWJlbHMubGVuZ3RoID4gMFxuICAgICAgICAgICAgPyByZXNldHRhYmxlQ3VzdG9tTGFiZWxzXG4gICAgICAgICAgICA6IGZhbHNlO1xuICAgICAgICBjb25zdCBqc29uTWV0YWRhdGFPYmogPSBnZXRKc29uTWV0YWRhdGEoKTtcbiAgICAgICAgY29uc3QgY3VzdG9tTGFiZWxDb2xvcnMgPSBqc29uTWV0YWRhdGFPYmoubGFiZWxfY29sb3JzIHx8IHt9O1xuICAgICAgICBjb25zdCB1cGRhdGVkRGFzaGJvYXJkTWV0YWRhdGEgPSB7XG4gICAgICAgICAgICAuLi5vcmlnaW5hbERhc2hib2FyZE1ldGFkYXRhLmN1cnJlbnQsXG4gICAgICAgICAgICBsYWJlbF9jb2xvcnM6IGN1c3RvbUxhYmVsQ29sb3JzLFxuICAgICAgICAgICAgY29sb3Jfc2NoZW1lOiB1cGRhdGVkQ29sb3JTY2hlbWUsXG4gICAgICAgIH07XG4gICAgICAgIG9yaWdpbmFsRGFzaGJvYXJkTWV0YWRhdGEuY3VycmVudCA9IHVwZGF0ZWREYXNoYm9hcmRNZXRhZGF0YTtcbiAgICAgICAgYXBwbHlDb2xvcnModXBkYXRlZERhc2hib2FyZE1ldGFkYXRhLCBzaG91bGRHb0ZyZXNoIHx8IGZyZXNoQ3VzdG9tTGFiZWxzKTtcbiAgICAgICAgZGlzcGF0Y2goc2V0RGFzaGJvYXJkTWV0YWRhdGEoe1xuICAgICAgICAgICAgLi4udXBkYXRlZERhc2hib2FyZE1ldGFkYXRhLFxuICAgICAgICAgICAgbWFwX2xhYmVsX2NvbG9yczogZ2V0RnJlc2hMYWJlbHNDb2xvck1hcEVudHJpZXMoY3VzdG9tTGFiZWxDb2xvcnMpLFxuICAgICAgICB9KSk7XG4gICAgICAgIG9uQ29sb3JTY2hlbWVDaGFuZ2UodXBkYXRlZENvbG9yU2NoZW1lLCB7XG4gICAgICAgICAgICB1cGRhdGVNZXRhZGF0YTogZmFsc2UsXG4gICAgICAgIH0pO1xuICAgICAgICBjdXJyZW50SnNvbk1ldGFkYXRhID0ganNvblN0cmluZ2lmeShtZXRhZGF0YSk7XG4gICAgICAgIGNvbnN0IG1vcmVPblN1Ym1pdFByb3BzID0ge307XG4gICAgICAgIGNvbnN0IG1vcmVQdXRQcm9wcyA9IHt9O1xuICAgICAgICBpZiAoaXNGZWF0dXJlRW5hYmxlZChGZWF0dXJlRmxhZy5EYXNoYm9hcmRSYmFjKSkge1xuICAgICAgICAgICAgbW9yZU9uU3VibWl0UHJvcHMucm9sZXMgPSByb2xlcztcbiAgICAgICAgICAgIG1vcmVQdXRQcm9wcy5yb2xlcyA9IChyb2xlcyB8fCBbXSkubWFwKHIgPT4gci5pZCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuVGFnZ2luZ1N5c3RlbSkpIHtcbiAgICAgICAgICAgIG1vcmVQdXRQcm9wcy50YWdzID0gdGFncy5tYXAodGFnID0+IHRhZy5pZCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgb25TdWJtaXRQcm9wcyA9IHtcbiAgICAgICAgICAgIGlkOiBkYXNoYm9hcmRJZCxcbiAgICAgICAgICAgIHRpdGxlLFxuICAgICAgICAgICAgc2x1ZyxcbiAgICAgICAgICAgIGpzb25NZXRhZGF0YTogY3VycmVudEpzb25NZXRhZGF0YSxcbiAgICAgICAgICAgIG93bmVycyxcbiAgICAgICAgICAgIGNvbG9yU2NoZW1lOiBjdXJyZW50Q29sb3JTY2hlbWUsXG4gICAgICAgICAgICBjb2xvck5hbWVzcGFjZSxcbiAgICAgICAgICAgIGNlcnRpZmllZEJ5LFxuICAgICAgICAgICAgY2VydGlmaWNhdGlvbkRldGFpbHMsXG4gICAgICAgICAgICAuLi5tb3JlT25TdWJtaXRQcm9wcyxcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKG9ubHlBcHBseSkge1xuICAgICAgICAgICAgb25TdWJtaXQob25TdWJtaXRQcm9wcyk7XG4gICAgICAgICAgICBvbkhpZGUoKTtcbiAgICAgICAgICAgIGFkZFN1Y2Nlc3NUb2FzdCh0KCdEYXNoYm9hcmQgcHJvcGVydGllcyB1cGRhdGVkJykpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgU3VwZXJzZXRDbGllbnQucHV0KHtcbiAgICAgICAgICAgICAgICBlbmRwb2ludDogYC9hcGkvdjEvZGFzaGJvYXJkLyR7ZGFzaGJvYXJkSWR9YCxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgIGRhc2hib2FyZF90aXRsZTogdGl0bGUsXG4gICAgICAgICAgICAgICAgICAgIHNsdWc6IHNsdWcgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICAgICAganNvbl9tZXRhZGF0YTogY3VycmVudEpzb25NZXRhZGF0YSB8fCBudWxsLFxuICAgICAgICAgICAgICAgICAgICBvd25lcnM6IChvd25lcnMgfHwgW10pLm1hcChvID0+IG8uaWQpLFxuICAgICAgICAgICAgICAgICAgICBjZXJ0aWZpZWRfYnk6IGNlcnRpZmllZEJ5IHx8IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIGNlcnRpZmljYXRpb25fZGV0YWlsczogY2VydGlmaWVkQnkgJiYgY2VydGlmaWNhdGlvbkRldGFpbHMgPyBjZXJ0aWZpY2F0aW9uRGV0YWlscyA6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIC4uLm1vcmVQdXRQcm9wcyxcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIH0pLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIG9uU3VibWl0KG9uU3VibWl0UHJvcHMpO1xuICAgICAgICAgICAgICAgIG9uSGlkZSgpO1xuICAgICAgICAgICAgICAgIGFkZFN1Y2Nlc3NUb2FzdCh0KCdUaGUgZGFzaGJvYXJkIGhhcyBiZWVuIHNhdmVkJykpO1xuICAgICAgICAgICAgfSwgaGFuZGxlRXJyb3JSZXNwb25zZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IGdldFJvd3NXaXRob3V0Um9sZXMgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGpzb25NZXRhZGF0YU9iaiA9IGdldEpzb25NZXRhZGF0YSgpO1xuICAgICAgICBjb25zdCBoYXNDdXN0b21MYWJlbHNDb2xvciA9ICEhT2JqZWN0LmtleXMoanNvbk1ldGFkYXRhT2JqPy5sYWJlbF9jb2xvcnMgfHwge30pLmxlbmd0aDtcbiAgICAgICAgcmV0dXJuICg8Um93IGd1dHRlcj17MTZ9PlxuICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICA8aDMgc3R5bGU9e3sgbWFyZ2luVG9wOiAnMWVtJyB9fT57dCgnQWNjZXNzJyl9PC9oMz5cbiAgICAgICAgICA8U3R5bGVkRm9ybUl0ZW0gbGFiZWw9e3QoJ093bmVycycpfT5cbiAgICAgICAgICAgIDxBc3luY1NlbGVjdCBhbGxvd0NsZWFyIGFyaWFMYWJlbD17dCgnT3duZXJzJyl9IGRpc2FibGVkPXtpc0xvYWRpbmd9IG1vZGU9XCJtdWx0aXBsZVwiIG9uQ2hhbmdlPXtoYW5kbGVPbkNoYW5nZU93bmVyc30gb3B0aW9ucz17KGlucHV0LCBwYWdlLCBwYWdlU2l6ZSkgPT4gbG9hZEFjY2Vzc09wdGlvbnMoJ293bmVycycsIGlucHV0LCBwYWdlLCBwYWdlU2l6ZSl9IHZhbHVlPXtoYW5kbGVPd25lcnNTZWxlY3RWYWx1ZSgpfS8+XG4gICAgICAgICAgPC9TdHlsZWRGb3JtSXRlbT5cbiAgICAgICAgICA8cCBjbGFzc05hbWU9XCJoZWxwLWJsb2NrXCI+XG4gICAgICAgICAgICB7dCgnT3duZXJzIGlzIGEgbGlzdCBvZiB1c2VycyB3aG8gY2FuIGFsdGVyIHRoZSBkYXNoYm9hcmQuIFNlYXJjaGFibGUgYnkgbmFtZSBvciB1c2VybmFtZS4nKX1cbiAgICAgICAgICA8L3A+XG4gICAgICAgIDwvQ29sPlxuICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICA8aDMgc3R5bGU9e3sgbWFyZ2luVG9wOiAnMWVtJyB9fT57dCgnQ29sb3JzJyl9PC9oMz5cbiAgICAgICAgICA8Q29sb3JTY2hlbWVDb250cm9sV3JhcHBlciBoYXNDdXN0b21MYWJlbHNDb2xvcj17aGFzQ3VzdG9tTGFiZWxzQ29sb3J9IG9uQ2hhbmdlPXtvbkNvbG9yU2NoZW1lQ2hhbmdlfSBjb2xvclNjaGVtZT17Y29sb3JTY2hlbWV9Lz5cbiAgICAgICAgPC9Db2w+XG4gICAgICA8L1Jvdz4pO1xuICAgIH07XG4gICAgY29uc3QgZ2V0Um93c1dpdGhSb2xlcyA9ICgpID0+IHtcbiAgICAgICAgY29uc3QganNvbk1ldGFkYXRhT2JqID0gZ2V0SnNvbk1ldGFkYXRhKCk7XG4gICAgICAgIGNvbnN0IGhhc0N1c3RvbUxhYmVsc0NvbG9yID0gISFPYmplY3Qua2V5cyhqc29uTWV0YWRhdGFPYmo/LmxhYmVsX2NvbG9ycyB8fCB7fSkubGVuZ3RoO1xuICAgICAgICByZXR1cm4gKDw+XG4gICAgICAgIDxSb3c+XG4gICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsyNH0+XG4gICAgICAgICAgICA8aDMgc3R5bGU9e3sgbWFyZ2luVG9wOiAnMWVtJyB9fT57dCgnQWNjZXNzJyl9PC9oMz5cbiAgICAgICAgICA8L0NvbD5cbiAgICAgICAgPC9Sb3c+XG4gICAgICAgIDxSb3cgZ3V0dGVyPXsxNn0+XG4gICAgICAgICAgPENvbCB4cz17MjR9IG1kPXsxMn0+XG4gICAgICAgICAgICA8U3R5bGVkRm9ybUl0ZW0gbGFiZWw9e3QoJ093bmVycycpfT5cbiAgICAgICAgICAgICAgPEFzeW5jU2VsZWN0IGFsbG93Q2xlYXIgYWxsb3dOZXdPcHRpb25zIGFyaWFMYWJlbD17dCgnT3duZXJzJyl9IGRpc2FibGVkPXtpc0xvYWRpbmd9IG1vZGU9XCJtdWx0aXBsZVwiIG9uQ2hhbmdlPXtoYW5kbGVPbkNoYW5nZU93bmVyc30gb3B0aW9ucz17KGlucHV0LCBwYWdlLCBwYWdlU2l6ZSkgPT4gbG9hZEFjY2Vzc09wdGlvbnMoJ293bmVycycsIGlucHV0LCBwYWdlLCBwYWdlU2l6ZSl9IHZhbHVlPXtoYW5kbGVPd25lcnNTZWxlY3RWYWx1ZSgpfS8+XG4gICAgICAgICAgICA8L1N0eWxlZEZvcm1JdGVtPlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwiaGVscC1ibG9ja1wiPlxuICAgICAgICAgICAgICB7dCgnT3duZXJzIGlzIGEgbGlzdCBvZiB1c2VycyB3aG8gY2FuIGFsdGVyIHRoZSBkYXNoYm9hcmQuIFNlYXJjaGFibGUgYnkgbmFtZSBvciB1c2VybmFtZS4nKX1cbiAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICA8L0NvbD5cbiAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICAgIDxTdHlsZWRGb3JtSXRlbSBsYWJlbD17dCgnUm9sZXMnKX0+XG4gICAgICAgICAgICAgIDxBc3luY1NlbGVjdCBhbGxvd0NsZWFyIGFyaWFMYWJlbD17dCgnUm9sZXMnKX0gZGlzYWJsZWQ9e2lzTG9hZGluZ30gbW9kZT1cIm11bHRpcGxlXCIgb25DaGFuZ2U9e2hhbmRsZU9uQ2hhbmdlUm9sZXN9IG9wdGlvbnM9eyhpbnB1dCwgcGFnZSwgcGFnZVNpemUpID0+IGxvYWRBY2Nlc3NPcHRpb25zKCdyb2xlcycsIGlucHV0LCBwYWdlLCBwYWdlU2l6ZSl9IHZhbHVlPXtoYW5kbGVSb2xlc1NlbGVjdFZhbHVlKCl9Lz5cbiAgICAgICAgICAgIDwvU3R5bGVkRm9ybUl0ZW0+XG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJoZWxwLWJsb2NrXCI+XG4gICAgICAgICAgICAgIHt0KCdSb2xlcyBpcyBhIGxpc3Qgd2hpY2ggZGVmaW5lcyBhY2Nlc3MgdG8gdGhlIGRhc2hib2FyZC4gR3JhbnRpbmcgYSByb2xlIGFjY2VzcyB0byBhIGRhc2hib2FyZCB3aWxsIGJ5cGFzcyBkYXRhc2V0IGxldmVsIGNoZWNrcy4gSWYgbm8gcm9sZXMgYXJlIGRlZmluZWQsIHJlZ3VsYXIgYWNjZXNzIHBlcm1pc3Npb25zIGFwcGx5LicpfVxuICAgICAgICAgICAgPC9wPlxuICAgICAgICAgIDwvQ29sPlxuICAgICAgICA8L1Jvdz5cbiAgICAgICAgPFJvdz5cbiAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICAgIDxDb2xvclNjaGVtZUNvbnRyb2xXcmFwcGVyIGhhc0N1c3RvbUxhYmVsc0NvbG9yPXtoYXNDdXN0b21MYWJlbHNDb2xvcn0gb25DaGFuZ2U9e29uQ29sb3JTY2hlbWVDaGFuZ2V9IGNvbG9yU2NoZW1lPXtjb2xvclNjaGVtZX0vPlxuICAgICAgICAgIDwvQ29sPlxuICAgICAgICA8L1Jvdz5cbiAgICAgIDwvPik7XG4gICAgfTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAoc2hvdykge1xuICAgICAgICAgICAgaWYgKCFjdXJyZW50RGFzaGJvYXJkSW5mbykge1xuICAgICAgICAgICAgICAgIGZldGNoRGFzaGJvYXJkRGV0YWlscygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaGFuZGxlRGFzaGJvYXJkRGF0YShjdXJyZW50RGFzaGJvYXJkSW5mbyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgSnNvbkVkaXRvci5wcmVsb2FkKCk7XG4gICAgfSwgW2N1cnJlbnREYXNoYm9hcmRJbmZvLCBmZXRjaERhc2hib2FyZERldGFpbHMsIGhhbmRsZURhc2hib2FyZERhdGEsIHNob3ddKTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICAvLyB0aGUgdGl0bGUgY2FuIGJlIGNoYW5nZWQgaW5saW5lIGluIHRoZSBkYXNoYm9hcmQsIHRoaXMgY2F0Y2hlcyBpdFxuICAgICAgICBpZiAoZGFzaGJvYXJkVGl0bGUgJiZcbiAgICAgICAgICAgIGRhc2hib2FyZEluZm8gJiZcbiAgICAgICAgICAgIGRhc2hib2FyZEluZm8udGl0bGUgIT09IGRhc2hib2FyZFRpdGxlKSB7XG4gICAgICAgICAgICBmb3JtLnNldEZpZWxkc1ZhbHVlKHtcbiAgICAgICAgICAgICAgICAuLi5kYXNoYm9hcmRJbmZvLFxuICAgICAgICAgICAgICAgIHRpdGxlOiBkYXNoYm9hcmRUaXRsZSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSwgW2Rhc2hib2FyZEluZm8sIGRhc2hib2FyZFRpdGxlLCBmb3JtXSk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKCFpc0ZlYXR1cmVFbmFibGVkKEZlYXR1cmVGbGFnLlRhZ2dpbmdTeXN0ZW0pKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgZmV0Y2hUYWdzKHtcbiAgICAgICAgICAgICAgICBvYmplY3RUeXBlOiBPQkpFQ1RfVFlQRVMuREFTSEJPQVJELFxuICAgICAgICAgICAgICAgIG9iamVjdElkOiBkYXNoYm9hcmRJZCxcbiAgICAgICAgICAgICAgICBpbmNsdWRlVHlwZXM6IGZhbHNlLFxuICAgICAgICAgICAgfSwgKHRhZ3MpID0+IHNldFRhZ3ModGFncyksIChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgIGFkZERhbmdlclRvYXN0KGBFcnJvciBmZXRjaGluZyB0YWdzOiAke2Vycm9yLnRleHR9YCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGhhbmRsZUVycm9yUmVzcG9uc2UoZXJyb3IpO1xuICAgICAgICB9XG4gICAgfSwgW2Rhc2hib2FyZElkXSk7XG4gICAgY29uc3QgaGFuZGxlQ2hhbmdlVGFncyA9ICh0YWdzKSA9PiB7XG4gICAgICAgIGNvbnN0IHBhcnNlZFRhZ3MgPSBlbnN1cmVJc0FycmF5KHRhZ3MpLm1hcChyID0+ICh7XG4gICAgICAgICAgICBpZDogci52YWx1ZSxcbiAgICAgICAgICAgIG5hbWU6IHIubGFiZWwsXG4gICAgICAgIH0pKTtcbiAgICAgICAgc2V0VGFncyhwYXJzZWRUYWdzKTtcbiAgICB9O1xuICAgIHJldHVybiAoPE1vZGFsIHNob3c9e3Nob3d9IG9uSGlkZT17aGFuZGxlT25DYW5jZWx9IHRpdGxlPXt0KCdEYXNoYm9hcmQgcHJvcGVydGllcycpfSBmb290ZXI9ezw+XG4gICAgICAgICAgPEJ1dHRvbiBodG1sVHlwZT1cImJ1dHRvblwiIGJ1dHRvblNpemU9XCJzbWFsbFwiIG9uQ2xpY2s9e2hhbmRsZU9uQ2FuY2VsfSBkYXRhLXRlc3Q9XCJwcm9wZXJ0aWVzLW1vZGFsLWNhbmNlbC1idXR0b25cIiBjdGE+XG4gICAgICAgICAgICB7dCgnQ2FuY2VsJyl9XG4gICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgPEJ1dHRvbiBkYXRhLXRlc3Q9XCJwcm9wZXJ0aWVzLW1vZGFsLWFwcGx5LWJ1dHRvblwiIG9uQ2xpY2s9e2Zvcm0uc3VibWl0fSBidXR0b25TaXplPVwic21hbGxcIiBidXR0b25TdHlsZT1cInByaW1hcnlcIiBjbGFzc05hbWU9XCJtLXItNVwiIGN0YSBkaXNhYmxlZD17ZGFzaGJvYXJkSW5mbz8uaXNNYW5hZ2VkRXh0ZXJuYWxseX0gdG9vbHRpcD17ZGFzaGJvYXJkSW5mbz8uaXNNYW5hZ2VkRXh0ZXJuYWxseVxuICAgICAgICAgICAgICAgID8gdChcIlRoaXMgZGFzaGJvYXJkIGlzIG1hbmFnZWQgZXh0ZXJuYWxseSwgYW5kIGNhbid0IGJlIGVkaXRlZCBpbiBTdXBlcnNldFwiKVxuICAgICAgICAgICAgICAgIDogJyd9PlxuICAgICAgICAgICAge3NhdmVMYWJlbH1cbiAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgPC8+fSByZXNwb25zaXZlPlxuICAgICAgPEFudGRGb3JtIGZvcm09e2Zvcm19IG9uRmluaXNoPXtvbkZpbmlzaH0gZGF0YS10ZXN0PVwiZGFzaGJvYXJkLWVkaXQtcHJvcGVydGllcy1mb3JtXCIgbGF5b3V0PVwidmVydGljYWxcIiBpbml0aWFsVmFsdWVzPXtkYXNoYm9hcmRJbmZvfT5cbiAgICAgICAgPFJvdz5cbiAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezI0fT5cbiAgICAgICAgICAgIDxoMz57dCgnQmFzaWMgaW5mb3JtYXRpb24nKX08L2gzPlxuICAgICAgICAgIDwvQ29sPlxuICAgICAgICA8L1Jvdz5cbiAgICAgICAgPFJvdyBndXR0ZXI9ezE2fT5cbiAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICAgIDxGb3JtSXRlbSBsYWJlbD17dCgnTmFtZScpfSBuYW1lPVwidGl0bGVcIj5cbiAgICAgICAgICAgICAgPElucHV0IGRhdGEtdGVzdD1cImRhc2hib2FyZC10aXRsZS1pbnB1dFwiIHR5cGU9XCJ0ZXh0XCIgZGlzYWJsZWQ9e2lzTG9hZGluZ30vPlxuICAgICAgICAgICAgPC9Gb3JtSXRlbT5cbiAgICAgICAgICA8L0NvbD5cbiAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICAgIDxTdHlsZWRGb3JtSXRlbSBsYWJlbD17dCgnVVJMIHNsdWcnKX0gbmFtZT1cInNsdWdcIj5cbiAgICAgICAgICAgICAgPElucHV0IHR5cGU9XCJ0ZXh0XCIgZGlzYWJsZWQ9e2lzTG9hZGluZ30vPlxuICAgICAgICAgICAgPC9TdHlsZWRGb3JtSXRlbT5cbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cImhlbHAtYmxvY2tcIj5cbiAgICAgICAgICAgICAge3QoJ0EgcmVhZGFibGUgVVJMIGZvciB5b3VyIGRhc2hib2FyZCcpfVxuICAgICAgICAgICAgPC9wPlxuICAgICAgICAgIDwvQ29sPlxuICAgICAgICA8L1Jvdz5cbiAgICAgICAge2lzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuRGFzaGJvYXJkUmJhYylcbiAgICAgICAgICAgID8gZ2V0Um93c1dpdGhSb2xlcygpXG4gICAgICAgICAgICA6IGdldFJvd3NXaXRob3V0Um9sZXMoKX1cbiAgICAgICAgPFJvdz5cbiAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezI0fT5cbiAgICAgICAgICAgIDxoMz57dCgnQ2VydGlmaWNhdGlvbicpfTwvaDM+XG4gICAgICAgICAgPC9Db2w+XG4gICAgICAgIDwvUm93PlxuICAgICAgICA8Um93IGd1dHRlcj17MTZ9PlxuICAgICAgICAgIDxDb2wgeHM9ezI0fSBtZD17MTJ9PlxuICAgICAgICAgICAgPFN0eWxlZEZvcm1JdGVtIGxhYmVsPXt0KCdDZXJ0aWZpZWQgYnknKX0gbmFtZT1cImNlcnRpZmllZEJ5XCI+XG4gICAgICAgICAgICAgIDxJbnB1dCB0eXBlPVwidGV4dFwiIGRpc2FibGVkPXtpc0xvYWRpbmd9Lz5cbiAgICAgICAgICAgIDwvU3R5bGVkRm9ybUl0ZW0+XG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJoZWxwLWJsb2NrXCI+XG4gICAgICAgICAgICAgIHt0KCdQZXJzb24gb3IgZ3JvdXAgdGhhdCBoYXMgY2VydGlmaWVkIHRoaXMgZGFzaGJvYXJkLicpfVxuICAgICAgICAgICAgPC9wPlxuICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgIDxDb2wgeHM9ezI0fSBtZD17MTJ9PlxuICAgICAgICAgICAgPFN0eWxlZEZvcm1JdGVtIGxhYmVsPXt0KCdDZXJ0aWZpY2F0aW9uIGRldGFpbHMnKX0gbmFtZT1cImNlcnRpZmljYXRpb25EZXRhaWxzXCI+XG4gICAgICAgICAgICAgIDxJbnB1dCB0eXBlPVwidGV4dFwiIGRpc2FibGVkPXtpc0xvYWRpbmd9Lz5cbiAgICAgICAgICAgIDwvU3R5bGVkRm9ybUl0ZW0+XG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJoZWxwLWJsb2NrXCI+XG4gICAgICAgICAgICAgIHt0KCdBbnkgYWRkaXRpb25hbCBkZXRhaWwgdG8gc2hvdyBpbiB0aGUgY2VydGlmaWNhdGlvbiB0b29sdGlwLicpfVxuICAgICAgICAgICAgPC9wPlxuICAgICAgICAgIDwvQ29sPlxuICAgICAgICA8L1Jvdz5cbiAgICAgICAge2lzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuVGFnZ2luZ1N5c3RlbSkgPyAoPFJvdyBndXR0ZXI9ezE2fT5cbiAgICAgICAgICAgIDxDb2wgeHM9ezI0fSBtZD17MTJ9PlxuICAgICAgICAgICAgICA8aDMgY3NzPXt7IG1hcmdpblRvcDogJzFlbScgfX0+e3QoJ1RhZ3MnKX08L2gzPlxuICAgICAgICAgICAgPC9Db2w+XG4gICAgICAgICAgPC9Sb3c+KSA6IG51bGx9XG4gICAgICAgIHtpc0ZlYXR1cmVFbmFibGVkKEZlYXR1cmVGbGFnLlRhZ2dpbmdTeXN0ZW0pID8gKDxSb3cgZ3V0dGVyPXsxNn0+XG4gICAgICAgICAgICA8Q29sIHhzPXsyNH0gbWQ9ezEyfT5cbiAgICAgICAgICAgICAgPFN0eWxlZEZvcm1JdGVtPlxuICAgICAgICAgICAgICAgIDxBc3luY1NlbGVjdCBhcmlhTGFiZWw9XCJUYWdzXCIgbW9kZT1cIm11bHRpcGxlXCIgdmFsdWU9e3RhZ3NBc1NlbGVjdFZhbHVlc30gb3B0aW9ucz17bG9hZFRhZ3N9IG9uQ2hhbmdlPXtoYW5kbGVDaGFuZ2VUYWdzfSBhbGxvd0NsZWFyLz5cbiAgICAgICAgICAgICAgPC9TdHlsZWRGb3JtSXRlbT5cbiAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwiaGVscC1ibG9ja1wiPlxuICAgICAgICAgICAgICAgIHt0KCdBIGxpc3Qgb2YgdGFncyB0aGF0IGhhdmUgYmVlbiBhcHBsaWVkIHRvIHRoaXMgY2hhcnQuJyl9XG4gICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgIDwvUm93PikgOiBudWxsfVxuICAgICAgICA8Um93PlxuICAgICAgICAgIDxDb2wgeHM9ezI0fSBtZD17MjR9PlxuICAgICAgICAgICAgPGgzIHN0eWxlPXt7IG1hcmdpblRvcDogJzFlbScgfX0+XG4gICAgICAgICAgICAgIDxCdXR0b24gYnV0dG9uU3R5bGU9XCJsaW5rXCIgb25DbGljaz17KCkgPT4gc2V0SXNBZHZhbmNlZE9wZW4oIWlzQWR2YW5jZWRPcGVuKX0gY3NzPXtjc3MgYFxuICAgICAgICAgICAgICAgICAgcGFkZGluZzogMDtcbiAgICAgICAgICAgICAgICBgfT5cbiAgICAgICAgICAgICAgICB7LyogVE9ETzogUmVtb3ZlIGZhLWljb24gKi99XG4gICAgICAgICAgICAgICAgPGkgY2xhc3NOYW1lPXtgZmEgZmEtYW5nbGUtJHtpc0FkdmFuY2VkT3BlbiA/ICdkb3duJyA6ICdyaWdodCd9YH0gc3R5bGU9e3sgbWluV2lkdGg6ICcxZW0nIH19Lz5cbiAgICAgICAgICAgICAgICB7dCgnQWR2YW5jZWQnKX1cbiAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICA8L2gzPlxuICAgICAgICAgICAge2lzQWR2YW5jZWRPcGVuICYmICg8PlxuICAgICAgICAgICAgICAgIDxTdHlsZWRGb3JtSXRlbSBsYWJlbD17dCgnSlNPTiBtZXRhZGF0YScpfT5cbiAgICAgICAgICAgICAgICAgIDxTdHlsZWRKc29uRWRpdG9yIHNob3dMb2FkaW5nRm9ySW1wb3J0IG5hbWU9XCJqc29uX21ldGFkYXRhXCIgdmFsdWU9e2pzb25NZXRhZGF0YX0gb25DaGFuZ2U9e3NldEpzb25NZXRhZGF0YX0gdGFiU2l6ZT17Mn0gd2lkdGg9XCIxMDAlXCIgaGVpZ2h0PVwiMjAwcHhcIiB3cmFwRW5hYmxlZC8+XG4gICAgICAgICAgICAgICAgPC9TdHlsZWRGb3JtSXRlbT5cbiAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJoZWxwLWJsb2NrXCI+XG4gICAgICAgICAgICAgICAgICB7dCgnVGhpcyBKU09OIG9iamVjdCBpcyBnZW5lcmF0ZWQgZHluYW1pY2FsbHkgd2hlbiBjbGlja2luZyB0aGUgc2F2ZSBvciBvdmVyd3JpdGUgYnV0dG9uIGluIHRoZSBkYXNoYm9hcmQgdmlldy4gSXQgaXMgZXhwb3NlZCBoZXJlIGZvciByZWZlcmVuY2UgYW5kIGZvciBwb3dlciB1c2VycyB3aG8gbWF5IHdhbnQgdG8gYWx0ZXIgc3BlY2lmaWMgcGFyYW1ldGVycy4nKX1cbiAgICAgICAgICAgICAgICAgIHtvbmx5QXBwbHkgJiYgKDw+XG4gICAgICAgICAgICAgICAgICAgICAgeycgJ31cbiAgICAgICAgICAgICAgICAgICAgICB7dCgnUGxlYXNlIERPIE5PVCBvdmVyd3JpdGUgdGhlIFwiZmlsdGVyX3Njb3Blc1wiIGtleS4nKX17JyAnfVxuICAgICAgICAgICAgICAgICAgICAgIDxGaWx0ZXJTY29wZU1vZGFsIHRyaWdnZXJOb2RlPXs8c3BhbiBjbGFzc05hbWU9XCJhbGVydC1saW5rXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge3QoJ1VzZSBcIiUobWVudU5hbWUpc1wiIG1lbnUgaW5zdGVhZC4nLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZW51TmFtZTogdCgnU2V0IGZpbHRlciBtYXBwaW5nJyksXG4gICAgICAgICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+fS8+XG4gICAgICAgICAgICAgICAgICAgIDwvPil9XG4gICAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgICA8Lz4pfVxuICAgICAgICAgIDwvQ29sPlxuICAgICAgICA8L1Jvdz5cbiAgICAgIDwvQW50ZEZvcm0+XG4gICAgPC9Nb2RhbD4pO1xufTtcbmV4cG9ydCBkZWZhdWx0IHdpdGhUb2FzdHMoUHJvcGVydGllc01vZGFsKTtcbiJdfQ== */\", toString: _EMOTION_STRINGIFIED_CSS_ERROR__ };\nconst PropertiesModal = ({ addSuccessToast, addDangerToast, colorScheme: currentColorScheme, dashboardId, dashboardInfo: currentDashboardInfo, dashboardTitle, onHide = () => {}, onlyApply = false, onSubmit = () => {}, show = false }) => {\n  const dispatch = useDispatch();\n  const [form] = AntdForm.useForm();\n  const [isLoading, setIsLoading] = useState(false);\n  const [isAdvancedOpen, setIsAdvancedOpen] = useState(false);\n  const [colorScheme, setCurrentColorScheme] = useState(currentColorScheme);\n  const [jsonMetadata, setJsonMetadata] = useState('');\n  const [dashboardInfo, setDashboardInfo] = useState();\n  const [owners, setOwners] = useState([]);\n  const [roles, setRoles] = useState([]);\n  const saveLabel = onlyApply ? t('Apply') : t('Save');\n  const [tags, setTags] = useState([]);\n  const categoricalSchemeRegistry = getCategoricalSchemeRegistry();\n  const originalDashboardMetadata = useRef({});\n  const tagsAsSelectValues = useMemo(() => {\n    const selectTags = tags.map((tag) => ({\n      value: tag.id,\n      label: tag.name\n    }));\n    return selectTags;\n  }, [tags.length]);\n  const handleErrorResponse = async (response) => {\n    const { error, statusText, message } = await getClientErrorObject(response);\n    let errorText = error || statusText || t('An error has occurred');\n    if (typeof message === 'object' && 'json_metadata' in message) {\n      errorText = message.json_metadata;\n    } else\n    if (typeof message === 'string') {\n      errorText = message;\n      if (message === 'Forbidden') {\n        errorText = t('You do not have permission to edit this dashboard');\n      }\n    }\n    Modal.error({\n      title: t('Error'),\n      content: errorText,\n      okButtonProps: { danger: true, className: 'btn-danger' }\n    });\n  };\n  const loadAccessOptions = useCallback((accessType = 'owners', input = '', page, pageSize) => {\n    const query = rison.encode({\n      filter: input,\n      page,\n      page_size: pageSize\n    });\n    return SupersetClient.get({\n      endpoint: `/api/v1/dashboard/related/${accessType}?q=${query}`\n    }).then((response) => ({\n      data: response.json.result.\n      filter((item) => item.extra.active !== undefined ? item.extra.active : true).\n      map((item) => ({\n        value: item.value,\n        label: item.text\n      })),\n      totalCount: response.json.count\n    }));\n  }, []);\n  const handleDashboardData = useCallback((dashboardData) => {\n    const { id, dashboard_title, slug, certified_by, certification_details, owners, roles, metadata, is_managed_externally } = dashboardData;\n    const dashboardInfo = {\n      id,\n      title: dashboard_title,\n      slug: slug || '',\n      certifiedBy: certified_by || '',\n      certificationDetails: certification_details || '',\n      isManagedExternally: is_managed_externally || false,\n      metadata\n    };\n    form.setFieldsValue(dashboardInfo);\n    setDashboardInfo(dashboardInfo);\n    setOwners(owners);\n    setRoles(roles);\n    setCurrentColorScheme(metadata.color_scheme);\n    const metaDataCopy = _omit(metadata, [\n    'positions',\n    'shared_label_colors',\n    'map_label_colors',\n    'color_scheme_domain']\n    );\n    setJsonMetadata(metaDataCopy ? jsonStringify(metaDataCopy) : '');\n    originalDashboardMetadata.current = metadata;\n  }, [form]);\n  const fetchDashboardDetails = useCallback(() => {\n    setIsLoading(true);\n    // We fetch the dashboard details because not all code\n    // that renders this component have all the values we need.\n    // At some point when we have a more consistent frontend\n    // datamodel, the dashboard could probably just be passed as a prop.\n    SupersetClient.get({\n      endpoint: `/api/v1/dashboard/${dashboardId}`\n    }).then((response) => {var _dashboard$json_metad;\n      const dashboard = response.json.result;\n      const jsonMetadataObj = (_dashboard$json_metad = dashboard.json_metadata) != null && _dashboard$json_metad.length ?\n      JSON.parse(dashboard.json_metadata) :\n      {};\n      handleDashboardData({\n        ...dashboard,\n        metadata: jsonMetadataObj\n      });\n      setIsLoading(false);\n    }, handleErrorResponse);\n  }, [dashboardId, handleDashboardData]);\n  const getJsonMetadata = () => {\n    try {\n      const jsonMetadataObj = jsonMetadata != null && jsonMetadata.length ?\n      JSON.parse(jsonMetadata) :\n      {};\n      return jsonMetadataObj;\n    }\n    catch (_) {\n      return {};\n    }\n  };\n  const handleOnChangeOwners = (owners) => {\n    const parsedOwners = ensureIsArray(owners).map((o) => ({\n      id: o.value,\n      full_name: o.label\n    }));\n    setOwners(parsedOwners);\n  };\n  const handleOnChangeRoles = (roles) => {\n    const parsedRoles = ensureIsArray(roles).map((r) => ({\n      id: r.value,\n      name: r.label\n    }));\n    setRoles(parsedRoles);\n  };\n  const handleOwnersSelectValue = () => {\n    const parsedOwners = (owners || []).map((owner) => ({\n      value: owner.id,\n      label: getOwnerName(owner)\n    }));\n    return parsedOwners;\n  };\n  const handleRolesSelectValue = () => {\n    const parsedRoles = (roles || []).map((role) => ({\n      value: role.id,\n      label: `${role.name}`\n    }));\n    return parsedRoles;\n  };\n  const handleOnCancel = () => onHide();\n  const onColorSchemeChange = (colorScheme = '', { updateMetadata = true } = {}) => {\n    // check that color_scheme is valid\n    const colorChoices = categoricalSchemeRegistry.keys();\n    const jsonMetadataObj = getJsonMetadata();\n    // only fire if the color_scheme is present and invalid\n    if (colorScheme && !colorChoices.includes(colorScheme)) {\n      Modal.error({\n        title: t('Error'),\n        content: t('A valid color scheme is required'),\n        okButtonProps: { danger: true, className: 'btn-danger' }\n      });\n      onHide();\n      throw new Error('A valid color scheme is required');\n    }\n    jsonMetadataObj.color_scheme = colorScheme;\n    jsonMetadataObj.label_colors = jsonMetadataObj.label_colors || {};\n    setCurrentColorScheme(colorScheme);\n    dispatch(setColorScheme(colorScheme));\n    // update metadata to match selection\n    if (updateMetadata) {\n      setJsonMetadata(jsonStringify(jsonMetadataObj));\n    }\n  };\n  const onFinish = () => {var _metadata, _metadata2, _metadata3, _metadata4;\n    const { title, slug, certifiedBy, certificationDetails } = form.getFieldsValue();\n    let currentJsonMetadata = jsonMetadata;\n    // validate currentJsonMetadata\n    let metadata;\n    try {\n      if (!currentJsonMetadata.startsWith('{') ||\n      !currentJsonMetadata.endsWith('}')) {\n        throw new Error();\n      }\n      metadata = JSON.parse(currentJsonMetadata);\n    }\n    catch (error) {\n      addDangerToast(t('JSON metadata is invalid!'));\n      return;\n    }\n    const colorNamespace = getColorNamespace((_metadata = metadata) == null ? void 0 : _metadata.color_namespace);\n    // color scheme in json metadata has precedence over selection\n    const updatedColorScheme = ((_metadata2 = metadata) == null ? void 0 : _metadata2.color_scheme) || colorScheme;\n    const shouldGoFresh = updatedColorScheme !== originalDashboardMetadata.current.color_scheme;\n    const shouldResetCustomLabels = !areObjectsEqual(originalDashboardMetadata.current.label_colors || {}, ((_metadata3 = metadata) == null ? void 0 : _metadata3.label_colors) || {});\n    const currentCustomLabels = Object.keys(((_metadata4 = metadata) == null ? void 0 : _metadata4.label_colors) || {});\n    const prevCustomLabels = Object.keys(originalDashboardMetadata.current.label_colors || {});\n    const resettableCustomLabels = currentCustomLabels.length > 0 ? currentCustomLabels : prevCustomLabels;\n    const freshCustomLabels = shouldResetCustomLabels && resettableCustomLabels.length > 0 ?\n    resettableCustomLabels :\n    false;\n    const jsonMetadataObj = getJsonMetadata();\n    const customLabelColors = jsonMetadataObj.label_colors || {};\n    const updatedDashboardMetadata = {\n      ...originalDashboardMetadata.current,\n      label_colors: customLabelColors,\n      color_scheme: updatedColorScheme\n    };\n    originalDashboardMetadata.current = updatedDashboardMetadata;\n    applyColors(updatedDashboardMetadata, shouldGoFresh || freshCustomLabels);\n    dispatch(setDashboardMetadata({\n      ...updatedDashboardMetadata,\n      map_label_colors: getFreshLabelsColorMapEntries(customLabelColors)\n    }));\n    onColorSchemeChange(updatedColorScheme, {\n      updateMetadata: false\n    });\n    currentJsonMetadata = jsonStringify(metadata);\n    const moreOnSubmitProps = {};\n    const morePutProps = {};\n    if (isFeatureEnabled(FeatureFlag.DashboardRbac)) {\n      moreOnSubmitProps.roles = roles;\n      morePutProps.roles = (roles || []).map((r) => r.id);\n    }\n    if (isFeatureEnabled(FeatureFlag.TaggingSystem)) {\n      morePutProps.tags = tags.map((tag) => tag.id);\n    }\n    const onSubmitProps = {\n      id: dashboardId,\n      title,\n      slug,\n      jsonMetadata: currentJsonMetadata,\n      owners,\n      colorScheme: currentColorScheme,\n      colorNamespace,\n      certifiedBy,\n      certificationDetails,\n      ...moreOnSubmitProps\n    };\n    if (onlyApply) {\n      onSubmit(onSubmitProps);\n      onHide();\n      addSuccessToast(t('Dashboard properties updated'));\n    } else\n    {\n      SupersetClient.put({\n        endpoint: `/api/v1/dashboard/${dashboardId}`,\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          dashboard_title: title,\n          slug: slug || null,\n          json_metadata: currentJsonMetadata || null,\n          owners: (owners || []).map((o) => o.id),\n          certified_by: certifiedBy || null,\n          certification_details: certifiedBy && certificationDetails ? certificationDetails : null,\n          ...morePutProps\n        })\n      }).then(() => {\n        onSubmit(onSubmitProps);\n        onHide();\n        addSuccessToast(t('The dashboard has been saved'));\n      }, handleErrorResponse);\n    }\n  };\n  const getRowsWithoutRoles = () => {\n    const jsonMetadataObj = getJsonMetadata();\n    const hasCustomLabelsColor = !!Object.keys((jsonMetadataObj == null ? void 0 : jsonMetadataObj.label_colors) || {}).length;\n    return _jsxs(Row, { gutter: 16, children: [\n      _jsxs(Col, { xs: 24, md: 12, children: [\n        _jsx(\"h3\", { style: { marginTop: '1em' }, children: t('Access') }),\n        _jsx(StyledFormItem, { label: t('Owners'), children:\n          _jsx(AsyncSelect, { allowClear: true, ariaLabel: t('Owners'), disabled: isLoading, mode: \"multiple\", onChange: handleOnChangeOwners, options: (input, page, pageSize) => loadAccessOptions('owners', input, page, pageSize), value: handleOwnersSelectValue() }) }\n        ),\n        _jsx(\"p\", { className: \"help-block\", children:\n          t('Owners is a list of users who can alter the dashboard. Searchable by name or username.') }\n        )] }\n      ),\n      _jsxs(Col, { xs: 24, md: 12, children: [\n        _jsx(\"h3\", { style: { marginTop: '1em' }, children: t('Colors') }),\n        _jsx(ColorSchemeControlWrapper, { hasCustomLabelsColor: hasCustomLabelsColor, onChange: onColorSchemeChange, colorScheme: colorScheme })] }\n      )] }\n    );\n  };\n  const getRowsWithRoles = () => {\n    const jsonMetadataObj = getJsonMetadata();\n    const hasCustomLabelsColor = !!Object.keys((jsonMetadataObj == null ? void 0 : jsonMetadataObj.label_colors) || {}).length;\n    return _jsxs(_Fragment, { children: [\n      _jsx(Row, { children:\n        _jsx(Col, { xs: 24, md: 24, children:\n          _jsx(\"h3\", { style: { marginTop: '1em' }, children: t('Access') }) }\n        ) }\n      ),\n      _jsxs(Row, { gutter: 16, children: [\n        _jsxs(Col, { xs: 24, md: 12, children: [\n          _jsx(StyledFormItem, { label: t('Owners'), children:\n            _jsx(AsyncSelect, { allowClear: true, allowNewOptions: true, ariaLabel: t('Owners'), disabled: isLoading, mode: \"multiple\", onChange: handleOnChangeOwners, options: (input, page, pageSize) => loadAccessOptions('owners', input, page, pageSize), value: handleOwnersSelectValue() }) }\n          ),\n          _jsx(\"p\", { className: \"help-block\", children:\n            t('Owners is a list of users who can alter the dashboard. Searchable by name or username.') }\n          )] }\n        ),\n        _jsxs(Col, { xs: 24, md: 12, children: [\n          _jsx(StyledFormItem, { label: t('Roles'), children:\n            _jsx(AsyncSelect, { allowClear: true, ariaLabel: t('Roles'), disabled: isLoading, mode: \"multiple\", onChange: handleOnChangeRoles, options: (input, page, pageSize) => loadAccessOptions('roles', input, page, pageSize), value: handleRolesSelectValue() }) }\n          ),\n          _jsx(\"p\", { className: \"help-block\", children:\n            t('Roles is a list which defines access to the dashboard. Granting a role access to a dashboard will bypass dataset level checks. If no roles are defined, regular access permissions apply.') }\n          )] }\n        )] }\n      ),\n      _jsx(Row, { children:\n        _jsx(Col, { xs: 24, md: 12, children:\n          _jsx(ColorSchemeControlWrapper, { hasCustomLabelsColor: hasCustomLabelsColor, onChange: onColorSchemeChange, colorScheme: colorScheme }) }\n        ) }\n      )] }\n    );\n  };\n  useEffect(() => {\n    if (show) {\n      if (!currentDashboardInfo) {\n        fetchDashboardDetails();\n      } else\n      {\n        handleDashboardData(currentDashboardInfo);\n      }\n    }\n    JsonEditor.preload();\n  }, [currentDashboardInfo, fetchDashboardDetails, handleDashboardData, show]);\n  useEffect(() => {\n    // the title can be changed inline in the dashboard, this catches it\n    if (dashboardTitle &&\n    dashboardInfo &&\n    dashboardInfo.title !== dashboardTitle) {\n      form.setFieldsValue({\n        ...dashboardInfo,\n        title: dashboardTitle\n      });\n    }\n  }, [dashboardInfo, dashboardTitle, form]);\n  useEffect(() => {\n    if (!isFeatureEnabled(FeatureFlag.TaggingSystem))\n    return;\n    try {\n      fetchTags({\n        objectType: OBJECT_TYPES.DASHBOARD,\n        objectId: dashboardId,\n        includeTypes: false\n      }, (tags) => setTags(tags), (error) => {\n        addDangerToast(`Error fetching tags: ${error.text}`);\n      });\n    }\n    catch (error) {\n      handleErrorResponse(error);\n    }\n  }, [dashboardId]);\n  const handleChangeTags = (tags) => {\n    const parsedTags = ensureIsArray(tags).map((r) => ({\n      id: r.value,\n      name: r.label\n    }));\n    setTags(parsedTags);\n  };\n  return _jsx(Modal, { show: show, onHide: handleOnCancel, title: t('Dashboard properties'), footer: _jsxs(_Fragment, { children: [\n      _jsx(Button, { htmlType: \"button\", buttonSize: \"small\", onClick: handleOnCancel, \"data-test\": \"properties-modal-cancel-button\", cta: true, children:\n        t('Cancel') }\n      ),\n      _jsx(Button, { \"data-test\": \"properties-modal-apply-button\", onClick: form.submit, buttonSize: \"small\", buttonStyle: \"primary\", className: \"m-r-5\", cta: true, disabled: dashboardInfo == null ? void 0 : dashboardInfo.isManagedExternally, tooltip: dashboardInfo != null && dashboardInfo.isManagedExternally ?\n        t(\"This dashboard is managed externally, and can't be edited in Superset\") :\n        '', children:\n        saveLabel }\n      )] }\n    ), responsive: true, children:\n    _jsxs(AntdForm, { form: form, onFinish: onFinish, \"data-test\": \"dashboard-edit-properties-form\", layout: \"vertical\", initialValues: dashboardInfo, children: [\n      _jsx(Row, { children:\n        _jsx(Col, { xs: 24, md: 24, children:\n          _jsx(\"h3\", { children: t('Basic information') }) }\n        ) }\n      ),\n      _jsxs(Row, { gutter: 16, children: [\n        _jsx(Col, { xs: 24, md: 12, children:\n          _jsx(FormItem, { label: t('Name'), name: \"title\", children:\n            _jsx(Input, { \"data-test\": \"dashboard-title-input\", type: \"text\", disabled: isLoading }) }\n          ) }\n        ),\n        _jsxs(Col, { xs: 24, md: 12, children: [\n          _jsx(StyledFormItem, { label: t('URL slug'), name: \"slug\", children:\n            _jsx(Input, { type: \"text\", disabled: isLoading }) }\n          ),\n          _jsx(\"p\", { className: \"help-block\", children:\n            t('A readable URL for your dashboard') }\n          )] }\n        )] }\n      ),\n      isFeatureEnabled(FeatureFlag.DashboardRbac) ?\n      getRowsWithRoles() :\n      getRowsWithoutRoles(),\n      _jsx(Row, { children:\n        _jsx(Col, { xs: 24, md: 24, children:\n          _jsx(\"h3\", { children: t('Certification') }) }\n        ) }\n      ),\n      _jsxs(Row, { gutter: 16, children: [\n        _jsxs(Col, { xs: 24, md: 12, children: [\n          _jsx(StyledFormItem, { label: t('Certified by'), name: \"certifiedBy\", children:\n            _jsx(Input, { type: \"text\", disabled: isLoading }) }\n          ),\n          _jsx(\"p\", { className: \"help-block\", children:\n            t('Person or group that has certified this dashboard.') }\n          )] }\n        ),\n        _jsxs(Col, { xs: 24, md: 12, children: [\n          _jsx(StyledFormItem, { label: t('Certification details'), name: \"certificationDetails\", children:\n            _jsx(Input, { type: \"text\", disabled: isLoading }) }\n          ),\n          _jsx(\"p\", { className: \"help-block\", children:\n            t('Any additional detail to show in the certification tooltip.') }\n          )] }\n        )] }\n      ),\n      isFeatureEnabled(FeatureFlag.TaggingSystem) ? _jsx(Row, { gutter: 16, children:\n        _jsx(Col, { xs: 24, md: 12, children:\n          _jsx(\"h3\", { css: _ref, children: t('Tags') }) }\n        ) }\n      ) : null,\n      isFeatureEnabled(FeatureFlag.TaggingSystem) ? _jsx(Row, { gutter: 16, children:\n        _jsxs(Col, { xs: 24, md: 12, children: [\n          _jsx(StyledFormItem, { children:\n            _jsx(AsyncSelect, { ariaLabel: \"Tags\", mode: \"multiple\", value: tagsAsSelectValues, options: loadTags, onChange: handleChangeTags, allowClear: true }) }\n          ),\n          _jsx(\"p\", { className: \"help-block\", children:\n            t('A list of tags that have been applied to this chart.') }\n          )] }\n        ) }\n      ) : null,\n      _jsx(Row, { children:\n        _jsxs(Col, { xs: 24, md: 24, children: [\n          _jsx(\"h3\", { style: { marginTop: '1em' }, children:\n            _jsxs(Button, { buttonStyle: \"link\", onClick: () => setIsAdvancedOpen(!isAdvancedOpen), css: css`\n                  padding: 0;\n                `, children: [\n\n              _jsx(\"i\", { className: `fa fa-angle-${isAdvancedOpen ? 'down' : 'right'}`, style: { minWidth: '1em' } }),\n              t('Advanced')] }\n            ) }\n          ),\n          isAdvancedOpen && _jsxs(_Fragment, { children: [\n            _jsx(StyledFormItem, { label: t('JSON metadata'), children:\n              _jsx(StyledJsonEditor, { showLoadingForImport: true, name: \"json_metadata\", value: jsonMetadata, onChange: setJsonMetadata, tabSize: 2, width: \"100%\", height: \"200px\", wrapEnabled: true }) }\n            ),\n            _jsxs(\"p\", { className: \"help-block\", children: [\n              t('This JSON object is generated dynamically when clicking the save or overwrite button in the dashboard view. It is exposed here for reference and for power users who may want to alter specific parameters.'),\n              onlyApply && _jsxs(_Fragment, { children: [\n                ' ',\n                t('Please DO NOT overwrite the \"filter_scopes\" key.'), ' ',\n                _jsx(FilterScopeModal, { triggerNode: _jsx(\"span\", { className: \"alert-link\", children:\n                    t('Use \"%(menuName)s\" menu instead.', {\n                      menuName: t('Set filter mapping')\n                    }) }\n                  ) })] }\n              )] }\n            )] }\n          )] }\n        ) }\n      )] }\n    ) }\n  );\n};__signature__(PropertiesModal, \"useDispatch{dispatch}\\nuseForm{[form]}\\nuseState{[isLoading, setIsLoading](false)}\\nuseState{[isAdvancedOpen, setIsAdvancedOpen](false)}\\nuseState{[colorScheme, setCurrentColorScheme](currentColorScheme)}\\nuseState{[jsonMetadata, setJsonMetadata]('')}\\nuseState{[dashboardInfo, setDashboardInfo]}\\nuseState{[owners, setOwners]([])}\\nuseState{[roles, setRoles]([])}\\nuseState{[tags, setTags]([])}\\nuseRef{originalDashboardMetadata}\\nuseMemo{tagsAsSelectValues}\\nuseCallback{loadAccessOptions}\\nuseCallback{handleDashboardData}\\nuseCallback{fetchDashboardDetails}\\nuseEffect{}\\nuseEffect{}\\nuseEffect{}\", () => [useDispatch]);const _default =\nwithToasts(PropertiesModal);export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(StyledFormItem, \"StyledFormItem\", \"/Users/aryurkov/superset/superset-frontend/src/dashboard/components/PropertiesModal/index.tsx\");reactHotLoader.register(StyledJsonEditor, \"StyledJsonEditor\", \"/Users/aryurkov/superset/superset-frontend/src/dashboard/components/PropertiesModal/index.tsx\");reactHotLoader.register(PropertiesModal, \"PropertiesModal\", \"/Users/aryurkov/superset/superset-frontend/src/dashboard/components/PropertiesModal/index.tsx\");reactHotLoader.register(_default, \"default\", \"/Users/aryurkov/superset/superset-frontend/src/dashboard/components/PropertiesModal/index.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["useCallback","useEffect","useMemo","useRef","useState","Input","FormItem","jsonStringify","Button","AntdForm","AsyncSelect","Col","Row","rison","ensureIsArray","isFeatureEnabled","FeatureFlag","getCategoricalSchemeRegistry","styled","SupersetClient","t","getClientErrorObject","css","Modal","JsonEditor","ColorSchemeControlWrapper","FilterScopeModal","withToasts","fetchTags","OBJECT_TYPES","loadTags","applyColors","getColorNamespace","getFreshLabelsColorMapEntries","getOwnerName","useDispatch","setColorScheme","setDashboardMetadata","areObjectsEqual","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","StyledFormItem","StyledJsonEditor","theme","borderRadius","colors","secondary","light2","_ref","process","env","NODE_ENV","name","styles","toString","_EMOTION_STRINGIFIED_CSS_ERROR__","PropertiesModal","addSuccessToast","addDangerToast","colorScheme","currentColorScheme","dashboardId","dashboardInfo","currentDashboardInfo","dashboardTitle","onHide","onlyApply","onSubmit","show","dispatch","form","useForm","isLoading","setIsLoading","isAdvancedOpen","setIsAdvancedOpen","setCurrentColorScheme","jsonMetadata","setJsonMetadata","setDashboardInfo","owners","setOwners","roles","setRoles","saveLabel","tags","setTags","categoricalSchemeRegistry","originalDashboardMetadata","tagsAsSelectValues","selectTags","map","tag","value","id","label","length","handleErrorResponse","response","error","statusText","message","errorText","json_metadata","title","content","okButtonProps","danger","className","loadAccessOptions","accessType","input","page","pageSize","query","encode","filter","page_size","get","endpoint","then","data","json","result","item","extra","active","undefined","text","totalCount","count","handleDashboardData","dashboardData","dashboard_title","slug","certified_by","certification_details","metadata","is_managed_externally","certifiedBy","certificationDetails","isManagedExternally","setFieldsValue","color_scheme","metaDataCopy","_omit","current","fetchDashboardDetails","_dashboard$json_metad","dashboard","jsonMetadataObj","JSON","parse","getJsonMetadata","_","handleOnChangeOwners","parsedOwners","o","full_name","handleOnChangeRoles","parsedRoles","r","handleOwnersSelectValue","owner","handleRolesSelectValue","role","handleOnCancel","onColorSchemeChange","updateMetadata","colorChoices","keys","includes","Error","label_colors","onFinish","_metadata","_metadata2","_metadata3","_metadata4","getFieldsValue","currentJsonMetadata","startsWith","endsWith","colorNamespace","color_namespace","updatedColorScheme","shouldGoFresh","shouldResetCustomLabels","currentCustomLabels","Object","prevCustomLabels","resettableCustomLabels","freshCustomLabels","customLabelColors","updatedDashboardMetadata","map_label_colors","moreOnSubmitProps","morePutProps","DashboardRbac","TaggingSystem","onSubmitProps","put","headers","body","stringify","getRowsWithoutRoles","hasCustomLabelsColor","gutter","children","xs","md","style","marginTop","allowClear","ariaLabel","disabled","mode","onChange","options","getRowsWithRoles","allowNewOptions","preload","objectType","DASHBOARD","objectId","includeTypes","handleChangeTags","parsedTags","footer","htmlType","buttonSize","onClick","cta","submit","buttonStyle","tooltip","responsive","layout","initialValues","type","minWidth","showLoadingForImport","tabSize","width","height","wrapEnabled","triggerNode","menuName","__signature__","_default","reactHotLoader","reactHotLoaderGlobal","default","register","leaveModule","module"],"sources":["/Users/aryurkov/superset/superset-frontend/src/dashboard/components/PropertiesModal/index.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { omit } from 'lodash';\nimport { Input } from 'src/components/Input';\nimport { FormItem } from 'src/components/Form';\nimport jsonStringify from 'json-stringify-pretty-compact';\nimport Button from 'src/components/Button';\nimport { AntdForm, AsyncSelect, Col, Row } from 'src/components';\nimport rison from 'rison';\nimport {\n  ensureIsArray,\n  isFeatureEnabled,\n  FeatureFlag,\n  getCategoricalSchemeRegistry,\n  styled,\n  SupersetClient,\n  t,\n  getClientErrorObject,\n  css,\n} from '@superset-ui/core';\n\nimport Modal from 'src/components/Modal';\nimport { JsonEditor } from 'src/components/AsyncAceEditor';\n\nimport ColorSchemeControlWrapper from 'src/dashboard/components/ColorSchemeControlWrapper';\nimport FilterScopeModal from 'src/dashboard/components/filterscope/FilterScopeModal';\nimport withToasts from 'src/components/MessageToasts/withToasts';\nimport TagType from 'src/types/TagType';\nimport { fetchTags, OBJECT_TYPES } from 'src/features/tags/tags';\nimport { loadTags } from 'src/components/Tags/utils';\nimport {\n  applyColors,\n  getColorNamespace,\n  getFreshLabelsColorMapEntries,\n} from 'src/utils/colorScheme';\nimport getOwnerName from 'src/utils/getOwnerName';\nimport Owner from 'src/types/Owner';\nimport { useDispatch } from 'react-redux';\nimport {\n  setColorScheme,\n  setDashboardMetadata,\n} from 'src/dashboard/actions/dashboardState';\nimport { areObjectsEqual } from 'src/reduxUtils';\n\nconst StyledFormItem = styled(FormItem)`\n  margin-bottom: 0;\n`;\n\nconst StyledJsonEditor = styled(JsonEditor)`\n  border-radius: ${({ theme }) => theme.borderRadius}px;\n  border: 1px solid ${({ theme }) => theme.colors.secondary.light2};\n`;\n\ntype PropertiesModalProps = {\n  dashboardId: number;\n  dashboardTitle?: string;\n  dashboardInfo?: Record<string, any>;\n  show?: boolean;\n  onHide?: () => void;\n  colorScheme?: string;\n  onSubmit?: (params: Record<string, any>) => void;\n  addSuccessToast: (message: string) => void;\n  addDangerToast: (message: string) => void;\n  onlyApply?: boolean;\n};\n\ntype Roles = { id: number; name: string }[];\ntype Owners = {\n  id: number;\n  full_name?: string;\n  first_name?: string;\n  last_name?: string;\n}[];\ntype DashboardInfo = {\n  id: number;\n  title: string;\n  slug: string;\n  certifiedBy: string;\n  certificationDetails: string;\n  isManagedExternally: boolean;\n  metadata: Record<string, any>;\n};\n\nconst PropertiesModal = ({\n  addSuccessToast,\n  addDangerToast,\n  colorScheme: currentColorScheme,\n  dashboardId,\n  dashboardInfo: currentDashboardInfo,\n  dashboardTitle,\n  onHide = () => {},\n  onlyApply = false,\n  onSubmit = () => {},\n  show = false,\n}: PropertiesModalProps) => {\n  const dispatch = useDispatch();\n  const [form] = AntdForm.useForm();\n  const [isLoading, setIsLoading] = useState(false);\n  const [isAdvancedOpen, setIsAdvancedOpen] = useState(false);\n  const [colorScheme, setCurrentColorScheme] = useState(currentColorScheme);\n  const [jsonMetadata, setJsonMetadata] = useState('');\n  const [dashboardInfo, setDashboardInfo] = useState<DashboardInfo>();\n  const [owners, setOwners] = useState<Owners>([]);\n  const [roles, setRoles] = useState<Roles>([]);\n  const saveLabel = onlyApply ? t('Apply') : t('Save');\n  const [tags, setTags] = useState<TagType[]>([]);\n  const categoricalSchemeRegistry = getCategoricalSchemeRegistry();\n  const originalDashboardMetadata = useRef<Record<string, any>>({});\n\n  const tagsAsSelectValues = useMemo(() => {\n    const selectTags = tags.map((tag: { id: number; name: string }) => ({\n      value: tag.id,\n      label: tag.name,\n    }));\n    return selectTags;\n  }, [tags.length]);\n\n  const handleErrorResponse = async (response: Response) => {\n    const { error, statusText, message } = await getClientErrorObject(response);\n    let errorText = error || statusText || t('An error has occurred');\n    if (typeof message === 'object' && 'json_metadata' in message) {\n      errorText = (message as { json_metadata: string }).json_metadata;\n    } else if (typeof message === 'string') {\n      errorText = message;\n\n      if (message === 'Forbidden') {\n        errorText = t('You do not have permission to edit this dashboard');\n      }\n    }\n\n    Modal.error({\n      title: t('Error'),\n      content: errorText,\n      okButtonProps: { danger: true, className: 'btn-danger' },\n    });\n  };\n\n  const loadAccessOptions = useCallback(\n    (accessType = 'owners', input = '', page: number, pageSize: number) => {\n      const query = rison.encode({\n        filter: input,\n        page,\n        page_size: pageSize,\n      });\n      return SupersetClient.get({\n        endpoint: `/api/v1/dashboard/related/${accessType}?q=${query}`,\n      }).then(response => ({\n        data: response.json.result\n          .filter((item: { extra: { active: boolean } }) =>\n            item.extra.active !== undefined ? item.extra.active : true,\n          )\n          .map((item: { value: number; text: string }) => ({\n            value: item.value,\n            label: item.text,\n          })),\n        totalCount: response.json.count,\n      }));\n    },\n    [],\n  );\n\n  const handleDashboardData = useCallback(\n    dashboardData => {\n      const {\n        id,\n        dashboard_title,\n        slug,\n        certified_by,\n        certification_details,\n        owners,\n        roles,\n        metadata,\n        is_managed_externally,\n      } = dashboardData;\n      const dashboardInfo = {\n        id,\n        title: dashboard_title,\n        slug: slug || '',\n        certifiedBy: certified_by || '',\n        certificationDetails: certification_details || '',\n        isManagedExternally: is_managed_externally || false,\n        metadata,\n      };\n\n      form.setFieldsValue(dashboardInfo);\n      setDashboardInfo(dashboardInfo);\n      setOwners(owners);\n      setRoles(roles);\n      setCurrentColorScheme(metadata.color_scheme);\n\n      const metaDataCopy = omit(metadata, [\n        'positions',\n        'shared_label_colors',\n        'map_label_colors',\n        'color_scheme_domain',\n      ]);\n\n      setJsonMetadata(metaDataCopy ? jsonStringify(metaDataCopy) : '');\n      originalDashboardMetadata.current = metadata;\n    },\n    [form],\n  );\n\n  const fetchDashboardDetails = useCallback(() => {\n    setIsLoading(true);\n    // We fetch the dashboard details because not all code\n    // that renders this component have all the values we need.\n    // At some point when we have a more consistent frontend\n    // datamodel, the dashboard could probably just be passed as a prop.\n    SupersetClient.get({\n      endpoint: `/api/v1/dashboard/${dashboardId}`,\n    }).then(response => {\n      const dashboard = response.json.result;\n      const jsonMetadataObj = dashboard.json_metadata?.length\n        ? JSON.parse(dashboard.json_metadata)\n        : {};\n\n      handleDashboardData({\n        ...dashboard,\n        metadata: jsonMetadataObj,\n      });\n\n      setIsLoading(false);\n    }, handleErrorResponse);\n  }, [dashboardId, handleDashboardData]);\n\n  const getJsonMetadata = () => {\n    try {\n      const jsonMetadataObj = jsonMetadata?.length\n        ? JSON.parse(jsonMetadata)\n        : {};\n      return jsonMetadataObj;\n    } catch (_) {\n      return {};\n    }\n  };\n\n  const handleOnChangeOwners = (owners: { value: number; label: string }[]) => {\n    const parsedOwners: Owners = ensureIsArray(owners).map(o => ({\n      id: o.value,\n      full_name: o.label,\n    }));\n    setOwners(parsedOwners);\n  };\n\n  const handleOnChangeRoles = (roles: { value: number; label: string }[]) => {\n    const parsedRoles: Roles = ensureIsArray(roles).map(r => ({\n      id: r.value,\n      name: r.label,\n    }));\n    setRoles(parsedRoles);\n  };\n\n  const handleOwnersSelectValue = () => {\n    const parsedOwners = (owners || []).map((owner: Owner) => ({\n      value: owner.id,\n      label: getOwnerName(owner),\n    }));\n    return parsedOwners;\n  };\n\n  const handleRolesSelectValue = () => {\n    const parsedRoles = (roles || []).map(\n      (role: { id: number; name: string }) => ({\n        value: role.id,\n        label: `${role.name}`,\n      }),\n    );\n    return parsedRoles;\n  };\n\n  const handleOnCancel = () => onHide();\n\n  const onColorSchemeChange = (\n    colorScheme = '',\n    { updateMetadata = true } = {},\n  ) => {\n    // check that color_scheme is valid\n    const colorChoices = categoricalSchemeRegistry.keys();\n    const jsonMetadataObj = getJsonMetadata();\n\n    // only fire if the color_scheme is present and invalid\n    if (colorScheme && !colorChoices.includes(colorScheme)) {\n      Modal.error({\n        title: t('Error'),\n        content: t('A valid color scheme is required'),\n        okButtonProps: { danger: true, className: 'btn-danger' },\n      });\n      onHide();\n      throw new Error('A valid color scheme is required');\n    }\n\n    jsonMetadataObj.color_scheme = colorScheme;\n    jsonMetadataObj.label_colors = jsonMetadataObj.label_colors || {};\n\n    setCurrentColorScheme(colorScheme);\n    dispatch(setColorScheme(colorScheme));\n\n    // update metadata to match selection\n    if (updateMetadata) {\n      setJsonMetadata(jsonStringify(jsonMetadataObj));\n    }\n  };\n\n  const onFinish = () => {\n    const { title, slug, certifiedBy, certificationDetails } =\n      form.getFieldsValue();\n    let currentJsonMetadata = jsonMetadata;\n\n    // validate currentJsonMetadata\n    let metadata;\n    try {\n      if (\n        !currentJsonMetadata.startsWith('{') ||\n        !currentJsonMetadata.endsWith('}')\n      ) {\n        throw new Error();\n      }\n      metadata = JSON.parse(currentJsonMetadata);\n    } catch (error) {\n      addDangerToast(t('JSON metadata is invalid!'));\n      return;\n    }\n\n    const colorNamespace = getColorNamespace(metadata?.color_namespace);\n    // color scheme in json metadata has precedence over selection\n    const updatedColorScheme = metadata?.color_scheme || colorScheme;\n    const shouldGoFresh =\n      updatedColorScheme !== originalDashboardMetadata.current.color_scheme;\n    const shouldResetCustomLabels = !areObjectsEqual(\n      originalDashboardMetadata.current.label_colors || {},\n      metadata?.label_colors || {},\n    );\n    const currentCustomLabels = Object.keys(metadata?.label_colors || {});\n    const prevCustomLabels = Object.keys(\n      originalDashboardMetadata.current.label_colors || {},\n    );\n    const resettableCustomLabels =\n      currentCustomLabels.length > 0 ? currentCustomLabels : prevCustomLabels;\n    const freshCustomLabels =\n      shouldResetCustomLabels && resettableCustomLabels.length > 0\n        ? resettableCustomLabels\n        : false;\n    const jsonMetadataObj = getJsonMetadata();\n    const customLabelColors = jsonMetadataObj.label_colors || {};\n    const updatedDashboardMetadata = {\n      ...originalDashboardMetadata.current,\n      label_colors: customLabelColors,\n      color_scheme: updatedColorScheme,\n    };\n\n    originalDashboardMetadata.current = updatedDashboardMetadata;\n    applyColors(updatedDashboardMetadata, shouldGoFresh || freshCustomLabels);\n    dispatch(\n      setDashboardMetadata({\n        ...updatedDashboardMetadata,\n        map_label_colors: getFreshLabelsColorMapEntries(customLabelColors),\n      }),\n    );\n\n    onColorSchemeChange(updatedColorScheme, {\n      updateMetadata: false,\n    });\n\n    currentJsonMetadata = jsonStringify(metadata);\n\n    const moreOnSubmitProps: { roles?: Roles } = {};\n    const morePutProps: { roles?: number[]; tags?: (number | undefined)[] } =\n      {};\n    if (isFeatureEnabled(FeatureFlag.DashboardRbac)) {\n      moreOnSubmitProps.roles = roles;\n      morePutProps.roles = (roles || []).map(r => r.id);\n    }\n    if (isFeatureEnabled(FeatureFlag.TaggingSystem)) {\n      morePutProps.tags = tags.map(tag => tag.id);\n    }\n    const onSubmitProps = {\n      id: dashboardId,\n      title,\n      slug,\n      jsonMetadata: currentJsonMetadata,\n      owners,\n      colorScheme: currentColorScheme,\n      colorNamespace,\n      certifiedBy,\n      certificationDetails,\n      ...moreOnSubmitProps,\n    };\n    if (onlyApply) {\n      onSubmit(onSubmitProps);\n      onHide();\n      addSuccessToast(t('Dashboard properties updated'));\n    } else {\n      SupersetClient.put({\n        endpoint: `/api/v1/dashboard/${dashboardId}`,\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          dashboard_title: title,\n          slug: slug || null,\n          json_metadata: currentJsonMetadata || null,\n          owners: (owners || []).map(o => o.id),\n          certified_by: certifiedBy || null,\n          certification_details:\n            certifiedBy && certificationDetails ? certificationDetails : null,\n          ...morePutProps,\n        }),\n      }).then(() => {\n        onSubmit(onSubmitProps);\n        onHide();\n        addSuccessToast(t('The dashboard has been saved'));\n      }, handleErrorResponse);\n    }\n  };\n\n  const getRowsWithoutRoles = () => {\n    const jsonMetadataObj = getJsonMetadata();\n    const hasCustomLabelsColor = !!Object.keys(\n      jsonMetadataObj?.label_colors || {},\n    ).length;\n\n    return (\n      <Row gutter={16}>\n        <Col xs={24} md={12}>\n          <h3 style={{ marginTop: '1em' }}>{t('Access')}</h3>\n          <StyledFormItem label={t('Owners')}>\n            <AsyncSelect\n              allowClear\n              ariaLabel={t('Owners')}\n              disabled={isLoading}\n              mode=\"multiple\"\n              onChange={handleOnChangeOwners}\n              options={(input, page, pageSize) =>\n                loadAccessOptions('owners', input, page, pageSize)\n              }\n              value={handleOwnersSelectValue()}\n            />\n          </StyledFormItem>\n          <p className=\"help-block\">\n            {t(\n              'Owners is a list of users who can alter the dashboard. Searchable by name or username.',\n            )}\n          </p>\n        </Col>\n        <Col xs={24} md={12}>\n          <h3 style={{ marginTop: '1em' }}>{t('Colors')}</h3>\n          <ColorSchemeControlWrapper\n            hasCustomLabelsColor={hasCustomLabelsColor}\n            onChange={onColorSchemeChange}\n            colorScheme={colorScheme}\n          />\n        </Col>\n      </Row>\n    );\n  };\n\n  const getRowsWithRoles = () => {\n    const jsonMetadataObj = getJsonMetadata();\n    const hasCustomLabelsColor = !!Object.keys(\n      jsonMetadataObj?.label_colors || {},\n    ).length;\n\n    return (\n      <>\n        <Row>\n          <Col xs={24} md={24}>\n            <h3 style={{ marginTop: '1em' }}>{t('Access')}</h3>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col xs={24} md={12}>\n            <StyledFormItem label={t('Owners')}>\n              <AsyncSelect\n                allowClear\n                allowNewOptions\n                ariaLabel={t('Owners')}\n                disabled={isLoading}\n                mode=\"multiple\"\n                onChange={handleOnChangeOwners}\n                options={(input, page, pageSize) =>\n                  loadAccessOptions('owners', input, page, pageSize)\n                }\n                value={handleOwnersSelectValue()}\n              />\n            </StyledFormItem>\n            <p className=\"help-block\">\n              {t(\n                'Owners is a list of users who can alter the dashboard. Searchable by name or username.',\n              )}\n            </p>\n          </Col>\n          <Col xs={24} md={12}>\n            <StyledFormItem label={t('Roles')}>\n              <AsyncSelect\n                allowClear\n                ariaLabel={t('Roles')}\n                disabled={isLoading}\n                mode=\"multiple\"\n                onChange={handleOnChangeRoles}\n                options={(input, page, pageSize) =>\n                  loadAccessOptions('roles', input, page, pageSize)\n                }\n                value={handleRolesSelectValue()}\n              />\n            </StyledFormItem>\n            <p className=\"help-block\">\n              {t(\n                'Roles is a list which defines access to the dashboard. Granting a role access to a dashboard will bypass dataset level checks. If no roles are defined, regular access permissions apply.',\n              )}\n            </p>\n          </Col>\n        </Row>\n        <Row>\n          <Col xs={24} md={12}>\n            <ColorSchemeControlWrapper\n              hasCustomLabelsColor={hasCustomLabelsColor}\n              onChange={onColorSchemeChange}\n              colorScheme={colorScheme}\n            />\n          </Col>\n        </Row>\n      </>\n    );\n  };\n\n  useEffect(() => {\n    if (show) {\n      if (!currentDashboardInfo) {\n        fetchDashboardDetails();\n      } else {\n        handleDashboardData(currentDashboardInfo);\n      }\n    }\n\n    JsonEditor.preload();\n  }, [currentDashboardInfo, fetchDashboardDetails, handleDashboardData, show]);\n\n  useEffect(() => {\n    // the title can be changed inline in the dashboard, this catches it\n    if (\n      dashboardTitle &&\n      dashboardInfo &&\n      dashboardInfo.title !== dashboardTitle\n    ) {\n      form.setFieldsValue({\n        ...dashboardInfo,\n        title: dashboardTitle,\n      });\n    }\n  }, [dashboardInfo, dashboardTitle, form]);\n\n  useEffect(() => {\n    if (!isFeatureEnabled(FeatureFlag.TaggingSystem)) return;\n    try {\n      fetchTags(\n        {\n          objectType: OBJECT_TYPES.DASHBOARD,\n          objectId: dashboardId,\n          includeTypes: false,\n        },\n        (tags: TagType[]) => setTags(tags),\n        (error: Response) => {\n          addDangerToast(`Error fetching tags: ${error.text}`);\n        },\n      );\n    } catch (error) {\n      handleErrorResponse(error);\n    }\n  }, [dashboardId]);\n\n  const handleChangeTags = (tags: { label: string; value: number }[]) => {\n    const parsedTags: TagType[] = ensureIsArray(tags).map(r => ({\n      id: r.value,\n      name: r.label,\n    }));\n    setTags(parsedTags);\n  };\n\n  return (\n    <Modal\n      show={show}\n      onHide={handleOnCancel}\n      title={t('Dashboard properties')}\n      footer={\n        <>\n          <Button\n            htmlType=\"button\"\n            buttonSize=\"small\"\n            onClick={handleOnCancel}\n            data-test=\"properties-modal-cancel-button\"\n            cta\n          >\n            {t('Cancel')}\n          </Button>\n          <Button\n            data-test=\"properties-modal-apply-button\"\n            onClick={form.submit}\n            buttonSize=\"small\"\n            buttonStyle=\"primary\"\n            className=\"m-r-5\"\n            cta\n            disabled={dashboardInfo?.isManagedExternally}\n            tooltip={\n              dashboardInfo?.isManagedExternally\n                ? t(\n                    \"This dashboard is managed externally, and can't be edited in Superset\",\n                  )\n                : ''\n            }\n          >\n            {saveLabel}\n          </Button>\n        </>\n      }\n      responsive\n    >\n      <AntdForm\n        form={form}\n        onFinish={onFinish}\n        data-test=\"dashboard-edit-properties-form\"\n        layout=\"vertical\"\n        initialValues={dashboardInfo}\n      >\n        <Row>\n          <Col xs={24} md={24}>\n            <h3>{t('Basic information')}</h3>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col xs={24} md={12}>\n            <FormItem label={t('Name')} name=\"title\">\n              <Input\n                data-test=\"dashboard-title-input\"\n                type=\"text\"\n                disabled={isLoading}\n              />\n            </FormItem>\n          </Col>\n          <Col xs={24} md={12}>\n            <StyledFormItem label={t('URL slug')} name=\"slug\">\n              <Input type=\"text\" disabled={isLoading} />\n            </StyledFormItem>\n            <p className=\"help-block\">\n              {t('A readable URL for your dashboard')}\n            </p>\n          </Col>\n        </Row>\n        {isFeatureEnabled(FeatureFlag.DashboardRbac)\n          ? getRowsWithRoles()\n          : getRowsWithoutRoles()}\n        <Row>\n          <Col xs={24} md={24}>\n            <h3>{t('Certification')}</h3>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col xs={24} md={12}>\n            <StyledFormItem label={t('Certified by')} name=\"certifiedBy\">\n              <Input type=\"text\" disabled={isLoading} />\n            </StyledFormItem>\n            <p className=\"help-block\">\n              {t('Person or group that has certified this dashboard.')}\n            </p>\n          </Col>\n          <Col xs={24} md={12}>\n            <StyledFormItem\n              label={t('Certification details')}\n              name=\"certificationDetails\"\n            >\n              <Input type=\"text\" disabled={isLoading} />\n            </StyledFormItem>\n            <p className=\"help-block\">\n              {t('Any additional detail to show in the certification tooltip.')}\n            </p>\n          </Col>\n        </Row>\n        {isFeatureEnabled(FeatureFlag.TaggingSystem) ? (\n          <Row gutter={16}>\n            <Col xs={24} md={12}>\n              <h3 css={{ marginTop: '1em' }}>{t('Tags')}</h3>\n            </Col>\n          </Row>\n        ) : null}\n        {isFeatureEnabled(FeatureFlag.TaggingSystem) ? (\n          <Row gutter={16}>\n            <Col xs={24} md={12}>\n              <StyledFormItem>\n                <AsyncSelect\n                  ariaLabel=\"Tags\"\n                  mode=\"multiple\"\n                  value={tagsAsSelectValues}\n                  options={loadTags}\n                  onChange={handleChangeTags}\n                  allowClear\n                />\n              </StyledFormItem>\n              <p className=\"help-block\">\n                {t('A list of tags that have been applied to this chart.')}\n              </p>\n            </Col>\n          </Row>\n        ) : null}\n        <Row>\n          <Col xs={24} md={24}>\n            <h3 style={{ marginTop: '1em' }}>\n              <Button\n                buttonStyle=\"link\"\n                onClick={() => setIsAdvancedOpen(!isAdvancedOpen)}\n                css={css`\n                  padding: 0;\n                `}\n              >\n                {/* TODO: Remove fa-icon */}\n                <i\n                  className={`fa fa-angle-${isAdvancedOpen ? 'down' : 'right'}`}\n                  style={{ minWidth: '1em' }}\n                />\n                {t('Advanced')}\n              </Button>\n            </h3>\n            {isAdvancedOpen && (\n              <>\n                <StyledFormItem label={t('JSON metadata')}>\n                  <StyledJsonEditor\n                    showLoadingForImport\n                    name=\"json_metadata\"\n                    value={jsonMetadata}\n                    onChange={setJsonMetadata}\n                    tabSize={2}\n                    width=\"100%\"\n                    height=\"200px\"\n                    wrapEnabled\n                  />\n                </StyledFormItem>\n                <p className=\"help-block\">\n                  {t(\n                    'This JSON object is generated dynamically when clicking the save or overwrite button in the dashboard view. It is exposed here for reference and for power users who may want to alter specific parameters.',\n                  )}\n                  {onlyApply && (\n                    <>\n                      {' '}\n                      {t(\n                        'Please DO NOT overwrite the \"filter_scopes\" key.',\n                      )}{' '}\n                      <FilterScopeModal\n                        triggerNode={\n                          <span className=\"alert-link\">\n                            {t('Use \"%(menuName)s\" menu instead.', {\n                              menuName: t('Set filter mapping'),\n                            })}\n                          </span>\n                        }\n                      />\n                    </>\n                  )}\n                </p>\n              </>\n            )}\n          </Col>\n        </Row>\n      </AntdForm>\n    </Modal>\n  );\n};\n\nexport default withToasts(PropertiesModal);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}