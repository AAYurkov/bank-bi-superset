{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { PureComponent } from 'react';\nimport { Dropdown } from 'src/components/Dropdown';\nimport rison from 'rison';\nimport { Menu } from 'src/components/Menu';\nimport Button from 'src/components/Button';\nimport { t, styled, SupersetClient } from '@superset-ui/core';\nimport ModalTrigger from 'src/components/ModalTrigger';\nimport { CssEditor as AceCssEditor } from 'src/components/AsyncAceEditor';import { jsx as _jsx, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nconst StyledWrapper = styled.div`\n  ${({ theme }) => `\n    .css-editor-header {\n      display: flex;\n      flex-direction: row;\n      justify-content: space-between;\n      margin-bottom: ${theme.gridUnit * 2}px;\n\n      h5 {\n        margin-top: ${theme.gridUnit}px;\n      }\n    }\n    .css-editor {\n      border: 1px solid ${theme.colors.grayscale.light1};\n    }\n  `}\n`;\nclass CssEditor extends PureComponent {\n\n\n\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      css: props.initialCss\n    };\n    this.changeCss = this.changeCss.bind(this);\n    this.changeCssTemplate = this.changeCssTemplate.bind(this);\n  }\n  componentDidMount() {\n    AceCssEditor.preload();\n    const query = rison.encode({ columns: ['template_name', 'css'] });\n    SupersetClient.get({ endpoint: `/api/v1/css_template/?q=${query}` }).\n    then(({ json }) => {\n      const templates = json.result.map((row) => ({\n        value: row.template_name,\n        css: row.css,\n        label: row.template_name\n      }));\n      this.setState({ templates });\n    }).\n    catch(() => {\n      this.props.addDangerToast(t('An error occurred while fetching available CSS templates'));\n    });\n  }\n  changeCss(css) {\n    this.setState({ css }, () => {\n      this.props.onChange(css);\n    });\n  }\n  changeCssTemplate(info) {\n    const keyAsString = String(info.key);\n    this.changeCss(keyAsString);\n  }\n  renderTemplateSelector() {\n    if (this.state.templates) {\n      const menu = _jsx(Menu, { onClick: this.changeCssTemplate, children:\n        this.state.templates.map((template) => _jsx(Menu.Item, { children: template.label }, template.css)) }\n      );\n      return _jsx(Dropdown, { dropdownRender: () => menu, placement: \"bottomRight\", children:\n        _jsx(Button, { children: t('Load a CSS template') }) }\n      );\n    }\n    return null;\n  }\n  render() {\n    return _jsx(ModalTrigger, { triggerNode: this.props.triggerNode, modalTitle: t('CSS'), modalBody: _jsxs(StyledWrapper, { children: [\n        _jsxs(\"div\", { className: \"css-editor-header\", children: [\n          _jsx(\"h5\", { children: t('Live CSS editor') }),\n          this.renderTemplateSelector()] }\n        ),\n        _jsx(AceCssEditor, { className: \"css-editor\", minLines: 12, maxLines: 30, onChange: this.changeCss, height: \"200px\", width: \"100%\", editorProps: { $blockScrolling: true }, enableLiveAutocompletion: true, value: this.state.css || '' })] }\n      ) });\n  } // @ts-ignore\n  __reactstandin__regenerateByEval(key, code) {// @ts-ignore\n    this[key] = eval(code);}}CssEditor.defaultProps = { initialCss: '', onChange: () => {} };const _default = CssEditor;export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(StyledWrapper, \"StyledWrapper\", \"/Users/aryurkov/superset/superset-frontend/src/dashboard/components/CssEditor/index.tsx\");reactHotLoader.register(CssEditor, \"CssEditor\", \"/Users/aryurkov/superset/superset-frontend/src/dashboard/components/CssEditor/index.tsx\");reactHotLoader.register(_default, \"default\", \"/Users/aryurkov/superset/superset-frontend/src/dashboard/components/CssEditor/index.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["PureComponent","Dropdown","rison","Menu","Button","t","styled","SupersetClient","ModalTrigger","CssEditor","AceCssEditor","jsx","_jsx","jsxs","_jsxs","StyledWrapper","div","theme","gridUnit","colors","grayscale","light1","constructor","props","state","css","initialCss","changeCss","bind","changeCssTemplate","componentDidMount","preload","query","encode","columns","get","endpoint","then","json","templates","result","map","row","value","template_name","label","setState","catch","addDangerToast","onChange","info","keyAsString","String","key","renderTemplateSelector","menu","onClick","children","template","Item","dropdownRender","placement","render","triggerNode","modalTitle","modalBody","className","minLines","maxLines","height","width","editorProps","$blockScrolling","enableLiveAutocompletion","__reactstandin__regenerateByEval","code","eval","defaultProps","_default","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/Users/aryurkov/superset/superset-frontend/src/dashboard/components/CssEditor/index.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Key, ReactNode, PureComponent } from 'react';\nimport { Dropdown } from 'src/components/Dropdown';\nimport rison from 'rison';\nimport { Menu } from 'src/components/Menu';\nimport Button from 'src/components/Button';\nimport { t, styled, SupersetClient } from '@superset-ui/core';\nimport ModalTrigger from 'src/components/ModalTrigger';\nimport { CssEditor as AceCssEditor } from 'src/components/AsyncAceEditor';\n\nexport interface CssEditorProps {\n  initialCss: string;\n  triggerNode: ReactNode;\n  onChange: (css: string) => void;\n  addDangerToast: (msg: string) => void;\n}\n\nexport type CssEditorState = {\n  css: string;\n  templates?: Array<{\n    css: string;\n    label: string;\n  }>;\n};\nconst StyledWrapper = styled.div`\n  ${({ theme }) => `\n    .css-editor-header {\n      display: flex;\n      flex-direction: row;\n      justify-content: space-between;\n      margin-bottom: ${theme.gridUnit * 2}px;\n\n      h5 {\n        margin-top: ${theme.gridUnit}px;\n      }\n    }\n    .css-editor {\n      border: 1px solid ${theme.colors.grayscale.light1};\n    }\n  `}\n`;\n\nclass CssEditor extends PureComponent<CssEditorProps, CssEditorState> {\n  static defaultProps: Partial<CssEditorProps> = {\n    initialCss: '',\n    onChange: () => {},\n  };\n\n  constructor(props: CssEditorProps) {\n    super(props);\n    this.state = {\n      css: props.initialCss,\n    };\n    this.changeCss = this.changeCss.bind(this);\n    this.changeCssTemplate = this.changeCssTemplate.bind(this);\n  }\n\n  componentDidMount() {\n    AceCssEditor.preload();\n    const query = rison.encode({ columns: ['template_name', 'css'] });\n    SupersetClient.get({ endpoint: `/api/v1/css_template/?q=${query}` })\n      .then(({ json }) => {\n        const templates = json.result.map(\n          (row: { template_name: string; css: string }) => ({\n            value: row.template_name,\n            css: row.css,\n            label: row.template_name,\n          }),\n        );\n\n        this.setState({ templates });\n      })\n      .catch(() => {\n        this.props.addDangerToast(\n          t('An error occurred while fetching available CSS templates'),\n        );\n      });\n  }\n\n  changeCss(css: string) {\n    this.setState({ css }, () => {\n      this.props.onChange(css);\n    });\n  }\n\n  changeCssTemplate(info: { key: Key }) {\n    const keyAsString = String(info.key);\n    this.changeCss(keyAsString);\n  }\n\n  renderTemplateSelector() {\n    if (this.state.templates) {\n      const menu = (\n        <Menu onClick={this.changeCssTemplate}>\n          {this.state.templates.map(template => (\n            <Menu.Item key={template.css}>{template.label}</Menu.Item>\n          ))}\n        </Menu>\n      );\n      return (\n        <Dropdown dropdownRender={() => menu} placement=\"bottomRight\">\n          <Button>{t('Load a CSS template')}</Button>\n        </Dropdown>\n      );\n    }\n    return null;\n  }\n\n  render() {\n    return (\n      <ModalTrigger\n        triggerNode={this.props.triggerNode}\n        modalTitle={t('CSS')}\n        modalBody={\n          <StyledWrapper>\n            <div className=\"css-editor-header\">\n              <h5>{t('Live CSS editor')}</h5>\n              {this.renderTemplateSelector()}\n            </div>\n            <AceCssEditor\n              className=\"css-editor\"\n              minLines={12}\n              maxLines={30}\n              onChange={this.changeCss}\n              height=\"200px\"\n              width=\"100%\"\n              editorProps={{ $blockScrolling: true }}\n              enableLiveAutocompletion\n              value={this.state.css || ''}\n            />\n          </StyledWrapper>\n        }\n      />\n    );\n  }\n}\n\nexport default CssEditor;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}