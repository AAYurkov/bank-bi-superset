{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();function _EMOTION_STRINGIFIED_CSS_ERROR__() {return \"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop).\";}var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { cloneElement, useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { css, ensureIsArray, GenericDataType, t, useTheme } from '@superset-ui/core';\nimport { useResizeDetector } from 'react-resize-detector';\nimport Loading from 'src/components/Loading';\nimport BooleanCell from 'src/components/Table/cell-renderers/BooleanCell';\nimport NullCell from 'src/components/Table/cell-renderers/NullCell';\nimport TimeCell from 'src/components/Table/cell-renderers/TimeCell';\nimport { EmptyState } from 'src/components/EmptyState';\nimport { getDatasourceSamples } from 'src/components/Chart/chartAction';\nimport Table, { TableSize } from 'src/components/Table';\nimport HeaderWithRadioGroup from 'src/components/Table/header-renderers/HeaderWithRadioGroup';\nimport { ResourceStatus } from 'src/hooks/apiResources/apiResources';\nimport { useDatasetMetadataBar } from 'src/features/datasets/metadataBar/useDatasetMetadataBar';\nimport TableControls from './DrillDetailTableControls';\nimport { getDrillPayload } from './utils';import { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nconst PAGE_SIZE = 50;\n// Must be outside of the main component due to problems in\n// react-resize-detector with conditional rendering\n// https://github.com/maslianok/react-resize-detector/issues/178\nvar _ref = process.env.NODE_ENV === \"production\" ? { name: \"82a6rk\", styles: \"flex:1\" } : { name: \"1715jyj-Resizable\", styles: \"flex:1;label:Resizable;/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9hcnl1cmtvdi9zdXBlcnNldC9zdXBlcnNldC1mcm9udGVuZC9zcmMvY29tcG9uZW50cy9DaGFydC9EcmlsbERldGFpbC9EcmlsbERldGFpbFBhbmUudHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQXdDMkIiLCJmaWxlIjoiL1VzZXJzL2FyeXVya292L3N1cGVyc2V0L3N1cGVyc2V0LWZyb250ZW5kL3NyYy9jb21wb25lbnRzL0NoYXJ0L0RyaWxsRGV0YWlsL0RyaWxsRGV0YWlsUGFuZS50c3giLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAoQVNGKSB1bmRlciBvbmVcbiAqIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZVxuICogZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRpb25cbiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGVcbiAqIHRvIHlvdSB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGVcbiAqIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZVxuICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLFxuICogc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW5cbiAqIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXG4gKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGVcbiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnNcbiAqIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQgeyBjbG9uZUVsZW1lbnQsIHVzZUNhbGxiYWNrLCB1c2VFZmZlY3QsIHVzZU1lbW8sIHVzZVJlZiwgdXNlU3RhdGUsIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgdXNlU2VsZWN0b3IgfSBmcm9tICdyZWFjdC1yZWR1eCc7XG5pbXBvcnQgeyBjc3MsIGVuc3VyZUlzQXJyYXksIEdlbmVyaWNEYXRhVHlwZSwgdCwgdXNlVGhlbWUsIH0gZnJvbSAnQHN1cGVyc2V0LXVpL2NvcmUnO1xuaW1wb3J0IHsgdXNlUmVzaXplRGV0ZWN0b3IgfSBmcm9tICdyZWFjdC1yZXNpemUtZGV0ZWN0b3InO1xuaW1wb3J0IExvYWRpbmcgZnJvbSAnc3JjL2NvbXBvbmVudHMvTG9hZGluZyc7XG5pbXBvcnQgQm9vbGVhbkNlbGwgZnJvbSAnc3JjL2NvbXBvbmVudHMvVGFibGUvY2VsbC1yZW5kZXJlcnMvQm9vbGVhbkNlbGwnO1xuaW1wb3J0IE51bGxDZWxsIGZyb20gJ3NyYy9jb21wb25lbnRzL1RhYmxlL2NlbGwtcmVuZGVyZXJzL051bGxDZWxsJztcbmltcG9ydCBUaW1lQ2VsbCBmcm9tICdzcmMvY29tcG9uZW50cy9UYWJsZS9jZWxsLXJlbmRlcmVycy9UaW1lQ2VsbCc7XG5pbXBvcnQgeyBFbXB0eVN0YXRlIH0gZnJvbSAnc3JjL2NvbXBvbmVudHMvRW1wdHlTdGF0ZSc7XG5pbXBvcnQgeyBnZXREYXRhc291cmNlU2FtcGxlcyB9IGZyb20gJ3NyYy9jb21wb25lbnRzL0NoYXJ0L2NoYXJ0QWN0aW9uJztcbmltcG9ydCBUYWJsZSwgeyBUYWJsZVNpemUgfSBmcm9tICdzcmMvY29tcG9uZW50cy9UYWJsZSc7XG5pbXBvcnQgSGVhZGVyV2l0aFJhZGlvR3JvdXAgZnJvbSAnc3JjL2NvbXBvbmVudHMvVGFibGUvaGVhZGVyLXJlbmRlcmVycy9IZWFkZXJXaXRoUmFkaW9Hcm91cCc7XG5pbXBvcnQgeyBSZXNvdXJjZVN0YXR1cyB9IGZyb20gJ3NyYy9ob29rcy9hcGlSZXNvdXJjZXMvYXBpUmVzb3VyY2VzJztcbmltcG9ydCB7IHVzZURhdGFzZXRNZXRhZGF0YUJhciB9IGZyb20gJ3NyYy9mZWF0dXJlcy9kYXRhc2V0cy9tZXRhZGF0YUJhci91c2VEYXRhc2V0TWV0YWRhdGFCYXInO1xuaW1wb3J0IFRhYmxlQ29udHJvbHMgZnJvbSAnLi9EcmlsbERldGFpbFRhYmxlQ29udHJvbHMnO1xuaW1wb3J0IHsgZ2V0RHJpbGxQYXlsb2FkIH0gZnJvbSAnLi91dGlscyc7XG5jb25zdCBQQUdFX1NJWkUgPSA1MDtcbi8vIE11c3QgYmUgb3V0c2lkZSBvZiB0aGUgbWFpbiBjb21wb25lbnQgZHVlIHRvIHByb2JsZW1zIGluXG4vLyByZWFjdC1yZXNpemUtZGV0ZWN0b3Igd2l0aCBjb25kaXRpb25hbCByZW5kZXJpbmdcbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9tYXNsaWFub2svcmVhY3QtcmVzaXplLWRldGVjdG9yL2lzc3Vlcy8xNzhcbmZ1bmN0aW9uIFJlc2l6YWJsZSh7IGNoaWxkcmVuIH0pIHtcbiAgICBjb25zdCB7IHJlZiwgaGVpZ2h0IH0gPSB1c2VSZXNpemVEZXRlY3RvcigpO1xuICAgIHJldHVybiAoPGRpdiByZWY9e3JlZn0gY3NzPXt7IGZsZXg6IDEgfX0+XG4gICAgICB7Y2xvbmVFbGVtZW50KGNoaWxkcmVuLCB7IGhlaWdodCB9KX1cbiAgICA8L2Rpdj4pO1xufVxudmFyIFRpbWVGb3JtYXR0aW5nO1xuKGZ1bmN0aW9uIChUaW1lRm9ybWF0dGluZykge1xuICAgIFRpbWVGb3JtYXR0aW5nW1RpbWVGb3JtYXR0aW5nW1wiT3JpZ2luYWxcIl0gPSAwXSA9IFwiT3JpZ2luYWxcIjtcbiAgICBUaW1lRm9ybWF0dGluZ1tUaW1lRm9ybWF0dGluZ1tcIkZvcm1hdHRlZFwiXSA9IDFdID0gXCJGb3JtYXR0ZWRcIjtcbn0pKFRpbWVGb3JtYXR0aW5nIHx8IChUaW1lRm9ybWF0dGluZyA9IHt9KSk7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBEcmlsbERldGFpbFBhbmUoeyBmb3JtRGF0YSwgaW5pdGlhbEZpbHRlcnMsIH0pIHtcbiAgICBjb25zdCB0aGVtZSA9IHVzZVRoZW1lKCk7XG4gICAgY29uc3QgW3BhZ2VJbmRleCwgc2V0UGFnZUluZGV4XSA9IHVzZVN0YXRlKDApO1xuICAgIGNvbnN0IGxhc3RQYWdlSW5kZXggPSB1c2VSZWYocGFnZUluZGV4KTtcbiAgICBjb25zdCBbZmlsdGVycywgc2V0RmlsdGVyc10gPSB1c2VTdGF0ZShpbml0aWFsRmlsdGVycyk7XG4gICAgY29uc3QgW2lzTG9hZGluZywgc2V0SXNMb2FkaW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgICBjb25zdCBbcmVzcG9uc2VFcnJvciwgc2V0UmVzcG9uc2VFcnJvcl0gPSB1c2VTdGF0ZSgnJyk7XG4gICAgY29uc3QgW3Jlc3VsdHNQYWdlcywgc2V0UmVzdWx0c1BhZ2VzXSA9IHVzZVN0YXRlKG5ldyBNYXAoKSk7XG4gICAgY29uc3QgW3RpbWVGb3JtYXR0aW5nLCBzZXRUaW1lRm9ybWF0dGluZ10gPSB1c2VTdGF0ZSh7fSk7XG4gICAgY29uc3QgU0FNUExFU19ST1dfTElNSVQgPSB1c2VTZWxlY3Rvcigoc3RhdGUpID0+IHN0YXRlLmNvbW1vbi5jb25mLlNBTVBMRVNfUk9XX0xJTUlUKTtcbiAgICAvLyBFeHRyYWN0IGRhdGFzb3VyY2UgSUQvdHlwZSBmcm9tIHN0cmluZyBJRFxuICAgIGNvbnN0IFtkYXRhc291cmNlSWQsIGRhdGFzb3VyY2VUeXBlXSA9IHVzZU1lbW8oKCkgPT4gZm9ybURhdGEuZGF0YXNvdXJjZS5zcGxpdCgnX18nKSwgW2Zvcm1EYXRhLmRhdGFzb3VyY2VdKTtcbiAgICBjb25zdCB7IG1ldGFkYXRhQmFyLCBzdGF0dXM6IG1ldGFkYXRhQmFyU3RhdHVzIH0gPSB1c2VEYXRhc2V0TWV0YWRhdGFCYXIoe1xuICAgICAgICBkYXRhc2V0SWQ6IGRhdGFzb3VyY2VJZCxcbiAgICB9KTtcbiAgICAvLyBHZXQgcGFnZSBvZiByZXN1bHRzXG4gICAgY29uc3QgcmVzdWx0c1BhZ2UgPSB1c2VNZW1vKCgpID0+IHtcbiAgICAgICAgY29uc3QgbmV4dFJlc3VsdHNQYWdlID0gcmVzdWx0c1BhZ2VzLmdldChwYWdlSW5kZXgpO1xuICAgICAgICBpZiAobmV4dFJlc3VsdHNQYWdlKSB7XG4gICAgICAgICAgICBsYXN0UGFnZUluZGV4LmN1cnJlbnQgPSBwYWdlSW5kZXg7XG4gICAgICAgICAgICByZXR1cm4gbmV4dFJlc3VsdHNQYWdlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHRzUGFnZXMuZ2V0KGxhc3RQYWdlSW5kZXguY3VycmVudCk7XG4gICAgfSwgW3BhZ2VJbmRleCwgcmVzdWx0c1BhZ2VzXSk7XG4gICAgY29uc3QgbWFwcGVkQ29sdW1ucyA9IHVzZU1lbW8oKCkgPT4gcmVzdWx0c1BhZ2U/LmNvbE5hbWVzLm1hcCgoY29sdW1uLCBpbmRleCkgPT4gKHtcbiAgICAgICAga2V5OiBjb2x1bW4sXG4gICAgICAgIGRhdGFJbmRleDogY29sdW1uLFxuICAgICAgICB0aXRsZTogcmVzdWx0c1BhZ2U/LmNvbFR5cGVzW2luZGV4XSA9PT0gR2VuZXJpY0RhdGFUeXBlLlRlbXBvcmFsID8gKDxIZWFkZXJXaXRoUmFkaW9Hcm91cCBoZWFkZXJUaXRsZT17Y29sdW1ufSBncm91cFRpdGxlPXt0KCdGb3JtYXR0aW5nJyl9IGdyb3VwT3B0aW9ucz17W1xuICAgICAgICAgICAgICAgIHsgbGFiZWw6IHQoJ09yaWdpbmFsIHZhbHVlJyksIHZhbHVlOiBUaW1lRm9ybWF0dGluZy5PcmlnaW5hbCB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6IHQoJ0Zvcm1hdHRlZCB2YWx1ZScpLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogVGltZUZvcm1hdHRpbmcuRm9ybWF0dGVkLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBdfSB2YWx1ZT17dGltZUZvcm1hdHRpbmdbY29sdW1uXSA9PT0gVGltZUZvcm1hdHRpbmcuT3JpZ2luYWxcbiAgICAgICAgICAgICAgICA/IFRpbWVGb3JtYXR0aW5nLk9yaWdpbmFsXG4gICAgICAgICAgICAgICAgOiBUaW1lRm9ybWF0dGluZy5Gb3JtYXR0ZWR9IG9uQ2hhbmdlPXt2YWx1ZSA9PiBzZXRUaW1lRm9ybWF0dGluZyhzdGF0ZSA9PiAoe1xuICAgICAgICAgICAgICAgIC4uLnN0YXRlLFxuICAgICAgICAgICAgICAgIFtjb2x1bW5dOiBwYXJzZUludCh2YWx1ZSwgMTApLFxuICAgICAgICAgICAgfSkpfS8+KSA6IChjb2x1bW4pLFxuICAgICAgICByZW5kZXI6IHZhbHVlID0+IHtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gdHJ1ZSB8fCB2YWx1ZSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gPEJvb2xlYW5DZWxsIHZhbHVlPXt2YWx1ZX0vPjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHJldHVybiA8TnVsbENlbGwgLz47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmVzdWx0c1BhZ2U/LmNvbFR5cGVzW2luZGV4XSA9PT0gR2VuZXJpY0RhdGFUeXBlLlRlbXBvcmFsICYmXG4gICAgICAgICAgICAgICAgdGltZUZvcm1hdHRpbmdbY29sdW1uXSAhPT0gVGltZUZvcm1hdHRpbmcuT3JpZ2luYWwgJiZcbiAgICAgICAgICAgICAgICAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJyB8fCB2YWx1ZSBpbnN0YW5jZW9mIERhdGUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDxUaW1lQ2VsbCB2YWx1ZT17dmFsdWV9Lz47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gU3RyaW5nKHZhbHVlKTtcbiAgICAgICAgfSxcbiAgICAgICAgd2lkdGg6IDE1MCxcbiAgICB9KSkgfHwgW10sIFtyZXN1bHRzUGFnZT8uY29sTmFtZXMsIHJlc3VsdHNQYWdlPy5jb2xUeXBlcywgdGltZUZvcm1hdHRpbmddKTtcbiAgICBjb25zdCBkYXRhID0gdXNlTWVtbygoKSA9PiByZXN1bHRzUGFnZT8uZGF0YS5tYXAoKHJvdywgaW5kZXgpID0+IHJlc3VsdHNQYWdlPy5jb2xOYW1lcy5yZWR1Y2UoKGFjYywgY3VycikgPT4gKHsgLi4uYWNjLCBbY3Vycl06IHJvd1tjdXJyXSB9KSwge1xuICAgICAgICBrZXk6IGluZGV4LFxuICAgIH0pKSB8fCBbXSwgW3Jlc3VsdHNQYWdlPy5jb2xOYW1lcywgcmVzdWx0c1BhZ2U/LmRhdGFdKTtcbiAgICAvLyBDbGVhciBjYWNoZSBvbiByZWxvYWQgYnV0dG9uIGNsaWNrXG4gICAgY29uc3QgaGFuZGxlUmVsb2FkID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgICAgICBzZXRSZXNwb25zZUVycm9yKCcnKTtcbiAgICAgICAgc2V0UmVzdWx0c1BhZ2VzKG5ldyBNYXAoKSk7XG4gICAgICAgIHNldFBhZ2VJbmRleCgwKTtcbiAgICB9LCBbXSk7XG4gICAgLy8gQ2xlYXIgY2FjaGUgYW5kIHJlc2V0IHBhZ2UgaW5kZXggaWYgZmlsdGVycyBjaGFuZ2VcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBzZXRSZXNwb25zZUVycm9yKCcnKTtcbiAgICAgICAgc2V0UmVzdWx0c1BhZ2VzKG5ldyBNYXAoKSk7XG4gICAgICAgIHNldFBhZ2VJbmRleCgwKTtcbiAgICB9LCBbZmlsdGVyc10pO1xuICAgIC8vIFVwZGF0ZSBjYWNoZSBvcmRlciBpZiBwYWdlIGluIGNhY2hlXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKHJlc3VsdHNQYWdlcy5oYXMocGFnZUluZGV4KSAmJlxuICAgICAgICAgICAgWy4uLnJlc3VsdHNQYWdlcy5rZXlzKCldLmF0KC0xKSAhPT0gcGFnZUluZGV4KSB7XG4gICAgICAgICAgICBjb25zdCBuZXh0UmVzdWx0c1BhZ2VzID0gbmV3IE1hcChyZXN1bHRzUGFnZXMpO1xuICAgICAgICAgICAgbmV4dFJlc3VsdHNQYWdlcy5kZWxldGUocGFnZUluZGV4KTtcbiAgICAgICAgICAgIHNldFJlc3VsdHNQYWdlcyhuZXh0UmVzdWx0c1BhZ2VzLnNldChwYWdlSW5kZXgsIHJlc3VsdHNQYWdlcy5nZXQocGFnZUluZGV4KSkpO1xuICAgICAgICB9XG4gICAgfSwgW3BhZ2VJbmRleCwgcmVzdWx0c1BhZ2VzXSk7XG4gICAgLy8gRG93bmxvYWQgcGFnZSBvZiByZXN1bHRzICYgdHJpbSBjYWNoZSBpZiBwYWdlIG5vdCBpbiBjYWNoZVxuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGlmICghcmVzcG9uc2VFcnJvciAmJiAhaXNMb2FkaW5nICYmICFyZXN1bHRzUGFnZXMuaGFzKHBhZ2VJbmRleCkpIHtcbiAgICAgICAgICAgIHNldElzTG9hZGluZyh0cnVlKTtcbiAgICAgICAgICAgIGNvbnN0IGpzb25QYXlsb2FkID0gZ2V0RHJpbGxQYXlsb2FkKGZvcm1EYXRhLCBmaWx0ZXJzKSA/PyB7fTtcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlUGFnZUxpbWl0ID0gTWF0aC5jZWlsKFNBTVBMRVNfUk9XX0xJTUlUIC8gUEFHRV9TSVpFKTtcbiAgICAgICAgICAgIGdldERhdGFzb3VyY2VTYW1wbGVzKGRhdGFzb3VyY2VUeXBlLCBkYXRhc291cmNlSWQsIGZhbHNlLCBqc29uUGF5bG9hZCwgUEFHRV9TSVpFLCBwYWdlSW5kZXggKyAxKVxuICAgICAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgICAgICBzZXRSZXN1bHRzUGFnZXMobmV3IE1hcChbXG4gICAgICAgICAgICAgICAgICAgIC4uLlsuLi5yZXN1bHRzUGFnZXMuZW50cmllcygpXS5zbGljZSgtY2FjaGVQYWdlTGltaXQgKyAxKSxcbiAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFnZUluZGV4LFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsOiByZXNwb25zZS50b3RhbF9jb3VudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiByZXNwb25zZS5kYXRhLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbE5hbWVzOiBlbnN1cmVJc0FycmF5KHJlc3BvbnNlLmNvbG5hbWVzKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xUeXBlczogZW5zdXJlSXNBcnJheShyZXNwb25zZS5jb2x0eXBlcyksXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIF0pKTtcbiAgICAgICAgICAgICAgICBzZXRSZXNwb25zZUVycm9yKCcnKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgICAgICAgICBzZXRSZXNwb25zZUVycm9yKGAke2Vycm9yLm5hbWV9OiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgICAgICAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LCBbXG4gICAgICAgIFNBTVBMRVNfUk9XX0xJTUlULFxuICAgICAgICBkYXRhc291cmNlSWQsXG4gICAgICAgIGRhdGFzb3VyY2VUeXBlLFxuICAgICAgICBmaWx0ZXJzLFxuICAgICAgICBmb3JtRGF0YSxcbiAgICAgICAgaXNMb2FkaW5nLFxuICAgICAgICBwYWdlSW5kZXgsXG4gICAgICAgIHJlc3BvbnNlRXJyb3IsXG4gICAgICAgIHJlc3VsdHNQYWdlcyxcbiAgICBdKTtcbiAgICBjb25zdCBib290c3RyYXBwaW5nID0gKCFyZXNwb25zZUVycm9yICYmICFyZXN1bHRzUGFnZXMuc2l6ZSkgfHxcbiAgICAgICAgbWV0YWRhdGFCYXJTdGF0dXMgPT09IFJlc291cmNlU3RhdHVzLkxvYWRpbmc7XG4gICAgY29uc3QgYWxsb3dIVE1MID0gZm9ybURhdGEuYWxsb3dfcmVuZGVyX2h0bWwgPz8gdHJ1ZTtcbiAgICBsZXQgdGFibGVDb250ZW50ID0gbnVsbDtcbiAgICBpZiAocmVzcG9uc2VFcnJvcikge1xuICAgICAgICAvLyBSZW5kZXIgZXJyb3IgaWYgcGFnZSBkb3dubG9hZCBmYWlsZWRcbiAgICAgICAgdGFibGVDb250ZW50ID0gKDxwcmUgY3NzPXtjc3MgYFxuICAgICAgICAgIG1hcmdpbi10b3A6ICR7dGhlbWUuZ3JpZFVuaXQgKiA0fXB4O1xuICAgICAgICBgfT5cbiAgICAgICAge3Jlc3BvbnNlRXJyb3J9XG4gICAgICA8L3ByZT4pO1xuICAgIH1cbiAgICBlbHNlIGlmIChib290c3RyYXBwaW5nKSB7XG4gICAgICAgIC8vIFJlbmRlciBsb2FkaW5nIGlmIGZpcnN0IHBhZ2UgaGFzbid0IGxvYWRlZFxuICAgICAgICB0YWJsZUNvbnRlbnQgPSA8TG9hZGluZyAvPjtcbiAgICB9XG4gICAgZWxzZSBpZiAocmVzdWx0c1BhZ2U/LnRvdGFsID09PSAwKSB7XG4gICAgICAgIC8vIFJlbmRlciBlbXB0eSBzdGF0ZSBpZiBubyByZXN1bHRzIGFyZSByZXR1cm5lZCBmb3IgcGFnZVxuICAgICAgICBjb25zdCB0aXRsZSA9IHQoJ05vIHJvd3Mgd2VyZSByZXR1cm5lZCBmb3IgdGhpcyBkYXRhc2V0Jyk7XG4gICAgICAgIHRhYmxlQ29udGVudCA9IDxFbXB0eVN0YXRlIGltYWdlPVwiZG9jdW1lbnQuc3ZnXCIgdGl0bGU9e3RpdGxlfS8+O1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgLy8gUmVuZGVyIHRhYmxlIGlmIGF0IGxlYXN0IG9uZSBwYWdlIGhhcyBzdWNjZXNzZnVsbHkgbG9hZGVkXG4gICAgICAgIHRhYmxlQ29udGVudCA9ICg8UmVzaXphYmxlPlxuICAgICAgICA8VGFibGUgZGF0YT17ZGF0YX0gY29sdW1ucz17bWFwcGVkQ29sdW1uc30gc2l6ZT17VGFibGVTaXplLlNtYWxsfSBkZWZhdWx0UGFnZVNpemU9e1BBR0VfU0laRX0gcmVjb3JkQ291bnQ9e3Jlc3VsdHNQYWdlPy50b3RhbH0gdXNlUGFnaW5hdGlvbiBsb2FkaW5nPXtpc0xvYWRpbmd9IG9uQ2hhbmdlPXtwYWdpbmF0aW9uID0+IHNldFBhZ2VJbmRleChwYWdpbmF0aW9uLmN1cnJlbnQgPyBwYWdpbmF0aW9uLmN1cnJlbnQgLSAxIDogMCl9IHJlc2l6YWJsZSB2aXJ0dWFsaXplIGFsbG93SFRNTD17YWxsb3dIVE1MfS8+XG4gICAgICA8L1Jlc2l6YWJsZT4pO1xuICAgIH1cbiAgICByZXR1cm4gKDw+XG4gICAgICB7IWJvb3RzdHJhcHBpbmcgJiYgbWV0YWRhdGFCYXJ9XG4gICAgICB7IWJvb3RzdHJhcHBpbmcgJiYgKDxUYWJsZUNvbnRyb2xzIGZpbHRlcnM9e2ZpbHRlcnN9IHNldEZpbHRlcnM9e3NldEZpbHRlcnN9IHRvdGFsQ291bnQ9e3Jlc3VsdHNQYWdlPy50b3RhbH0gbG9hZGluZz17aXNMb2FkaW5nfSBvblJlbG9hZD17aGFuZGxlUmVsb2FkfS8+KX1cbiAgICAgIHt0YWJsZUNvbnRlbnR9XG4gICAgPC8+KTtcbn1cbiJdfQ== */\", toString: _EMOTION_STRINGIFIED_CSS_ERROR__ };function Resizable({ children }) {\n  const { ref, height } = useResizeDetector();\n  return _jsx(\"div\", { ref: ref, css: _ref, children: /*#__PURE__*/\n    cloneElement(children, { height }) }\n  );\n}__signature__(Resizable, \"useResizeDetector{{ ref, height }}\", () => [useResizeDetector]);\nvar TimeFormatting;\n(function (TimeFormatting) {\n  TimeFormatting[TimeFormatting[\"Original\"] = 0] = \"Original\";\n  TimeFormatting[TimeFormatting[\"Formatted\"] = 1] = \"Formatted\";\n})(TimeFormatting || (TimeFormatting = {}));\nexport default function DrillDetailPane({ formData, initialFilters }) {var _formData$allow_rende;\n  const theme = useTheme();\n  const [pageIndex, setPageIndex] = useState(0);\n  const lastPageIndex = useRef(pageIndex);\n  const [filters, setFilters] = useState(initialFilters);\n  const [isLoading, setIsLoading] = useState(false);\n  const [responseError, setResponseError] = useState('');\n  const [resultsPages, setResultsPages] = useState(new Map());\n  const [timeFormatting, setTimeFormatting] = useState({});\n  const SAMPLES_ROW_LIMIT = useSelector((state) => state.common.conf.SAMPLES_ROW_LIMIT);\n  // Extract datasource ID/type from string ID\n  const [datasourceId, datasourceType] = useMemo(() => formData.datasource.split('__'), [formData.datasource]);\n  const { metadataBar, status: metadataBarStatus } = useDatasetMetadataBar({\n    datasetId: datasourceId\n  });\n  // Get page of results\n  const resultsPage = useMemo(() => {\n    const nextResultsPage = resultsPages.get(pageIndex);\n    if (nextResultsPage) {\n      lastPageIndex.current = pageIndex;\n      return nextResultsPage;\n    }\n    return resultsPages.get(lastPageIndex.current);\n  }, [pageIndex, resultsPages]);\n  const mappedColumns = useMemo(() => (resultsPage == null ? void 0 : resultsPage.colNames.map((column, index) => ({\n    key: column,\n    dataIndex: column,\n    title: (resultsPage == null ? void 0 : resultsPage.colTypes[index]) === GenericDataType.Temporal ? _jsx(HeaderWithRadioGroup, { headerTitle: column, groupTitle: t('Formatting'), groupOptions: [\n      { label: t('Original value'), value: TimeFormatting.Original },\n      {\n        label: t('Formatted value'),\n        value: TimeFormatting.Formatted\n      }],\n      value: timeFormatting[column] === TimeFormatting.Original ?\n      TimeFormatting.Original :\n      TimeFormatting.Formatted, onChange: (value) => setTimeFormatting((state) => ({\n        ...state,\n        [column]: parseInt(value, 10)\n      })) }) : column,\n    render: (value) => {\n      if (value === true || value === false) {\n        return _jsx(BooleanCell, { value: value });\n      }\n      if (value === null) {\n        return _jsx(NullCell, {});\n      }\n      if ((resultsPage == null ? void 0 : resultsPage.colTypes[index]) === GenericDataType.Temporal &&\n      timeFormatting[column] !== TimeFormatting.Original && (\n      typeof value === 'number' || value instanceof Date)) {\n        return _jsx(TimeCell, { value: value });\n      }\n      return String(value);\n    },\n    width: 150\n  }))) || [], [resultsPage == null ? void 0 : resultsPage.colNames, resultsPage == null ? void 0 : resultsPage.colTypes, timeFormatting]);\n  const data = useMemo(() => (resultsPage == null ? void 0 : resultsPage.data.map((row, index) => resultsPage == null ? void 0 : resultsPage.colNames.reduce((acc, curr) => ({ ...acc, [curr]: row[curr] }), {\n    key: index\n  }))) || [], [resultsPage == null ? void 0 : resultsPage.colNames, resultsPage == null ? void 0 : resultsPage.data]);\n  // Clear cache on reload button click\n  const handleReload = useCallback(() => {\n    setResponseError('');\n    setResultsPages(new Map());\n    setPageIndex(0);\n  }, []);\n  // Clear cache and reset page index if filters change\n  useEffect(() => {\n    setResponseError('');\n    setResultsPages(new Map());\n    setPageIndex(0);\n  }, [filters]);\n  // Update cache order if page in cache\n  useEffect(() => {\n    if (resultsPages.has(pageIndex) &&\n    [...resultsPages.keys()].at(-1) !== pageIndex) {\n      const nextResultsPages = new Map(resultsPages);\n      nextResultsPages.delete(pageIndex);\n      setResultsPages(nextResultsPages.set(pageIndex, resultsPages.get(pageIndex)));\n    }\n  }, [pageIndex, resultsPages]);\n  // Download page of results & trim cache if page not in cache\n  useEffect(() => {\n    if (!responseError && !isLoading && !resultsPages.has(pageIndex)) {var _getDrillPayload;\n      setIsLoading(true);\n      const jsonPayload = (_getDrillPayload = getDrillPayload(formData, filters)) != null ? _getDrillPayload : {};\n      const cachePageLimit = Math.ceil(SAMPLES_ROW_LIMIT / PAGE_SIZE);\n      getDatasourceSamples(datasourceType, datasourceId, false, jsonPayload, PAGE_SIZE, pageIndex + 1).\n      then((response) => {\n        setResultsPages(new Map([\n        ...[...resultsPages.entries()].slice(-cachePageLimit + 1),\n        [\n        pageIndex,\n        {\n          total: response.total_count,\n          data: response.data,\n          colNames: ensureIsArray(response.colnames),\n          colTypes: ensureIsArray(response.coltypes)\n        }]]\n\n        ));\n        setResponseError('');\n      }).\n      catch((error) => {\n        setResponseError(`${error.name}: ${error.message}`);\n      }).\n      finally(() => {\n        setIsLoading(false);\n      });\n    }\n  }, [\n  SAMPLES_ROW_LIMIT,\n  datasourceId,\n  datasourceType,\n  filters,\n  formData,\n  isLoading,\n  pageIndex,\n  responseError,\n  resultsPages]\n  );\n  const bootstrapping = !responseError && !resultsPages.size ||\n  metadataBarStatus === ResourceStatus.Loading;\n  const allowHTML = (_formData$allow_rende = formData.allow_render_html) != null ? _formData$allow_rende : true;\n  let tableContent = null;\n  if (responseError) {\n    // Render error if page download failed\n    tableContent = _jsx(\"pre\", { css: css`\n          margin-top: ${theme.gridUnit * 4}px;\n        `, children:\n      responseError }\n    );\n  } else\n  if (bootstrapping) {\n    // Render loading if first page hasn't loaded\n    tableContent = _jsx(Loading, {});\n  } else\n  if ((resultsPage == null ? void 0 : resultsPage.total) === 0) {\n    // Render empty state if no results are returned for page\n    const title = t('No rows were returned for this dataset');\n    tableContent = _jsx(EmptyState, { image: \"document.svg\", title: title });\n  } else\n  {\n    // Render table if at least one page has successfully loaded\n    tableContent = _jsx(Resizable, { children:\n      _jsx(Table, { data: data, columns: mappedColumns, size: TableSize.Small, defaultPageSize: PAGE_SIZE, recordCount: resultsPage == null ? void 0 : resultsPage.total, usePagination: true, loading: isLoading, onChange: (pagination) => setPageIndex(pagination.current ? pagination.current - 1 : 0), resizable: true, virtualize: true, allowHTML: allowHTML }) }\n    );\n  }\n  return _jsxs(_Fragment, { children: [\n    !bootstrapping && metadataBar,\n    !bootstrapping && _jsx(TableControls, { filters: filters, setFilters: setFilters, totalCount: resultsPage == null ? void 0 : resultsPage.total, loading: isLoading, onReload: handleReload }),\n    tableContent] }\n  );\n}__signature__(DrillDetailPane, \"useTheme{theme}\\nuseState{[pageIndex, setPageIndex](0)}\\nuseRef{lastPageIndex}\\nuseState{[filters, setFilters](initialFilters)}\\nuseState{[isLoading, setIsLoading](false)}\\nuseState{[responseError, setResponseError]('')}\\nuseState{[resultsPages, setResultsPages](new Map())}\\nuseState{[timeFormatting, setTimeFormatting]({})}\\nuseSelector{SAMPLES_ROW_LIMIT}\\nuseMemo{[datasourceId, datasourceType]}\\nuseDatasetMetadataBar{{ metadataBar, status: metadataBarStatus }}\\nuseMemo{resultsPage}\\nuseMemo{mappedColumns}\\nuseMemo{data}\\nuseCallback{handleReload}\\nuseEffect{}\\nuseEffect{}\\nuseEffect{}\", () => [useTheme, useSelector, useDatasetMetadataBar]);;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(PAGE_SIZE, \"PAGE_SIZE\", \"/Users/aryurkov/superset/superset-frontend/src/components/Chart/DrillDetail/DrillDetailPane.tsx\");reactHotLoader.register(Resizable, \"Resizable\", \"/Users/aryurkov/superset/superset-frontend/src/components/Chart/DrillDetail/DrillDetailPane.tsx\");reactHotLoader.register(TimeFormatting, \"TimeFormatting\", \"/Users/aryurkov/superset/superset-frontend/src/components/Chart/DrillDetail/DrillDetailPane.tsx\");reactHotLoader.register(DrillDetailPane, \"DrillDetailPane\", \"/Users/aryurkov/superset/superset-frontend/src/components/Chart/DrillDetail/DrillDetailPane.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["cloneElement","useCallback","useEffect","useMemo","useRef","useState","useSelector","css","ensureIsArray","GenericDataType","t","useTheme","useResizeDetector","Loading","BooleanCell","NullCell","TimeCell","EmptyState","getDatasourceSamples","Table","TableSize","HeaderWithRadioGroup","ResourceStatus","useDatasetMetadataBar","TableControls","getDrillPayload","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","PAGE_SIZE","_ref","process","env","NODE_ENV","name","styles","toString","_EMOTION_STRINGIFIED_CSS_ERROR__","Resizable","children","ref","height","__signature__","TimeFormatting","DrillDetailPane","formData","initialFilters","_formData$allow_rende","theme","pageIndex","setPageIndex","lastPageIndex","filters","setFilters","isLoading","setIsLoading","responseError","setResponseError","resultsPages","setResultsPages","Map","timeFormatting","setTimeFormatting","SAMPLES_ROW_LIMIT","state","common","conf","datasourceId","datasourceType","datasource","split","metadataBar","status","metadataBarStatus","datasetId","resultsPage","nextResultsPage","get","current","mappedColumns","colNames","map","column","index","key","dataIndex","title","colTypes","Temporal","headerTitle","groupTitle","groupOptions","label","value","Original","Formatted","onChange","parseInt","render","Date","String","width","data","row","reduce","acc","curr","handleReload","has","keys","at","nextResultsPages","delete","set","_getDrillPayload","jsonPayload","cachePageLimit","Math","ceil","then","response","entries","slice","total","total_count","colnames","coltypes","catch","error","message","finally","bootstrapping","size","allowHTML","allow_render_html","tableContent","gridUnit","image","columns","Small","defaultPageSize","recordCount","usePagination","loading","pagination","resizable","virtualize","totalCount","onReload","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/Users/aryurkov/superset/superset-frontend/src/components/Chart/DrillDetail/DrillDetailPane.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  cloneElement,\n  ReactElement,\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport { useSelector } from 'react-redux';\nimport {\n  BinaryQueryObjectFilterClause,\n  css,\n  ensureIsArray,\n  GenericDataType,\n  JsonObject,\n  QueryFormData,\n  t,\n  useTheme,\n} from '@superset-ui/core';\nimport { useResizeDetector } from 'react-resize-detector';\nimport Loading from 'src/components/Loading';\nimport BooleanCell from 'src/components/Table/cell-renderers/BooleanCell';\nimport NullCell from 'src/components/Table/cell-renderers/NullCell';\nimport TimeCell from 'src/components/Table/cell-renderers/TimeCell';\nimport { EmptyState } from 'src/components/EmptyState';\nimport { getDatasourceSamples } from 'src/components/Chart/chartAction';\nimport Table, { ColumnsType, TableSize } from 'src/components/Table';\nimport HeaderWithRadioGroup from 'src/components/Table/header-renderers/HeaderWithRadioGroup';\nimport { ResourceStatus } from 'src/hooks/apiResources/apiResources';\nimport { useDatasetMetadataBar } from 'src/features/datasets/metadataBar/useDatasetMetadataBar';\nimport TableControls from './DrillDetailTableControls';\nimport { getDrillPayload } from './utils';\nimport { ResultsPage } from './types';\n\nconst PAGE_SIZE = 50;\n\ninterface DataType {\n  [key: string]: any;\n}\n\n// Must be outside of the main component due to problems in\n// react-resize-detector with conditional rendering\n// https://github.com/maslianok/react-resize-detector/issues/178\nfunction Resizable({ children }: { children: ReactElement }) {\n  const { ref, height } = useResizeDetector();\n  return (\n    <div ref={ref} css={{ flex: 1 }}>\n      {cloneElement(children, { height })}\n    </div>\n  );\n}\n\nenum TimeFormatting {\n  Original,\n  Formatted,\n}\n\nexport default function DrillDetailPane({\n  formData,\n  initialFilters,\n}: {\n  formData: QueryFormData;\n  initialFilters: BinaryQueryObjectFilterClause[];\n}) {\n  const theme = useTheme();\n  const [pageIndex, setPageIndex] = useState(0);\n  const lastPageIndex = useRef(pageIndex);\n  const [filters, setFilters] = useState(initialFilters);\n  const [isLoading, setIsLoading] = useState(false);\n  const [responseError, setResponseError] = useState('');\n  const [resultsPages, setResultsPages] = useState<Map<number, ResultsPage>>(\n    new Map(),\n  );\n  const [timeFormatting, setTimeFormatting] = useState<\n    Record<string, TimeFormatting>\n  >({});\n\n  const SAMPLES_ROW_LIMIT = useSelector(\n    (state: { common: { conf: JsonObject } }) =>\n      state.common.conf.SAMPLES_ROW_LIMIT,\n  );\n\n  // Extract datasource ID/type from string ID\n  const [datasourceId, datasourceType] = useMemo(\n    () => formData.datasource.split('__'),\n    [formData.datasource],\n  );\n\n  const { metadataBar, status: metadataBarStatus } = useDatasetMetadataBar({\n    datasetId: datasourceId,\n  });\n  // Get page of results\n  const resultsPage = useMemo(() => {\n    const nextResultsPage = resultsPages.get(pageIndex);\n    if (nextResultsPage) {\n      lastPageIndex.current = pageIndex;\n      return nextResultsPage;\n    }\n\n    return resultsPages.get(lastPageIndex.current);\n  }, [pageIndex, resultsPages]);\n\n  const mappedColumns: ColumnsType<DataType> = useMemo(\n    () =>\n      resultsPage?.colNames.map((column, index) => ({\n        key: column,\n        dataIndex: column,\n        title:\n          resultsPage?.colTypes[index] === GenericDataType.Temporal ? (\n            <HeaderWithRadioGroup\n              headerTitle={column}\n              groupTitle={t('Formatting')}\n              groupOptions={[\n                { label: t('Original value'), value: TimeFormatting.Original },\n                {\n                  label: t('Formatted value'),\n                  value: TimeFormatting.Formatted,\n                },\n              ]}\n              value={\n                timeFormatting[column] === TimeFormatting.Original\n                  ? TimeFormatting.Original\n                  : TimeFormatting.Formatted\n              }\n              onChange={value =>\n                setTimeFormatting(state => ({\n                  ...state,\n                  [column]: parseInt(value, 10) as TimeFormatting,\n                }))\n              }\n            />\n          ) : (\n            column\n          ),\n        render: value => {\n          if (value === true || value === false) {\n            return <BooleanCell value={value} />;\n          }\n          if (value === null) {\n            return <NullCell />;\n          }\n          if (\n            resultsPage?.colTypes[index] === GenericDataType.Temporal &&\n            timeFormatting[column] !== TimeFormatting.Original &&\n            (typeof value === 'number' || value instanceof Date)\n          ) {\n            return <TimeCell value={value} />;\n          }\n          return String(value);\n        },\n        width: 150,\n      })) || [],\n    [resultsPage?.colNames, resultsPage?.colTypes, timeFormatting],\n  );\n\n  const data: DataType[] = useMemo(\n    () =>\n      resultsPage?.data.map((row, index) =>\n        resultsPage?.colNames.reduce(\n          (acc, curr) => ({ ...acc, [curr]: row[curr] }),\n          {\n            key: index,\n          },\n        ),\n      ) || [],\n    [resultsPage?.colNames, resultsPage?.data],\n  );\n\n  // Clear cache on reload button click\n  const handleReload = useCallback(() => {\n    setResponseError('');\n    setResultsPages(new Map());\n    setPageIndex(0);\n  }, []);\n\n  // Clear cache and reset page index if filters change\n  useEffect(() => {\n    setResponseError('');\n    setResultsPages(new Map());\n    setPageIndex(0);\n  }, [filters]);\n\n  // Update cache order if page in cache\n  useEffect(() => {\n    if (\n      resultsPages.has(pageIndex) &&\n      [...resultsPages.keys()].at(-1) !== pageIndex\n    ) {\n      const nextResultsPages = new Map(resultsPages);\n      nextResultsPages.delete(pageIndex);\n      setResultsPages(\n        nextResultsPages.set(\n          pageIndex,\n          resultsPages.get(pageIndex) as ResultsPage,\n        ),\n      );\n    }\n  }, [pageIndex, resultsPages]);\n\n  // Download page of results & trim cache if page not in cache\n  useEffect(() => {\n    if (!responseError && !isLoading && !resultsPages.has(pageIndex)) {\n      setIsLoading(true);\n      const jsonPayload = getDrillPayload(formData, filters) ?? {};\n      const cachePageLimit = Math.ceil(SAMPLES_ROW_LIMIT / PAGE_SIZE);\n      getDatasourceSamples(\n        datasourceType,\n        datasourceId,\n        false,\n        jsonPayload,\n        PAGE_SIZE,\n        pageIndex + 1,\n      )\n        .then(response => {\n          setResultsPages(\n            new Map([\n              ...[...resultsPages.entries()].slice(-cachePageLimit + 1),\n              [\n                pageIndex,\n                {\n                  total: response.total_count,\n                  data: response.data,\n                  colNames: ensureIsArray(response.colnames),\n                  colTypes: ensureIsArray(response.coltypes),\n                },\n              ],\n            ]),\n          );\n          setResponseError('');\n        })\n        .catch(error => {\n          setResponseError(`${error.name}: ${error.message}`);\n        })\n        .finally(() => {\n          setIsLoading(false);\n        });\n    }\n  }, [\n    SAMPLES_ROW_LIMIT,\n    datasourceId,\n    datasourceType,\n    filters,\n    formData,\n    isLoading,\n    pageIndex,\n    responseError,\n    resultsPages,\n  ]);\n\n  const bootstrapping =\n    (!responseError && !resultsPages.size) ||\n    metadataBarStatus === ResourceStatus.Loading;\n\n  const allowHTML = formData.allow_render_html ?? true;\n\n  let tableContent = null;\n  if (responseError) {\n    // Render error if page download failed\n    tableContent = (\n      <pre\n        css={css`\n          margin-top: ${theme.gridUnit * 4}px;\n        `}\n      >\n        {responseError}\n      </pre>\n    );\n  } else if (bootstrapping) {\n    // Render loading if first page hasn't loaded\n    tableContent = <Loading />;\n  } else if (resultsPage?.total === 0) {\n    // Render empty state if no results are returned for page\n    const title = t('No rows were returned for this dataset');\n    tableContent = <EmptyState image=\"document.svg\" title={title} />;\n  } else {\n    // Render table if at least one page has successfully loaded\n    tableContent = (\n      <Resizable>\n        <Table\n          data={data}\n          columns={mappedColumns}\n          size={TableSize.Small}\n          defaultPageSize={PAGE_SIZE}\n          recordCount={resultsPage?.total}\n          usePagination\n          loading={isLoading}\n          onChange={pagination =>\n            setPageIndex(pagination.current ? pagination.current - 1 : 0)\n          }\n          resizable\n          virtualize\n          allowHTML={allowHTML}\n        />\n      </Resizable>\n    );\n  }\n\n  return (\n    <>\n      {!bootstrapping && metadataBar}\n      {!bootstrapping && (\n        <TableControls\n          filters={filters}\n          setFilters={setFilters}\n          totalCount={resultsPage?.total}\n          loading={isLoading}\n          onReload={handleReload}\n        />\n      )}\n      {tableContent}\n    </>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}