{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { css, t, useTheme } from '@superset-ui/core';\nimport { usePluginContext } from 'src/components/DynamicPlugins';\nimport { Tooltip } from 'src/components/Tooltip';import { jsx as _jsx, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nexport const VizTile = ({ isActive, isRendered, vizMeta, onTileClick }) => {var _mountedPluginMetadat;\n  const { mountedPluginMetadata } = usePluginContext();\n  const chartNameRef = useRef(null);\n  const theme = useTheme();\n  const TILE_TRANSITION_TIME = theme.transitionTiming * 2;\n  const [tooltipVisible, setTooltipVisible] = useState(false);\n  const [isTransitioning, setIsTransitioning] = useState(false);\n  const [showTooltip, setShowTooltip] = useState(false);\n  const chartName = vizMeta.name ?\n  ((_mountedPluginMetadat = mountedPluginMetadata[vizMeta.name]) == null ? void 0 : _mountedPluginMetadat.name) || `${vizMeta.name}` :\n  t('Select Viz Type');\n  const handleTileClick = useCallback(() => {\n    onTileClick(vizMeta.name);\n    setIsTransitioning(true);\n    setTooltipVisible(false);\n    setTimeout(() => {\n      setIsTransitioning(false);\n    }, TILE_TRANSITION_TIME * 1000);\n  }, [onTileClick, TILE_TRANSITION_TIME, vizMeta.name]);\n  // Antd tooltip seems to be bugged - when elements move, the tooltip sometimes\n  // stays visible even when user doesn't hover over the element.\n  // Here we manually prevent it from displaying after user triggers transition\n  useEffect(() => {\n    setShowTooltip(Boolean(!isTransitioning && (\n    !isActive ||\n    chartNameRef.current &&\n    chartNameRef.current.scrollWidth >\n    chartNameRef.current.clientWidth)));\n  }, [isActive, isTransitioning]);\n  const containerProps = useMemo(() => !isActive ?\n  { role: 'button', tabIndex: 0, onClick: handleTileClick } :\n  {}, [handleTileClick, isActive]);\n  let tooltipTitle = null;\n  if (showTooltip) {\n    tooltipTitle = isRendered ?\n    t('Currently rendered: %s', chartName) :\n    chartName;\n  }\n  return _jsx(Tooltip, { title: tooltipTitle, onOpenChange: (visible) => setTooltipVisible(visible), open: tooltipVisible && !isTransitioning, placement: \"top\", mouseEnterDelay: 0.4, children:\n    _jsxs(\"div\", { ...containerProps, css: css`\n          display: flex;\n          align-items: center;\n          color: ${theme.colors.grayscale.base};\n          font-weight: ${theme.typography.weights.bold};\n          border-radius: 6px;\n          white-space: nowrap;\n          overflow: hidden;\n          max-width: fit-content;\n          ${!isActive &&\n      css`\n            flex-shrink: 0;\n            width: ${theme.gridUnit * 6}px;\n            background-color: transparent;\n            transition: none;\n            &:hover svg path {\n              fill: ${theme.colors.primary.base};\n              transition: fill ${theme.transitionTiming}s ease-out;\n            }\n          `}\n\n          ${isActive &&\n      css`\n            width: 100%;\n            background-color: ${theme.colors.grayscale.light4};\n            transition:\n              width ${TILE_TRANSITION_TIME}s ease-out,\n              background-color ${TILE_TRANSITION_TIME}s ease-out;\n            cursor: default;\n            svg path {\n              fill: ${theme.colors.primary.base};\n            }\n          `}\n        `, children: [\n      _jsx(\"span\", { css: css`\n            padding: 0px ${theme.gridUnit}px;\n          `, children:\n        vizMeta.icon }\n      ),\n      _jsx(\"span\", { css: css`\n            overflow: hidden;\n            text-overflow: ellipsis;\n            min-width: 0;\n            padding-right: ${theme.gridUnit}px;\n          `, ref: chartNameRef, children:\n        chartName }\n      )] }\n    ) }\n  );\n};__signature__(VizTile, \"usePluginContext{{ mountedPluginMetadata }}\\nuseRef{chartNameRef}\\nuseTheme{theme}\\nuseState{[tooltipVisible, setTooltipVisible](false)}\\nuseState{[isTransitioning, setIsTransitioning](false)}\\nuseState{[showTooltip, setShowTooltip](false)}\\nuseCallback{handleTileClick}\\nuseEffect{}\\nuseMemo{containerProps}\", () => [usePluginContext, useTheme]);;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(VizTile, \"VizTile\", \"/Users/aryurkov/superset/superset-frontend/src/explore/components/controls/VizTypeControl/VizTile.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["useCallback","useEffect","useMemo","useRef","useState","css","t","useTheme","usePluginContext","Tooltip","jsx","_jsx","jsxs","_jsxs","VizTile","isActive","isRendered","vizMeta","onTileClick","_mountedPluginMetadat","mountedPluginMetadata","chartNameRef","theme","TILE_TRANSITION_TIME","transitionTiming","tooltipVisible","setTooltipVisible","isTransitioning","setIsTransitioning","showTooltip","setShowTooltip","chartName","name","handleTileClick","setTimeout","Boolean","current","scrollWidth","clientWidth","containerProps","role","tabIndex","onClick","tooltipTitle","title","onOpenChange","visible","open","placement","mouseEnterDelay","children","colors","grayscale","base","typography","weights","bold","gridUnit","primary","light4","icon","ref","__signature__","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/Users/aryurkov/superset/superset-frontend/src/explore/components/controls/VizTypeControl/VizTile.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { css, t, useTheme } from '@superset-ui/core';\nimport { usePluginContext } from 'src/components/DynamicPlugins';\nimport { Tooltip } from 'src/components/Tooltip';\nimport { VizTileProps } from './types';\n\nexport const VizTile = ({\n  isActive,\n  isRendered,\n  vizMeta,\n  onTileClick,\n}: VizTileProps) => {\n  const { mountedPluginMetadata } = usePluginContext();\n  const chartNameRef = useRef<HTMLSpanElement>(null);\n  const theme = useTheme();\n  const TILE_TRANSITION_TIME = theme.transitionTiming * 2;\n  const [tooltipVisible, setTooltipVisible] = useState(false);\n  const [isTransitioning, setIsTransitioning] = useState(false);\n  const [showTooltip, setShowTooltip] = useState(false);\n  const chartName = vizMeta.name\n    ? mountedPluginMetadata[vizMeta.name]?.name || `${vizMeta.name}`\n    : t('Select Viz Type');\n\n  const handleTileClick = useCallback(() => {\n    onTileClick(vizMeta.name);\n    setIsTransitioning(true);\n    setTooltipVisible(false);\n    setTimeout(() => {\n      setIsTransitioning(false);\n    }, TILE_TRANSITION_TIME * 1000);\n  }, [onTileClick, TILE_TRANSITION_TIME, vizMeta.name]);\n\n  // Antd tooltip seems to be bugged - when elements move, the tooltip sometimes\n  // stays visible even when user doesn't hover over the element.\n  // Here we manually prevent it from displaying after user triggers transition\n  useEffect(() => {\n    setShowTooltip(\n      Boolean(\n        !isTransitioning &&\n          (!isActive ||\n            (chartNameRef.current &&\n              chartNameRef.current.scrollWidth >\n                chartNameRef.current.clientWidth)),\n      ),\n    );\n  }, [isActive, isTransitioning]);\n\n  const containerProps = useMemo(\n    () =>\n      !isActive\n        ? { role: 'button', tabIndex: 0, onClick: handleTileClick }\n        : {},\n    [handleTileClick, isActive],\n  );\n\n  let tooltipTitle: string | null = null;\n  if (showTooltip) {\n    tooltipTitle = isRendered\n      ? t('Currently rendered: %s', chartName)\n      : chartName;\n  }\n  return (\n    <Tooltip\n      title={tooltipTitle}\n      onOpenChange={visible => setTooltipVisible(visible)}\n      open={tooltipVisible && !isTransitioning}\n      placement=\"top\"\n      mouseEnterDelay={0.4}\n    >\n      <div\n        {...containerProps}\n        css={css`\n          display: flex;\n          align-items: center;\n          color: ${theme.colors.grayscale.base};\n          font-weight: ${theme.typography.weights.bold};\n          border-radius: 6px;\n          white-space: nowrap;\n          overflow: hidden;\n          max-width: fit-content;\n          ${!isActive &&\n          css`\n            flex-shrink: 0;\n            width: ${theme.gridUnit * 6}px;\n            background-color: transparent;\n            transition: none;\n            &:hover svg path {\n              fill: ${theme.colors.primary.base};\n              transition: fill ${theme.transitionTiming}s ease-out;\n            }\n          `}\n\n          ${isActive &&\n          css`\n            width: 100%;\n            background-color: ${theme.colors.grayscale.light4};\n            transition:\n              width ${TILE_TRANSITION_TIME}s ease-out,\n              background-color ${TILE_TRANSITION_TIME}s ease-out;\n            cursor: default;\n            svg path {\n              fill: ${theme.colors.primary.base};\n            }\n          `}\n        `}\n      >\n        <span\n          css={css`\n            padding: 0px ${theme.gridUnit}px;\n          `}\n        >\n          {vizMeta.icon}\n        </span>\n        <span\n          css={css`\n            overflow: hidden;\n            text-overflow: ellipsis;\n            min-width: 0;\n            padding-right: ${theme.gridUnit}px;\n          `}\n          ref={chartNameRef}\n        >\n          {chartName}\n        </span>\n      </div>\n    </Tooltip>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}