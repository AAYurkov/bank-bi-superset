{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useState } from 'react';\nimport { getClientErrorObject, t, useTheme } from '@superset-ui/core';\nimport Popover from 'src/components/Popover';\nimport CopyToClipboard from 'src/components/CopyToClipboard';\nimport { getDashboardPermalink } from 'src/utils/urlUtils';\nimport { useToasts } from 'src/components/MessageToasts/withToasts';\nimport { shallowEqual, useSelector } from 'react-redux';\nimport { Icons } from 'src/components/Icons';import { jsx as _jsx, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nexport default function URLShortLinkButton({ dashboardId, anchorLinkId, placement = 'right', emailContent = '', emailSubject = '' }) {\n  const theme = useTheme();\n  const [shortUrl, setShortUrl] = useState('');\n  const { addDangerToast } = useToasts();\n  const { dataMask, activeTabs } = useSelector((state) => ({\n    dataMask: state.dataMask,\n    activeTabs: state.dashboardState.activeTabs\n  }), shallowEqual);\n  const getCopyUrl = async () => {\n    try {\n      const url = await getDashboardPermalink({\n        dashboardId,\n        dataMask,\n        activeTabs,\n        anchor: anchorLinkId\n      });\n      setShortUrl(url);\n    }\n    catch (error) {\n      if (error) {\n        addDangerToast((await getClientErrorObject(error)).error ||\n        t('Something went wrong.'));\n      }\n    }\n  };\n  const emailBody = `${emailContent}${shortUrl || ''}`;\n  const emailLink = `mailto:?Subject=${emailSubject}%20&Body=${emailBody}`;\n  return _jsx(Popover, { trigger: \"click\", placement: placement, content:\n    // eslint-disable-next-line jsx-a11y/no-static-element-interactions\n    _jsxs(\"div\", { id: \"shorturl-popover\", \"data-test\": \"shorturl-popover\", onClick: (e) => {\n        e.stopPropagation();\n      }, children: [\n      _jsx(CopyToClipboard, { text: shortUrl, copyNode: _jsx(Icons.CopyOutlined, { iconSize: \"m\", iconColor: theme.colors.primary.dark1 }) }), \"\\xA0\\xA0\",\n\n      _jsx(\"a\", { href: emailLink, \"aria-label\": \"Email link\", children:\n        _jsx(Icons.MailOutlined, { iconSize: \"m\", iconColor: theme.colors.primary.dark1 }) }\n      )] }\n    ), children:\n    _jsxs(\"span\", { className: \"short-link-trigger btn btn-default btn-sm\", tabIndex: -1, role: \"button\", onClick: (e) => {\n        e.stopPropagation();\n        getCopyUrl();\n      }, \"aria-label\": t('Copy URL'), children: [\n      _jsx(Icons.LinkOutlined, { iconSize: \"m\", className: \"short-link-trigger\" }), \"\\xA0\"] }\n\n    ) }\n  );\n}__signature__(URLShortLinkButton, \"useTheme{theme}\\nuseState{[shortUrl, setShortUrl]('')}\\nuseToasts{{ addDangerToast }}\\nuseSelector{{ dataMask, activeTabs }}\", () => [useTheme, useToasts, useSelector]);;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(URLShortLinkButton, \"URLShortLinkButton\", \"/Users/aryurkov/superset/superset-frontend/src/dashboard/components/URLShortLinkButton/index.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["useState","getClientErrorObject","t","useTheme","Popover","CopyToClipboard","getDashboardPermalink","useToasts","shallowEqual","useSelector","Icons","jsx","_jsx","jsxs","_jsxs","URLShortLinkButton","dashboardId","anchorLinkId","placement","emailContent","emailSubject","theme","shortUrl","setShortUrl","addDangerToast","dataMask","activeTabs","state","dashboardState","getCopyUrl","url","anchor","error","emailBody","emailLink","trigger","content","id","onClick","e","stopPropagation","children","text","copyNode","CopyOutlined","iconSize","iconColor","colors","primary","dark1","href","MailOutlined","className","tabIndex","role","LinkOutlined","__signature__","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/Users/aryurkov/superset/superset-frontend/src/dashboard/components/URLShortLinkButton/index.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useState } from 'react';\nimport { getClientErrorObject, t, useTheme } from '@superset-ui/core';\nimport Popover, { PopoverProps } from 'src/components/Popover';\nimport CopyToClipboard from 'src/components/CopyToClipboard';\nimport { getDashboardPermalink } from 'src/utils/urlUtils';\nimport { useToasts } from 'src/components/MessageToasts/withToasts';\nimport { shallowEqual, useSelector } from 'react-redux';\nimport { RootState } from 'src/dashboard/types';\nimport { Icons } from 'src/components/Icons';\n\nexport type URLShortLinkButtonProps = {\n  dashboardId: number;\n  anchorLinkId?: string;\n  emailSubject?: string;\n  emailContent?: string;\n  placement?: PopoverProps['placement'];\n};\n\nexport default function URLShortLinkButton({\n  dashboardId,\n  anchorLinkId,\n  placement = 'right',\n  emailContent = '',\n  emailSubject = '',\n}: URLShortLinkButtonProps) {\n  const theme = useTheme();\n  const [shortUrl, setShortUrl] = useState('');\n  const { addDangerToast } = useToasts();\n  const { dataMask, activeTabs } = useSelector(\n    (state: RootState) => ({\n      dataMask: state.dataMask,\n      activeTabs: state.dashboardState.activeTabs,\n    }),\n    shallowEqual,\n  );\n\n  const getCopyUrl = async () => {\n    try {\n      const url = await getDashboardPermalink({\n        dashboardId,\n        dataMask,\n        activeTabs,\n        anchor: anchorLinkId,\n      });\n      setShortUrl(url);\n    } catch (error) {\n      if (error) {\n        addDangerToast(\n          (await getClientErrorObject(error)).error ||\n            t('Something went wrong.'),\n        );\n      }\n    }\n  };\n\n  const emailBody = `${emailContent}${shortUrl || ''}`;\n  const emailLink = `mailto:?Subject=${emailSubject}%20&Body=${emailBody}`;\n\n  return (\n    <Popover\n      trigger=\"click\"\n      placement={placement}\n      content={\n        // eslint-disable-next-line jsx-a11y/no-static-element-interactions\n        <div\n          id=\"shorturl-popover\"\n          data-test=\"shorturl-popover\"\n          onClick={e => {\n            e.stopPropagation();\n          }}\n        >\n          <CopyToClipboard\n            text={shortUrl}\n            copyNode={\n              <Icons.CopyOutlined\n                iconSize=\"m\"\n                iconColor={theme.colors.primary.dark1}\n              />\n            }\n          />\n          &nbsp;&nbsp;\n          <a href={emailLink} aria-label=\"Email link\">\n            <Icons.MailOutlined\n              iconSize=\"m\"\n              iconColor={theme.colors.primary.dark1}\n            />\n          </a>\n        </div>\n      }\n    >\n      <span\n        className=\"short-link-trigger btn btn-default btn-sm\"\n        tabIndex={-1}\n        role=\"button\"\n        onClick={e => {\n          e.stopPropagation();\n          getCopyUrl();\n        }}\n        aria-label={t('Copy URL')}\n      >\n        <Icons.LinkOutlined iconSize=\"m\" className=\"short-link-trigger\" />\n        &nbsp;\n      </span>\n    </Popover>\n  );\n}\n"],"mappings":"wSAAA;;;;;;;;;;;;;;;;;;AAkBA,SAASA,QAAQ,QAAQ,OAAO;AAChC,SAASC,oBAAoB,EAAEC,CAAC,EAAEC,QAAQ,QAAQ,mBAAmB;AACrE,OAAOC,OAAyB,MAAM,wBAAwB;AAC9D,OAAOC,eAAe,MAAM,gCAAgC;AAC5D,SAASC,qBAAqB,QAAQ,oBAAoB;AAC1D,SAASC,SAAS,QAAQ,yCAAyC;AACnE,SAASC,YAAY,EAAEC,WAAW,QAAQ,aAAa;AAEvD,SAASC,KAAK,QAAQ,sBAAsB,CAAC,SAAAC,GAAA,IAAAC,IAAA,EAAAC,IAAA,IAAAC,KAAA;AAU7C,eAAc,SAAUC,kBAAkBA,CAAC,EACzCC,WAAW,EACXC,YAAY,EACZC,SAAS,GAAG,OAAO,EACnBC,YAAY,GAAG,EAAE,EACjBC,YAAY,GAAG,EAAE,EACO;EACxB,MAAMC,KAAK,GAAGlB,QAAQ,EAAE;EACxB,MAAM,CAACmB,QAAQ,EAAEC,WAAW,CAAC,GAAGvB,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,EAAEwB,cAAc,EAAE,GAAGjB,SAAS,EAAE;EACtC,MAAM,EAAEkB,QAAQ,EAAEC,UAAU,EAAE,GAAGjB,WAAW,CAC1C,CAACkB,KAAgB,MAAM;IACrBF,QAAQ,EAAEE,KAAK,CAACF,QAAQ;IACxBC,UAAU,EAAEC,KAAK,CAACC,cAAc,CAACF;GAClC,CAAC,EACFlB,YAAY,CACb;EAED,MAAMqB,UAAU,GAAG,MAAAA,CAAA,KAAW;IAC5B,IAAI;MACF,MAAMC,GAAG,GAAG,MAAMxB,qBAAqB,CAAC;QACtCU,WAAW;QACXS,QAAQ;QACRC,UAAU;QACVK,MAAM,EAAEd;OACT,CAAC;MACFM,WAAW,CAACO,GAAG,CAAC;;IAChB,OAAOE,KAAK,EAAE;MACd,IAAIA,KAAK,EAAE;QACTR,cAAc,CACZ,CAAC,MAAMvB,oBAAoB,CAAC+B,KAAK,CAAC,EAAEA,KAAK;QACvC9B,CAAC,CAAC,uBAAuB,CAAC,CAC7B;;;EAGP,CAAC;EAED,MAAM+B,SAAS,GAAG,GAAGd,YAAY,GAAGG,QAAQ,IAAI,EAAE,EAAE;EACpD,MAAMY,SAAS,GAAG,mBAAmBd,YAAY,YAAYa,SAAS,EAAE;EAExE,OACErB,IAAA,CAACR,OAAO,IACN+B,OAAO,EAAC,OAAO,EACfjB,SAAS,EAAEA,SAAU,EACrBkB,OAAO;IACL;IACAtB,KAAA,UACEuB,EAAE,EAAC,kBAAkB,EACrB,aAAU,kBAAkB,EAC5BC,OAAO,EAAEA,CAAAC,CAAC,KAAG;QACXA,CAAC,CAACC,eAAe,EAAE;MACrB,CAAE,EAAAC,QAAA;MAEF7B,IAAA,CAACP,eAAe,IACdqC,IAAI,EAAEpB,QAAS,EACfqB,QAAQ,EACN/B,IAAA,CAACF,KAAK,CAACkC,YAAY,IACjBC,QAAQ,EAAC,GAAG,EACZC,SAAS,EAAEzB,KAAK,CAAC0B,MAAM,CAACC,OAAO,CAACC,KAAM,GAEzC,GAEH,YACA;;MAAArC,IAAA,QAAGsC,IAAI,EAAEhB,SAAU,EAAC,cAAW,YAAY,EAAAO,QAAA;QACzC7B,IAAA,CAACF,KAAK,CAACyC,YAAY,IACjBN,QAAQ,EAAC,GAAG,EACZC,SAAS,EAAEzB,KAAK,CAAC0B,MAAM,CAACC,OAAO,CAACC,KAAM,GAE1C;MAAG,CACL;IAAK,CACN,EAAAR,QAAA;IAED3B,KAAA,WACEsC,SAAS,EAAC,2CAA2C,EACrDC,QAAQ,EAAE,CAAC,CAAE,EACbC,IAAI,EAAC,QAAQ,EACbhB,OAAO,EAAEA,CAAAC,CAAC,KAAG;QACXA,CAAC,CAACC,eAAe,EAAE;QACnBX,UAAU,EAAE;MACd,CAAE,EACF,cAAY3B,CAAC,CAAC,UAAU,CAAE,EAAAuC,QAAA;MAE1B7B,IAAA,CAACF,KAAK,CAAC6C,YAAY,IAACV,QAAQ,EAAC,GAAG,EAACO,SAAS,EAAC,oBAAoB,GAC/D,QACF;;IAAM,CACR;EAAS,CAAC;AAEd,CAACI,aAAA,CAvFuBzC,kBAAkB,yIAO1BZ,QAAQ,EAEKI,SAAS,EACHE,WAAW,sBAAAgD,cAAA,UAAAC,oBAAA,mBAAAA,oBAAA,CAAAC,OAAA,GAAAC,SAAA,MAAAH,cAAA,WAAAA,cAAA,CAAAI,QAAA,CAVtB9C,kBAAkB,oJAAA+C,WAAA,UAAAJ,oBAAA,mBAAAA,oBAAA,CAAAI,WAAA,GAAAF,SAAA,CAAAE,WAAA,IAAAA,WAAA,CAAAC,MAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}