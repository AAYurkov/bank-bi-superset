{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useCallback, useEffect, useMemo, useState } from 'react';\nimport { styled } from '@superset-ui/core';\nimport { AntdForm } from 'src/components';\nimport ScopingTree from './ScopingTree';\nimport { getDefaultScopeValue } from './utils';import { jsx as _jsx, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nconst Wrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  & > * {\n    margin-bottom: ${({ theme }) => theme.gridUnit}px;\n  }\n  padding: 0px ${({ theme }) => theme.gridUnit * 4}px;\n`;\nconst CleanFormItem = styled(AntdForm.Item)`\n  margin-bottom: 0;\n`;\nconst FilterScope = ({ pathToFormValue = [], formFilterScope, forceUpdate, filterScope, updateFormValues, chartId, initiallyExcludedCharts }) => {\n  const initialFilterScope = useMemo(() => filterScope || getDefaultScopeValue(chartId, initiallyExcludedCharts), [chartId, filterScope, initiallyExcludedCharts]);\n  const [hasScopeBeenModified, setHasScopeBeenModified] = useState(false);\n  const onUpdateFormValues = useCallback((formValues) => {\n    updateFormValues(formValues);\n    setHasScopeBeenModified(true);\n  }, [updateFormValues]);\n  const updateScopes = useCallback((updatedFormValues) => {\n    if (hasScopeBeenModified) {\n      return;\n    }\n    updateFormValues(updatedFormValues, false);\n  }, [hasScopeBeenModified, updateFormValues]);\n  useEffect(() => {\n    const updatedFormValues = {\n      scope: initialFilterScope\n    };\n    updateScopes(updatedFormValues);\n  }, [initialFilterScope, updateScopes]);\n  return _jsxs(Wrapper, { children: [\n    _jsx(ScopingTree, { updateFormValues: onUpdateFormValues, initialScope: initialFilterScope, formScope: formFilterScope, forceUpdate: forceUpdate, chartId: chartId, initiallyExcludedCharts: initiallyExcludedCharts }),\n    _jsx(CleanFormItem, { name: [...pathToFormValue, 'scope'], hidden: true, initialValue: initialFilterScope })] }\n  );\n};__signature__(FilterScope, \"useMemo{initialFilterScope}\\nuseState{[hasScopeBeenModified, setHasScopeBeenModified](false)}\\nuseCallback{onUpdateFormValues}\\nuseCallback{updateScopes}\\nuseEffect{}\");const _default =\nFilterScope;export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(Wrapper, \"Wrapper\", \"/Users/aryurkov/superset/superset-frontend/src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/FilterScope/FilterScope.tsx\");reactHotLoader.register(CleanFormItem, \"CleanFormItem\", \"/Users/aryurkov/superset/superset-frontend/src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/FilterScope/FilterScope.tsx\");reactHotLoader.register(FilterScope, \"FilterScope\", \"/Users/aryurkov/superset/superset-frontend/src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/FilterScope/FilterScope.tsx\");reactHotLoader.register(_default, \"default\", \"/Users/aryurkov/superset/superset-frontend/src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/FilterScope/FilterScope.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["useCallback","useEffect","useMemo","useState","styled","AntdForm","ScopingTree","getDefaultScopeValue","jsx","_jsx","jsxs","_jsxs","Wrapper","div","theme","gridUnit","CleanFormItem","Item","FilterScope","pathToFormValue","formFilterScope","forceUpdate","filterScope","updateFormValues","chartId","initiallyExcludedCharts","initialFilterScope","hasScopeBeenModified","setHasScopeBeenModified","onUpdateFormValues","formValues","updateScopes","updatedFormValues","scope","children","initialScope","formScope","name","hidden","initialValue","__signature__","_default","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/Users/aryurkov/superset/superset-frontend/src/dashboard/components/nativeFilters/FiltersConfigModal/FiltersConfigForm/FilterScope/FilterScope.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { FC, useCallback, useEffect, useMemo, useState } from 'react';\nimport { NativeFilterScope, styled } from '@superset-ui/core';\nimport { AntdForm } from 'src/components';\nimport ScopingTree from './ScopingTree';\nimport { getDefaultScopeValue } from './utils';\n\ntype FilterScopeProps = {\n  pathToFormValue?: string[];\n  updateFormValues: (values: any, triggerFormChange?: boolean) => void;\n  formFilterScope?: NativeFilterScope;\n  forceUpdate: Function;\n  filterScope?: NativeFilterScope;\n  chartId?: number;\n  initiallyExcludedCharts?: number[];\n};\n\nconst Wrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  & > * {\n    margin-bottom: ${({ theme }) => theme.gridUnit}px;\n  }\n  padding: 0px ${({ theme }) => theme.gridUnit * 4}px;\n`;\n\nconst CleanFormItem = styled(AntdForm.Item)`\n  margin-bottom: 0;\n`;\n\nconst FilterScope: FC<FilterScopeProps> = ({\n  pathToFormValue = [],\n  formFilterScope,\n  forceUpdate,\n  filterScope,\n  updateFormValues,\n  chartId,\n  initiallyExcludedCharts,\n}) => {\n  const initialFilterScope = useMemo(\n    () => filterScope || getDefaultScopeValue(chartId, initiallyExcludedCharts),\n    [chartId, filterScope, initiallyExcludedCharts],\n  );\n  const [hasScopeBeenModified, setHasScopeBeenModified] = useState(false);\n\n  const onUpdateFormValues = useCallback(\n    (formValues: any) => {\n      updateFormValues(formValues);\n      setHasScopeBeenModified(true);\n    },\n    [updateFormValues],\n  );\n\n  const updateScopes = useCallback(\n    updatedFormValues => {\n      if (hasScopeBeenModified) {\n        return;\n      }\n\n      updateFormValues(updatedFormValues, false);\n    },\n    [hasScopeBeenModified, updateFormValues],\n  );\n\n  useEffect(() => {\n    const updatedFormValues = {\n      scope: initialFilterScope,\n    };\n    updateScopes(updatedFormValues);\n  }, [initialFilterScope, updateScopes]);\n\n  return (\n    <Wrapper>\n      <ScopingTree\n        updateFormValues={onUpdateFormValues}\n        initialScope={initialFilterScope}\n        formScope={formFilterScope}\n        forceUpdate={forceUpdate}\n        chartId={chartId}\n        initiallyExcludedCharts={initiallyExcludedCharts}\n      />\n      <CleanFormItem\n        name={[...pathToFormValue, 'scope']}\n        hidden\n        initialValue={initialFilterScope}\n      />\n    </Wrapper>\n  );\n};\n\nexport default FilterScope;\n"],"mappings":"wSAAA;;;;;;;;;;;;;;;;;;AAmBA,SAAaA,WAAW,EAAEC,SAAS,EAAEC,OAAO,EAAEC,QAAQ,QAAQ,OAAO;AACrE,SAA4BC,MAAM,QAAQ,mBAAmB;AAC7D,SAASC,QAAQ,QAAQ,gBAAgB;AACzC,OAAOC,WAAW,MAAM,eAAe;AACvC,SAASC,oBAAoB,QAAQ,SAAS,CAAC,SAAAC,GAAA,IAAAC,IAAA,EAAAC,IAAA,IAAAC,KAAA;AAY/C,MAAMC,OAAO,GAAGR,MAAM,CAACS,GAAG;;;;qBAIL,CAAC,EAAEC,KAAK,EAAE,KAAKA,KAAK,CAACC,QAAQ;;iBAEjC,CAAC,EAAED,KAAK,EAAE,KAAKA,KAAK,CAACC,QAAQ,GAAG,CAAC;CACjD;AAED,MAAMC,aAAa,GAAGZ,MAAM,CAACC,QAAQ,CAACY,IAAI,CAAC;;CAE1C;AAED,MAAMC,WAAW,GAAyBA,CAAC,EACzCC,eAAe,GAAG,EAAE,EACpBC,eAAe,EACfC,WAAW,EACXC,WAAW,EACXC,gBAAgB,EAChBC,OAAO,EACPC,uBAAuB,EACxB,KAAI;EACH,MAAMC,kBAAkB,GAAGxB,OAAO,CAChC,MAAMoB,WAAW,IAAIf,oBAAoB,CAACiB,OAAO,EAAEC,uBAAuB,CAAC,EAC3E,CAACD,OAAO,EAAEF,WAAW,EAAEG,uBAAuB,CAAC,CAChD;EACD,MAAM,CAACE,oBAAoB,EAAEC,uBAAuB,CAAC,GAAGzB,QAAQ,CAAC,KAAK,CAAC;EAEvE,MAAM0B,kBAAkB,GAAG7B,WAAW,CACpC,CAAC8B,UAAe,KAAI;IAClBP,gBAAgB,CAACO,UAAU,CAAC;IAC5BF,uBAAuB,CAAC,IAAI,CAAC;EAC/B,CAAC,EACD,CAACL,gBAAgB,CAAC,CACnB;EAED,MAAMQ,YAAY,GAAG/B,WAAW,CAC9B,CAAAgC,iBAAiB,KAAG;IAClB,IAAIL,oBAAoB,EAAE;MACxB;;IAGFJ,gBAAgB,CAACS,iBAAiB,EAAE,KAAK,CAAC;EAC5C,CAAC,EACD,CAACL,oBAAoB,EAAEJ,gBAAgB,CAAC,CACzC;EAEDtB,SAAS,CAAC,MAAK;IACb,MAAM+B,iBAAiB,GAAG;MACxBC,KAAK,EAAEP;KACR;IACDK,YAAY,CAACC,iBAAiB,CAAC;EACjC,CAAC,EAAE,CAACN,kBAAkB,EAAEK,YAAY,CAAC,CAAC;EAEtC,OACEpB,KAAA,CAACC,OAAO,IAAAsB,QAAA;IACNzB,IAAA,CAACH,WAAW,IACViB,gBAAgB,EAAEM,kBAAmB,EACrCM,YAAY,EAAET,kBAAmB,EACjCU,SAAS,EAAEhB,eAAgB,EAC3BC,WAAW,EAAEA,WAAY,EACzBG,OAAO,EAAEA,OAAQ,EACjBC,uBAAuB,EAAEA,uBAAwB,GAEnD;IAAAhB,IAAA,CAACO,aAAa,IACZqB,IAAI,EAAE,CAAC,GAAGlB,eAAe,EAAE,OAAO,CAAE,EACpCmB,MAAM,QACNC,YAAY,EAAEb,kBAAmB,GAErC;EAAS,CAAC;AAEd,CAAC,CAACc,aAAA,CA1DItB,WAAW,kLAAAuB,QAAA;AA4DFvB,WAAW,CAA1B,eAAAuB,QAAA,CAA2B,mBAAAC,cAAA,UAAAC,oBAAA,mBAAAA,oBAAA,CAAAC,OAAA,GAAAC,SAAA,MAAAH,cAAA,WAAAA,cAAA,CAAAI,QAAA,CAzErBlC,OAAO,mKAAA8B,cAAA,CAAAI,QAAA,CASP9B,aAAa,yKAAA0B,cAAA,CAAAI,QAAA,CAIb5B,WAAW,uKAAAwB,cAAA,CAAAI,QAAA,CAAAL,QAAA,2LAAAM,WAAA,UAAAJ,oBAAA,mBAAAA,oBAAA,CAAAI,WAAA,GAAAF,SAAA,CAAAE,WAAA,IAAAA,WAAA,CAAAC,MAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}