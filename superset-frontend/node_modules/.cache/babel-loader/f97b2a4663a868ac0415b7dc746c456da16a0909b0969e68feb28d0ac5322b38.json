{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useCallback, useMemo, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { isDefined, t } from '@superset-ui/core';\nimport Modal from 'src/components/Modal';\nimport { isCrossFilterScopeGlobal, GLOBAL_SCOPE_POINTER } from 'src/dashboard/types';\nimport { getChartIdsInFilterScope } from 'src/dashboard/util/getChartIdsInFilterScope';\nimport { useChartIds } from 'src/dashboard/util/charts/useChartIds';\nimport { saveChartConfiguration } from 'src/dashboard/actions/dashboardInfo';\nimport { DEFAULT_CROSS_FILTER_SCOPING } from 'src/dashboard/constants';\nimport { useChartLayoutItems } from 'src/dashboard/util/useChartLayoutItems';\nimport { ScopingModalContent } from './ScopingModalContent';\nimport { NEW_CHART_SCOPING_ID } from './constants';import { jsx as _jsx } from \"@emotion/react/jsx-runtime\";\nconst getUpdatedGloballyScopedChartsInScope = (configs, globalChartsInScope) => Object.entries(configs).reduce((acc, [id, config]) => {\n  if (isCrossFilterScopeGlobal(config.crossFilters.scope)) {\n    acc[id] = {\n      id: Number(config.id),\n      crossFilters: {\n        scope: GLOBAL_SCOPE_POINTER,\n        chartsInScope: globalChartsInScope.filter((chartId) => chartId !== Number(config.id))\n      }\n    };\n  } else\n  {\n    acc[id] = config;\n  }\n  return acc;\n}, {});\nconst getActualScopeFromGlobalScope = (chartId, globalScope) => ({\n  rootPath: globalScope.rootPath,\n  excluded: globalScope.excluded.filter((id) => id !== chartId)\n});\nexport const ScopingModal = ({ initialChartId, isVisible, closeModal }) => {\n  const dispatch = useDispatch();\n  const chartLayoutItems = useChartLayoutItems();\n  const chartIds = useChartIds();\n  const [currentChartId, setCurrentChartId] = useState(initialChartId);\n  const initialChartConfig = useSelector((state) => {var _state$dashboardInfo$;return ((_state$dashboardInfo$ = state.dashboardInfo.metadata) == null ? void 0 : _state$dashboardInfo$.chart_configuration) || {};});\n  const defaultGlobalChartConfig = useMemo(() => ({\n    scope: DEFAULT_CROSS_FILTER_SCOPING,\n    chartsInScope: chartIds\n  }), [chartIds]);\n  const initialGlobalChartConfig = useSelector((state) => {var _state$dashboardInfo$2;return ((_state$dashboardInfo$2 = state.dashboardInfo.metadata) == null ? void 0 : _state$dashboardInfo$2.global_chart_configuration) ||\n    defaultGlobalChartConfig;});\n  const getInitialChartConfig = () => {var _initialChartConfig$i;\n    if (isDefined(initialChartId) &&\n    isCrossFilterScopeGlobal((_initialChartConfig$i = initialChartConfig[initialChartId]) == null ? void 0 : _initialChartConfig$i.crossFilters.scope)) {var _initialChartConfig$i2;\n      return {\n        ...initialChartConfig,\n        [initialChartId]: {\n          id: initialChartId,\n          crossFilters: {\n            scope: getActualScopeFromGlobalScope(initialChartId, initialGlobalChartConfig.scope),\n            chartsInScope: (_initialChartConfig$i2 = initialChartConfig[initialChartId]) == null ? void 0 : _initialChartConfig$i2.crossFilters.chartsInScope\n          }\n        }\n      };\n    }\n    return initialChartConfig;\n  };\n  const [chartConfigs, setChartConfigs] = useState(getInitialChartConfig());\n  const [globalChartConfig, setGlobalChartConfig] = useState(initialGlobalChartConfig);\n  const saveScoping = useCallback(() => {\n    const savedChartConfigs = { ...chartConfigs };\n    if (savedChartConfigs[NEW_CHART_SCOPING_ID]) {\n      delete savedChartConfigs[NEW_CHART_SCOPING_ID];\n    }\n    dispatch(saveChartConfiguration({\n      chartConfiguration: savedChartConfigs,\n      globalChartConfiguration: globalChartConfig\n    }));\n    closeModal();\n  }, [chartConfigs, closeModal, dispatch, globalChartConfig]);\n  const handleScopeUpdate = useCallback(({ scope }) => {\n    if (isDefined(currentChartId)) {\n      setChartConfigs((prevConfig) => ({\n        ...prevConfig,\n        [currentChartId]: {\n          id: currentChartId,\n          crossFilters: {\n            scope,\n            chartsInScope: getChartIdsInFilterScope(scope, chartIds, chartLayoutItems)\n          }\n        }\n      }));\n    } else\n    {\n      const globalChartsInScope = getChartIdsInFilterScope(scope, chartIds, chartLayoutItems);\n      setGlobalChartConfig({\n        scope,\n        chartsInScope: globalChartsInScope\n      });\n      setChartConfigs((prevConfig) => getUpdatedGloballyScopedChartsInScope(prevConfig, globalChartsInScope));\n    }\n  }, [currentChartId, chartIds, chartLayoutItems]);\n  const removeCustomScope = useCallback((chartId) => {\n    setChartConfigs((prevConfigs) => {\n      const newConfigs = { ...prevConfigs };\n      if (chartId === NEW_CHART_SCOPING_ID) {\n        delete newConfigs[NEW_CHART_SCOPING_ID];\n      } else\n      {\n        newConfigs[chartId] = {\n          id: chartId,\n          crossFilters: {\n            scope: GLOBAL_SCOPE_POINTER,\n            chartsInScope: globalChartConfig.chartsInScope.filter((id) => id !== chartId)\n          }\n        };\n      }\n      return newConfigs;\n    });\n    if (currentChartId === chartId) {\n      setCurrentChartId(undefined);\n    }\n  }, [currentChartId, globalChartConfig.chartsInScope]);\n  const addNewCustomScope = useCallback(() => {\n    setCurrentChartId(NEW_CHART_SCOPING_ID);\n    if (!chartConfigs[NEW_CHART_SCOPING_ID]) {\n      setChartConfigs((prevConfigs) => ({\n        ...prevConfigs,\n        [NEW_CHART_SCOPING_ID]: {\n          id: NEW_CHART_SCOPING_ID,\n          crossFilters: {\n            scope: globalChartConfig.scope,\n            chartsInScope: globalChartConfig.chartsInScope\n          }\n        }\n      }));\n    }\n  }, [chartConfigs, globalChartConfig.chartsInScope, globalChartConfig.scope]);\n  const handleSelectChange = useCallback((newChartId) => {\n    if (isDefined(currentChartId)) {var _chartConfigs$current;\n      const currentScope = !isCrossFilterScopeGlobal((_chartConfigs$current = chartConfigs[currentChartId]) == null ? void 0 : _chartConfigs$current.crossFilters.scope) ?\n      chartConfigs[currentChartId].crossFilters.\n      scope :\n      globalChartConfig.scope;\n      const newScope = {\n        rootPath: currentScope.rootPath,\n        excluded: [\n        ...currentScope.excluded.filter((id) => id !== currentChartId),\n        newChartId]\n\n      };\n      const newCrossFiltersConfig = {\n        id: newChartId,\n        crossFilters: {\n          scope: newScope,\n          chartsInScope: getChartIdsInFilterScope(newScope, chartIds, chartLayoutItems)\n        }\n      };\n      setChartConfigs((prevConfig) => {\n        const newConfig = {\n          ...prevConfig,\n          [newChartId]: newCrossFiltersConfig\n        };\n        if (currentChartId === NEW_CHART_SCOPING_ID) {\n          delete newConfig[NEW_CHART_SCOPING_ID];\n        } else\n        {\n          newConfig[currentChartId] = {\n            id: currentChartId,\n            crossFilters: {\n              scope: GLOBAL_SCOPE_POINTER,\n              chartsInScope: globalChartConfig.chartsInScope.filter((id) => id !== currentChartId)\n            }\n          };\n        }\n        return newConfig;\n      });\n      setCurrentChartId(newChartId);\n    }\n  }, [\n  chartConfigs,\n  chartIds,\n  currentChartId,\n  globalChartConfig.chartsInScope,\n  globalChartConfig.scope,\n  chartLayoutItems]\n  );\n  const scope = useMemo(() => {var _chartConfigs$current2, _chartConfigs$current3, _chartConfigs$current4, _chartConfigs$current5;\n    const globalScope = globalChartConfig.scope;\n    if (!isDefined(currentChartId)) {\n      return globalScope;\n    }\n    if (isCrossFilterScopeGlobal((_chartConfigs$current2 = chartConfigs[currentChartId]) == null ? void 0 : (_chartConfigs$current3 = _chartConfigs$current2.crossFilters) == null ? void 0 : _chartConfigs$current3.scope)) {\n      return getActualScopeFromGlobalScope(currentChartId, globalScope);\n    }\n    return (_chartConfigs$current4 = chartConfigs[currentChartId]) == null ? void 0 : (_chartConfigs$current5 = _chartConfigs$current4.crossFilters) == null ? void 0 : _chartConfigs$current5.\n    scope;\n  }, [chartConfigs, currentChartId, globalChartConfig.scope]);\n  return _jsx(Modal, { onHide: closeModal, show: isVisible, title: t('Cross-filtering scoping'), onHandledPrimaryAction: saveScoping, primaryButtonName: t('Save'), responsive: true, destroyOnClose: true, bodyStyle: {\n      padding: 0,\n      height: 700\n    }, children:\n    _jsx(ScopingModalContent, { chartConfigs: chartConfigs, currentScope: scope, onScopeUpdate: handleScopeUpdate, chartId: currentChartId, setCurrentChartId: setCurrentChartId, onSelectChange: handleSelectChange, removeCustomScope: removeCustomScope, addNewCustomScope: addNewCustomScope }) }\n  );\n};__signature__(ScopingModal, \"useDispatch{dispatch}\\nuseChartLayoutItems{chartLayoutItems}\\nuseChartIds{chartIds}\\nuseState{[currentChartId, setCurrentChartId](initialChartId)}\\nuseSelector{initialChartConfig}\\nuseMemo{defaultGlobalChartConfig}\\nuseSelector{initialGlobalChartConfig}\\nuseState{[chartConfigs, setChartConfigs](getInitialChartConfig())}\\nuseState{[globalChartConfig, setGlobalChartConfig](initialGlobalChartConfig)}\\nuseCallback{saveScoping}\\nuseCallback{handleScopeUpdate}\\nuseCallback{removeCustomScope}\\nuseCallback{addNewCustomScope}\\nuseCallback{handleSelectChange}\\nuseMemo{scope}\", () => [useDispatch, useChartLayoutItems, useChartIds, useSelector, useSelector]);;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(getUpdatedGloballyScopedChartsInScope, \"getUpdatedGloballyScopedChartsInScope\", \"/Users/aryurkov/superset/superset-frontend/src/dashboard/components/nativeFilters/FilterBar/CrossFilters/ScopingModal/ScopingModal.tsx\");reactHotLoader.register(getActualScopeFromGlobalScope, \"getActualScopeFromGlobalScope\", \"/Users/aryurkov/superset/superset-frontend/src/dashboard/components/nativeFilters/FilterBar/CrossFilters/ScopingModal/ScopingModal.tsx\");reactHotLoader.register(ScopingModal, \"ScopingModal\", \"/Users/aryurkov/superset/superset-frontend/src/dashboard/components/nativeFilters/FilterBar/CrossFilters/ScopingModal/ScopingModal.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["useCallback","useMemo","useState","useDispatch","useSelector","isDefined","t","Modal","isCrossFilterScopeGlobal","GLOBAL_SCOPE_POINTER","getChartIdsInFilterScope","useChartIds","saveChartConfiguration","DEFAULT_CROSS_FILTER_SCOPING","useChartLayoutItems","ScopingModalContent","NEW_CHART_SCOPING_ID","jsx","_jsx","getUpdatedGloballyScopedChartsInScope","configs","globalChartsInScope","Object","entries","reduce","acc","id","config","crossFilters","scope","Number","chartsInScope","filter","chartId","getActualScopeFromGlobalScope","globalScope","rootPath","excluded","ScopingModal","initialChartId","isVisible","closeModal","dispatch","chartLayoutItems","chartIds","currentChartId","setCurrentChartId","initialChartConfig","state","_state$dashboardInfo$","dashboardInfo","metadata","chart_configuration","defaultGlobalChartConfig","initialGlobalChartConfig","_state$dashboardInfo$2","global_chart_configuration","getInitialChartConfig","_initialChartConfig$i","_initialChartConfig$i2","chartConfigs","setChartConfigs","globalChartConfig","setGlobalChartConfig","saveScoping","savedChartConfigs","chartConfiguration","globalChartConfiguration","handleScopeUpdate","prevConfig","removeCustomScope","prevConfigs","newConfigs","undefined","addNewCustomScope","handleSelectChange","newChartId","_chartConfigs$current","currentScope","newScope","newCrossFiltersConfig","newConfig","_chartConfigs$current2","_chartConfigs$current3","_chartConfigs$current4","_chartConfigs$current5","onHide","show","title","onHandledPrimaryAction","primaryButtonName","responsive","destroyOnClose","bodyStyle","padding","height","children","onScopeUpdate","onSelectChange","__signature__","reactHotLoader","reactHotLoaderGlobal","default","register","leaveModule","module"],"sources":["/Users/aryurkov/superset/superset-frontend/src/dashboard/components/nativeFilters/FilterBar/CrossFilters/ScopingModal/ScopingModal.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useCallback, useMemo, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { isDefined, NativeFilterScope, t } from '@superset-ui/core';\nimport Modal from 'src/components/Modal';\nimport {\n  ChartConfiguration,\n  RootState,\n  isCrossFilterScopeGlobal,\n  GlobalChartCrossFilterConfig,\n  GLOBAL_SCOPE_POINTER,\n  ChartCrossFiltersConfig,\n} from 'src/dashboard/types';\nimport { getChartIdsInFilterScope } from 'src/dashboard/util/getChartIdsInFilterScope';\nimport { useChartIds } from 'src/dashboard/util/charts/useChartIds';\nimport { saveChartConfiguration } from 'src/dashboard/actions/dashboardInfo';\nimport { DEFAULT_CROSS_FILTER_SCOPING } from 'src/dashboard/constants';\nimport { useChartLayoutItems } from 'src/dashboard/util/useChartLayoutItems';\nimport { ScopingModalContent } from './ScopingModalContent';\nimport { NEW_CHART_SCOPING_ID } from './constants';\n\nconst getUpdatedGloballyScopedChartsInScope = (\n  configs: ChartConfiguration,\n  globalChartsInScope: number[],\n) =>\n  Object.entries(configs).reduce<\n    Record<string, { id: number; crossFilters: ChartCrossFiltersConfig }>\n  >((acc, [id, config]) => {\n    if (isCrossFilterScopeGlobal(config.crossFilters.scope)) {\n      acc[id] = {\n        id: Number(config.id),\n        crossFilters: {\n          scope: GLOBAL_SCOPE_POINTER,\n          chartsInScope: globalChartsInScope.filter(\n            chartId => chartId !== Number(config.id),\n          ),\n        },\n      };\n    } else {\n      acc[id] = config;\n    }\n    return acc;\n  }, {});\n\nconst getActualScopeFromGlobalScope = (\n  chartId: number,\n  globalScope: NativeFilterScope,\n) => ({\n  rootPath: globalScope.rootPath,\n  excluded: globalScope.excluded.filter(id => id !== chartId),\n});\n\nexport interface ScopingModalProps {\n  initialChartId: number | undefined;\n  isVisible: boolean;\n  closeModal: () => void;\n}\n\nexport const ScopingModal = ({\n  initialChartId,\n  isVisible,\n  closeModal,\n}: ScopingModalProps) => {\n  const dispatch = useDispatch();\n  const chartLayoutItems = useChartLayoutItems();\n  const chartIds = useChartIds();\n  const [currentChartId, setCurrentChartId] = useState(initialChartId);\n  const initialChartConfig = useSelector<RootState, ChartConfiguration>(\n    state => state.dashboardInfo.metadata?.chart_configuration || {},\n  );\n  const defaultGlobalChartConfig = useMemo(\n    () => ({\n      scope: DEFAULT_CROSS_FILTER_SCOPING,\n      chartsInScope: chartIds,\n    }),\n    [chartIds],\n  );\n\n  const initialGlobalChartConfig = useSelector<\n    RootState,\n    GlobalChartCrossFilterConfig\n  >(\n    state =>\n      state.dashboardInfo.metadata?.global_chart_configuration ||\n      defaultGlobalChartConfig,\n  );\n\n  const getInitialChartConfig = () => {\n    if (\n      isDefined(initialChartId) &&\n      isCrossFilterScopeGlobal(\n        initialChartConfig[initialChartId]?.crossFilters.scope,\n      )\n    ) {\n      return {\n        ...initialChartConfig,\n        [initialChartId]: {\n          id: initialChartId,\n          crossFilters: {\n            scope: getActualScopeFromGlobalScope(\n              initialChartId,\n              initialGlobalChartConfig.scope,\n            ),\n            chartsInScope:\n              initialChartConfig[initialChartId]?.crossFilters.chartsInScope,\n          },\n        },\n      };\n    }\n    return initialChartConfig;\n  };\n\n  const [chartConfigs, setChartConfigs] = useState(getInitialChartConfig());\n  const [globalChartConfig, setGlobalChartConfig] = useState(\n    initialGlobalChartConfig,\n  );\n\n  const saveScoping = useCallback(() => {\n    const savedChartConfigs = { ...chartConfigs };\n    if (savedChartConfigs[NEW_CHART_SCOPING_ID]) {\n      delete savedChartConfigs[NEW_CHART_SCOPING_ID];\n    }\n    dispatch(\n      saveChartConfiguration({\n        chartConfiguration: savedChartConfigs,\n        globalChartConfiguration: globalChartConfig,\n      }),\n    );\n    closeModal();\n  }, [chartConfigs, closeModal, dispatch, globalChartConfig]);\n\n  const handleScopeUpdate = useCallback(\n    ({ scope }: { scope: NativeFilterScope }) => {\n      if (isDefined(currentChartId)) {\n        setChartConfigs(prevConfig => ({\n          ...prevConfig,\n          [currentChartId]: {\n            id: currentChartId,\n            crossFilters: {\n              scope,\n              chartsInScope: getChartIdsInFilterScope(\n                scope,\n                chartIds,\n                chartLayoutItems,\n              ),\n            },\n          },\n        }));\n      } else {\n        const globalChartsInScope = getChartIdsInFilterScope(\n          scope,\n          chartIds,\n          chartLayoutItems,\n        );\n        setGlobalChartConfig({\n          scope,\n          chartsInScope: globalChartsInScope,\n        });\n        setChartConfigs(prevConfig =>\n          getUpdatedGloballyScopedChartsInScope(\n            prevConfig,\n            globalChartsInScope,\n          ),\n        );\n      }\n    },\n    [currentChartId, chartIds, chartLayoutItems],\n  );\n\n  const removeCustomScope = useCallback(\n    (chartId: number) => {\n      setChartConfigs(prevConfigs => {\n        const newConfigs = { ...prevConfigs };\n        if (chartId === NEW_CHART_SCOPING_ID) {\n          delete newConfigs[NEW_CHART_SCOPING_ID];\n        } else {\n          newConfigs[chartId] = {\n            id: chartId,\n            crossFilters: {\n              scope: GLOBAL_SCOPE_POINTER,\n              chartsInScope: globalChartConfig.chartsInScope.filter(\n                id => id !== chartId,\n              ),\n            },\n          };\n        }\n        return newConfigs;\n      });\n      if (currentChartId === chartId) {\n        setCurrentChartId(undefined);\n      }\n    },\n    [currentChartId, globalChartConfig.chartsInScope],\n  );\n\n  const addNewCustomScope = useCallback(() => {\n    setCurrentChartId(NEW_CHART_SCOPING_ID);\n    if (!chartConfigs[NEW_CHART_SCOPING_ID]) {\n      setChartConfigs(prevConfigs => ({\n        ...prevConfigs,\n        [NEW_CHART_SCOPING_ID]: {\n          id: NEW_CHART_SCOPING_ID,\n          crossFilters: {\n            scope: globalChartConfig.scope,\n            chartsInScope: globalChartConfig.chartsInScope,\n          },\n        },\n      }));\n    }\n  }, [chartConfigs, globalChartConfig.chartsInScope, globalChartConfig.scope]);\n\n  const handleSelectChange = useCallback(\n    (newChartId: number) => {\n      if (isDefined(currentChartId)) {\n        const currentScope = !isCrossFilterScopeGlobal(\n          chartConfigs[currentChartId]?.crossFilters.scope,\n        )\n          ? (chartConfigs[currentChartId].crossFilters\n              .scope as NativeFilterScope)\n          : globalChartConfig.scope;\n        const newScope = {\n          rootPath: currentScope.rootPath,\n          excluded: [\n            ...currentScope.excluded.filter(id => id !== currentChartId),\n            newChartId,\n          ],\n        };\n        const newCrossFiltersConfig = {\n          id: newChartId,\n          crossFilters: {\n            scope: newScope,\n            chartsInScope: getChartIdsInFilterScope(\n              newScope,\n              chartIds,\n              chartLayoutItems,\n            ),\n          },\n        };\n\n        setChartConfigs(prevConfig => {\n          const newConfig = {\n            ...prevConfig,\n            [newChartId]: newCrossFiltersConfig,\n          };\n          if (currentChartId === NEW_CHART_SCOPING_ID) {\n            delete newConfig[NEW_CHART_SCOPING_ID];\n          } else {\n            newConfig[currentChartId] = {\n              id: currentChartId,\n              crossFilters: {\n                scope: GLOBAL_SCOPE_POINTER,\n                chartsInScope: globalChartConfig.chartsInScope.filter(\n                  id => id !== currentChartId,\n                ),\n              },\n            };\n          }\n          return newConfig;\n        });\n\n        setCurrentChartId(newChartId);\n      }\n    },\n    [\n      chartConfigs,\n      chartIds,\n      currentChartId,\n      globalChartConfig.chartsInScope,\n      globalChartConfig.scope,\n      chartLayoutItems,\n    ],\n  );\n\n  const scope = useMemo(() => {\n    const globalScope = globalChartConfig.scope;\n    if (!isDefined(currentChartId)) {\n      return globalScope;\n    }\n    if (\n      isCrossFilterScopeGlobal(\n        chartConfigs[currentChartId]?.crossFilters?.scope,\n      )\n    ) {\n      return getActualScopeFromGlobalScope(currentChartId, globalScope);\n    }\n    return chartConfigs[currentChartId]?.crossFilters\n      ?.scope as NativeFilterScope;\n  }, [chartConfigs, currentChartId, globalChartConfig.scope]);\n\n  return (\n    <Modal\n      onHide={closeModal}\n      show={isVisible}\n      title={t('Cross-filtering scoping')}\n      onHandledPrimaryAction={saveScoping}\n      primaryButtonName={t('Save')}\n      responsive\n      destroyOnClose\n      bodyStyle={{\n        padding: 0,\n        height: 700,\n      }}\n    >\n      <ScopingModalContent\n        chartConfigs={chartConfigs}\n        currentScope={scope}\n        onScopeUpdate={handleScopeUpdate}\n        chartId={currentChartId}\n        setCurrentChartId={setCurrentChartId}\n        onSelectChange={handleSelectChange}\n        removeCustomScope={removeCustomScope}\n        addNewCustomScope={addNewCustomScope}\n      />\n    </Modal>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}