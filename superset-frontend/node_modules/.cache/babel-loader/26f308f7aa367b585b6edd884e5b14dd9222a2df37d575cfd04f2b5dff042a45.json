{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint camelcase: 0 */\nimport { getChartControlPanelRegistry, VizType } from '@superset-ui/core';\nimport { getAllControlsState, getFormDataFromControls } from './controlUtils';\nimport { controls } from './controls';\n\nfunction handleDeprecatedControls(formData) {\n  // Reaffectation / handling of deprecated controls\n  /* eslint-disable no-param-reassign */\n\n  // y_axis_zero was a boolean forcing 0 to be part of the Y Axis\n  if (formData.y_axis_zero) {\n    formData.y_axis_bounds = [0, null];\n  }\n}\n\nexport function getControlsState(state, inputFormData) {var _state$common;\n  /*\n   * Gets a new controls object to put in the state. The controls object\n   * is similar to the configuration control with only the controls\n   * related to the current viz_type, materializes mapStateToProps functions,\n   * adds value keys coming from inputFormData passed here. This can't be an action creator\n   * just yet because it's used in both the explore and dashboard views.\n   * */\n  // Getting a list of active control names for the current viz\n  const formData = { ...inputFormData };\n  const vizType =\n  formData.viz_type || ((_state$common = state.common) == null ? void 0 : _state$common.conf.DEFAULT_VIZ_TYPE) || VizType.Table;\n\n  handleDeprecatedControls(formData);\n  const controlsState = getAllControlsState(\n    vizType,\n    state.datasource.type,\n    state,\n    formData\n  );\n\n  const controlPanelConfig = getChartControlPanelRegistry().get(vizType) || {};\n  if (controlPanelConfig.onInit) {\n    return controlPanelConfig.onInit(controlsState);\n  }\n\n  return controlsState;\n}\n\nexport function applyDefaultFormData(inputFormData) {\n  const datasourceType = inputFormData.datasource.split('__')[1];\n  const vizType = inputFormData.viz_type;\n  const controlsState = getAllControlsState(\n    vizType,\n    datasourceType,\n    null,\n    inputFormData\n  );\n  const controlFormData = getFormDataFromControls(controlsState);\n\n  const formData = {};\n  Object.keys(controlsState).\n  concat(Object.keys(inputFormData)).\n  forEach((controlName) => {\n    if (inputFormData[controlName] === undefined) {\n      formData[controlName] = controlFormData[controlName];\n    } else {\n      formData[controlName] = inputFormData[controlName];\n    }\n  });\n\n  return formData;\n}\n\nconst defaultControls = { ...controls };\nObject.keys(controls).forEach((f) => {\n  defaultControls[f].value = controls[f].default;\n});\n\nconst defaultState = {\n  controls: defaultControls,\n  form_data: getFormDataFromControls(defaultControls)\n};\n\nexport { defaultControls, defaultState };;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(handleDeprecatedControls, \"handleDeprecatedControls\", \"/Users/aryurkov/superset/superset-frontend/src/explore/store.js\");reactHotLoader.register(getControlsState, \"getControlsState\", \"/Users/aryurkov/superset/superset-frontend/src/explore/store.js\");reactHotLoader.register(applyDefaultFormData, \"applyDefaultFormData\", \"/Users/aryurkov/superset/superset-frontend/src/explore/store.js\");reactHotLoader.register(defaultControls, \"defaultControls\", \"/Users/aryurkov/superset/superset-frontend/src/explore/store.js\");reactHotLoader.register(defaultState, \"defaultState\", \"/Users/aryurkov/superset/superset-frontend/src/explore/store.js\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["getChartControlPanelRegistry","VizType","getAllControlsState","getFormDataFromControls","controls","handleDeprecatedControls","formData","y_axis_zero","y_axis_bounds","getControlsState","state","inputFormData","_state$common","vizType","viz_type","common","conf","DEFAULT_VIZ_TYPE","Table","controlsState","datasource","type","controlPanelConfig","get","onInit","applyDefaultFormData","datasourceType","split","controlFormData","Object","keys","concat","forEach","controlName","undefined","defaultControls","f","value","default","defaultState","form_data","reactHotLoader","reactHotLoaderGlobal","register","leaveModule","module"],"sources":["/Users/aryurkov/superset/superset-frontend/src/explore/store.js"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint camelcase: 0 */\nimport { getChartControlPanelRegistry, VizType } from '@superset-ui/core';\nimport { getAllControlsState, getFormDataFromControls } from './controlUtils';\nimport { controls } from './controls';\n\nfunction handleDeprecatedControls(formData) {\n  // Reaffectation / handling of deprecated controls\n  /* eslint-disable no-param-reassign */\n\n  // y_axis_zero was a boolean forcing 0 to be part of the Y Axis\n  if (formData.y_axis_zero) {\n    formData.y_axis_bounds = [0, null];\n  }\n}\n\nexport function getControlsState(state, inputFormData) {\n  /*\n   * Gets a new controls object to put in the state. The controls object\n   * is similar to the configuration control with only the controls\n   * related to the current viz_type, materializes mapStateToProps functions,\n   * adds value keys coming from inputFormData passed here. This can't be an action creator\n   * just yet because it's used in both the explore and dashboard views.\n   * */\n  // Getting a list of active control names for the current viz\n  const formData = { ...inputFormData };\n  const vizType =\n    formData.viz_type || state.common?.conf.DEFAULT_VIZ_TYPE || VizType.Table;\n\n  handleDeprecatedControls(formData);\n  const controlsState = getAllControlsState(\n    vizType,\n    state.datasource.type,\n    state,\n    formData,\n  );\n\n  const controlPanelConfig = getChartControlPanelRegistry().get(vizType) || {};\n  if (controlPanelConfig.onInit) {\n    return controlPanelConfig.onInit(controlsState);\n  }\n\n  return controlsState;\n}\n\nexport function applyDefaultFormData(inputFormData) {\n  const datasourceType = inputFormData.datasource.split('__')[1];\n  const vizType = inputFormData.viz_type;\n  const controlsState = getAllControlsState(\n    vizType,\n    datasourceType,\n    null,\n    inputFormData,\n  );\n  const controlFormData = getFormDataFromControls(controlsState);\n\n  const formData = {};\n  Object.keys(controlsState)\n    .concat(Object.keys(inputFormData))\n    .forEach(controlName => {\n      if (inputFormData[controlName] === undefined) {\n        formData[controlName] = controlFormData[controlName];\n      } else {\n        formData[controlName] = inputFormData[controlName];\n      }\n    });\n\n  return formData;\n}\n\nconst defaultControls = { ...controls };\nObject.keys(controls).forEach(f => {\n  defaultControls[f].value = controls[f].default;\n});\n\nconst defaultState = {\n  controls: defaultControls,\n  form_data: getFormDataFromControls(defaultControls),\n};\n\nexport { defaultControls, defaultState };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}