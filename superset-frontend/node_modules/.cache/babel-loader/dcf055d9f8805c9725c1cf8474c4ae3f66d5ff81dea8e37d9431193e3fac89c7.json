{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ControlHeader } from '@superset-ui/chart-controls';\nimport { css, styled, t } from '@superset-ui/core';\nimport Button from 'src/components/Button';\nimport Popover from 'src/components/Popover';\nimport { useState } from 'react';\nimport { mix } from 'polished';\nimport MapViewPopoverContent from './MapViewPopoverContent';\nimport ExtentTag from './ExtentTag';\nimport { ControlFormItem } from '../ColumnConfigControl/ControlForm';import { jsx as _jsx, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nexport const StyledExtentButton = styled(Button)`\n  ${({ theme }) => css`\n    flex: 1;\n    margin-right: 4px;\n    line-height: 1.5715;\n    border-radius: ${theme.borderRadius}px;\n    background-color: ${theme.colors.primary.light4};\n    color: ${theme.colors.primary.dark1};\n    font-size: ${theme.typography.sizes.s}px;\n    font-weight: ${theme.typography.weights.bold};\n    text-transform: uppercase;\n    min-width: ${theme.gridUnit * 36};\n    min-height: ${theme.gridUnit * 8};\n    box-shadow: none;\n    border-width: 0px;\n    border-style: none;\n    border-color: transparent;\n    margin-left: 9px;\n    margin-top: 10px;\n    &:hover {\n      background-color: ${mix(0.1, theme.colors.primary.base, theme.colors.primary.light4)};\n      color: ${theme.colors.primary.dark1};\n    }\n  `}\n`;\nexport const StyledExtentTag = styled(ExtentTag)`\n  ${() => css`\n    margin-left: 9px;\n  `}\n`;\nexport const StyledControlFormItem = styled(ControlFormItem)`\n  ${({ theme }) => css`\n    border-radius: ${theme.borderRadius}px;\n  `}\n`;\nexport const MapViewControl = ({ value, onChange = () => {}, name, label, description, renderTrigger, hovered, validationErrors }) => {\n  const [popoverVisible, setPopoverVisible] = useState(false);\n  const onTagClick = () => {\n    setPopoverVisible(!popoverVisible);\n  };\n  const isCustomMode = () => (value == null ? void 0 : value.mode) === 'CUSTOM';\n  const onModeChange = (newValue) => {\n    if (!value)\n    return;\n    const changedValue = {\n      ...value,\n      mode: newValue\n    };\n    if (newValue === 'FIT_DATA') {\n      setPopoverVisible(false);\n    }\n    onChange(changedValue);\n  };\n  const onButtonClick = () => {\n    if (!value)\n    return;\n    const changedValue = {\n      ...value,\n      fixedLatitude: value == null ? void 0 : value.latitude,\n      fixedLongitude: value == null ? void 0 : value.longitude,\n      fixedZoom: value == null ? void 0 : value.zoom\n    };\n    onChange(changedValue);\n  };\n  const onSaveClick = (newValue) => {\n    setPopoverVisible(false);\n    onChange(newValue);\n  };\n  const onCloseClick = () => {\n    setPopoverVisible(false);\n  };\n  const popoverTitle = t('Extent');\n  const modeNameFitData = t('FIT DATA');\n  const modeNameCustom = t('CUSTOM');\n  const extentButtonText = t('Use current extent');\n  const controlHeaderProps = {\n    name,\n    label,\n    description,\n    renderTrigger,\n    hovered,\n    validationErrors\n  };\n  return _jsxs(\"div\", { children: [\n    _jsx(ControlHeader, { ...controlHeaderProps }),\n    _jsx(StyledControlFormItem, { controlType: \"RadioButtonControl\", label: \"\", description: \"\", name: \"mode\", options: [\n      ['FIT_DATA', modeNameFitData],\n      ['CUSTOM', modeNameCustom]],\n      value: value ? value.mode : undefined, onChange: onModeChange }),\n\n    isCustomMode() && value && _jsx(StyledExtentTag, { onClick: onTagClick, value: value }),\n\n    isCustomMode() && value && _jsx(Popover, { open: popoverVisible, trigger: \"click\", title: popoverTitle, placement: \"right\", overlayStyle: {\n        maxWidth: '400px',\n        maxHeight: '700px',\n        overflowY: 'auto'\n      }, content: _jsx(MapViewPopoverContent, { onClose: onCloseClick, onSave: onSaveClick, mapViewConf: value }) }),\n\n    _jsx(\"br\", {}),\n\n    isCustomMode() && _jsx(StyledExtentButton, { onClick: onButtonClick, size: \"small\", children:\n      extentButtonText }\n    )] }\n  );\n};__signature__(MapViewControl, \"useState{[popoverVisible, setPopoverVisible](false)}\");const _default =\nMapViewControl;export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(StyledExtentButton, \"StyledExtentButton\", \"/Users/aryurkov/superset/superset-frontend/src/explore/components/controls/MapViewControl/MapViewControl.tsx\");reactHotLoader.register(StyledExtentTag, \"StyledExtentTag\", \"/Users/aryurkov/superset/superset-frontend/src/explore/components/controls/MapViewControl/MapViewControl.tsx\");reactHotLoader.register(StyledControlFormItem, \"StyledControlFormItem\", \"/Users/aryurkov/superset/superset-frontend/src/explore/components/controls/MapViewControl/MapViewControl.tsx\");reactHotLoader.register(MapViewControl, \"MapViewControl\", \"/Users/aryurkov/superset/superset-frontend/src/explore/components/controls/MapViewControl/MapViewControl.tsx\");reactHotLoader.register(_default, \"default\", \"/Users/aryurkov/superset/superset-frontend/src/explore/components/controls/MapViewControl/MapViewControl.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["ControlHeader","css","styled","t","Button","Popover","useState","mix","MapViewPopoverContent","ExtentTag","ControlFormItem","jsx","_jsx","jsxs","_jsxs","StyledExtentButton","theme","borderRadius","colors","primary","light4","dark1","typography","sizes","s","weights","bold","gridUnit","base","StyledExtentTag","StyledControlFormItem","MapViewControl","value","onChange","name","label","description","renderTrigger","hovered","validationErrors","popoverVisible","setPopoverVisible","onTagClick","isCustomMode","mode","onModeChange","newValue","changedValue","onButtonClick","fixedLatitude","latitude","fixedLongitude","longitude","fixedZoom","zoom","onSaveClick","onCloseClick","popoverTitle","modeNameFitData","modeNameCustom","extentButtonText","controlHeaderProps","children","controlType","options","undefined","onClick","open","trigger","title","placement","overlayStyle","maxWidth","maxHeight","overflowY","content","onClose","onSave","mapViewConf","size","__signature__","_default","reactHotLoader","reactHotLoaderGlobal","default","register","leaveModule","module"],"sources":["/Users/aryurkov/superset/superset-frontend/src/explore/components/controls/MapViewControl/MapViewControl.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ControlHeader } from '@superset-ui/chart-controls';\nimport { css, styled, t } from '@superset-ui/core';\nimport Button from 'src/components/Button';\nimport Popover from 'src/components/Popover';\nimport { FC, useState } from 'react';\nimport { mix } from 'polished';\nimport { MapViewConfigs, MapViewConfigsControlProps } from './types';\nimport MapViewPopoverContent from './MapViewPopoverContent';\nimport ExtentTag from './ExtentTag';\nimport { ControlFormItem } from '../ColumnConfigControl/ControlForm';\n\nexport const StyledExtentButton = styled(Button)`\n  ${({ theme }) => css`\n    flex: 1;\n    margin-right: 4px;\n    line-height: 1.5715;\n    border-radius: ${theme.borderRadius}px;\n    background-color: ${theme.colors.primary.light4};\n    color: ${theme.colors.primary.dark1};\n    font-size: ${theme.typography.sizes.s}px;\n    font-weight: ${theme.typography.weights.bold};\n    text-transform: uppercase;\n    min-width: ${theme.gridUnit * 36};\n    min-height: ${theme.gridUnit * 8};\n    box-shadow: none;\n    border-width: 0px;\n    border-style: none;\n    border-color: transparent;\n    margin-left: 9px;\n    margin-top: 10px;\n    &:hover {\n      background-color: ${mix(\n        0.1,\n        theme.colors.primary.base,\n        theme.colors.primary.light4,\n      )};\n      color: ${theme.colors.primary.dark1};\n    }\n  `}\n`;\n\nexport const StyledExtentTag = styled(ExtentTag)`\n  ${() => css`\n    margin-left: 9px;\n  `}\n`;\n\nexport const StyledControlFormItem = styled(ControlFormItem)`\n  ${({ theme }) => css`\n    border-radius: ${theme.borderRadius}px;\n  `}\n`;\n\nexport const MapViewControl: FC<MapViewConfigsControlProps> = ({\n  value,\n  onChange = () => {},\n  name,\n  label,\n  description,\n  renderTrigger,\n  hovered,\n  validationErrors,\n}) => {\n  const [popoverVisible, setPopoverVisible] = useState<boolean>(false);\n\n  const onTagClick = () => {\n    setPopoverVisible(!popoverVisible);\n  };\n\n  const isCustomMode = () => value?.mode === 'CUSTOM';\n\n  const onModeChange = (newValue: 'FIT_DATA' | 'CUSTOM') => {\n    if (!value) return;\n\n    const changedValue: MapViewConfigs = {\n      ...value,\n      mode: newValue,\n    };\n\n    if (newValue === 'FIT_DATA') {\n      setPopoverVisible(false);\n    }\n\n    onChange(changedValue);\n  };\n\n  const onButtonClick = () => {\n    if (!value) return;\n\n    const changedValue: MapViewConfigs = {\n      ...value,\n      fixedLatitude: value?.latitude,\n      fixedLongitude: value?.longitude,\n      fixedZoom: value?.zoom,\n    };\n\n    onChange(changedValue);\n  };\n\n  const onSaveClick = (newValue: MapViewConfigs) => {\n    setPopoverVisible(false);\n    onChange(newValue);\n  };\n\n  const onCloseClick = () => {\n    setPopoverVisible(false);\n  };\n\n  const popoverTitle = t('Extent');\n  const modeNameFitData = t('FIT DATA');\n  const modeNameCustom = t('CUSTOM');\n  const extentButtonText = t('Use current extent');\n\n  const controlHeaderProps = {\n    name,\n    label,\n    description,\n    renderTrigger,\n    hovered,\n    validationErrors,\n  };\n\n  return (\n    <div>\n      <ControlHeader {...controlHeaderProps} />\n      <StyledControlFormItem\n        controlType=\"RadioButtonControl\"\n        label=\"\"\n        description=\"\"\n        name=\"mode\"\n        options={[\n          ['FIT_DATA', modeNameFitData],\n          ['CUSTOM', modeNameCustom],\n        ]}\n        value={value ? value.mode : undefined}\n        onChange={onModeChange}\n      />\n\n      {isCustomMode() && value && (\n        <StyledExtentTag onClick={onTagClick} value={value} />\n      )}\n\n      {isCustomMode() && value && (\n        <Popover\n          open={popoverVisible}\n          trigger=\"click\"\n          title={popoverTitle}\n          placement=\"right\"\n          overlayStyle={{\n            maxWidth: '400px',\n            maxHeight: '700px',\n            overflowY: 'auto',\n          }}\n          content={\n            <MapViewPopoverContent\n              onClose={onCloseClick}\n              onSave={onSaveClick}\n              mapViewConf={value}\n            />\n          }\n        />\n      )}\n\n      <br />\n\n      {isCustomMode() && (\n        <StyledExtentButton onClick={onButtonClick} size=\"small\">\n          {extentButtonText}\n        </StyledExtentButton>\n      )}\n    </div>\n  );\n};\n\nexport default MapViewControl;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}