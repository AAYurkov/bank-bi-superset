{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { PureComponent } from 'react';\nimport rison from 'rison';\nimport querystring from 'query-string';\nimport { isDefined, styled, SupersetClient, t } from '@superset-ui/core';\nimport { withTheme } from '@emotion/react';\nimport { getUrlParam } from 'src/utils/urlUtils';\nimport { FilterPlugins, URL_PARAMS } from 'src/constants';\nimport { Link, withRouter } from 'react-router-dom';\nimport Button from 'src/components/Button';\nimport { AsyncSelect } from 'src/components';\nimport { Steps } from 'src/components/Steps';\nimport withToasts from 'src/components/MessageToasts/withToasts';\nimport VizTypeGallery, { MAX_ADVISABLE_VIZ_GALLERY_WIDTH } from 'src/explore/components/controls/VizTypeControl/VizTypeGallery';\nimport { findPermission } from 'src/utils/findPermission';\nimport getBootstrapData from 'src/utils/getBootstrapData';\nimport { DatasetSelectLabel } from 'src/features/datasets/DatasetSelectLabel';\nimport { Icons } from 'src/components/Icons';import { jsx as _jsx, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nconst ESTIMATED_NAV_HEIGHT = 56;\nconst ELEMENTS_EXCEPT_VIZ_GALLERY = ESTIMATED_NAV_HEIGHT + 250;\nconst bootstrapData = getBootstrapData();\nconst denyList = (bootstrapData.common.conf.VIZ_TYPE_DENYLIST || []).concat(Object.values(FilterPlugins));\nconst StyledContainer = styled.div`\n  ${({ theme }) => `\n    flex: 1 1 auto;\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n    width: 100%;\n    max-width: ${MAX_ADVISABLE_VIZ_GALLERY_WIDTH}px;\n    max-height: calc(100vh - ${ESTIMATED_NAV_HEIGHT}px);\n    border-radius: ${theme.gridUnit}px;\n    background-color: ${theme.colors.grayscale.light5};\n    margin-left: auto;\n    margin-right: auto;\n    padding-left: ${theme.gridUnit * 4}px;\n    padding-right: ${theme.gridUnit * 4}px;\n    padding-bottom: ${theme.gridUnit * 4}px;\n\n    h3 {\n      padding-bottom: ${theme.gridUnit * 3}px;\n    }\n\n    & .dataset {\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n      margin-bottom: ${theme.gridUnit * 5}px;\n\n      & > div {\n        min-width: 200px;\n        width: 300px;\n      }\n\n      & > span {\n        color: ${theme.colors.grayscale.light1};\n        margin-left: ${theme.gridUnit * 4}px;\n      }\n    }\n\n    & .viz-gallery {\n      border: 1px solid ${theme.colors.grayscale.light2};\n      border-radius: ${theme.gridUnit}px;\n      margin: ${theme.gridUnit}px 0px;\n      max-height: calc(100vh - ${ELEMENTS_EXCEPT_VIZ_GALLERY}px);\n      flex: 1;\n    }\n\n    & .footer {\n      flex: 1;\n      display: flex;\n      flex-direction: row;\n      justify-content: flex-end;\n      align-items: center;\n\n      & > span {\n        color: ${theme.colors.grayscale.light1};\n        margin-right: ${theme.gridUnit * 4}px;\n      }\n    }\n\n    /* The following extra ampersands (&&&&) are used to boost selector specificity */\n\n    &&&& .antd5-steps-item-tail {\n      display: none;\n    }\n\n    &&&& .antd5-steps-item-icon {\n      margin-right: ${theme.gridUnit * 2}px;\n      width: ${theme.gridUnit * 5}px;\n      height: ${theme.gridUnit * 5}px;\n      line-height: ${theme.gridUnit * 5}px;\n    }\n\n    &&&& .antd5-steps-item-title {\n      line-height: ${theme.gridUnit * 5}px;\n    }\n\n    &&&& .antd5-steps-item-content {\n      overflow: unset;\n\n      .antd5-steps-item-description {\n        margin-top: ${theme.gridUnit}px;\n        padding-bottom: ${theme.gridUnit}px;\n      }\n    }\n\n    &&&& .antd5-tooltip-open {\n      display: inline;\n    }\n\n    &&&& .ant-select-selector {\n      padding: 0;\n    }\n\n    &&&& .ant-select-selection-placeholder {\n      padding-left: ${theme.gridUnit * 3}px;\n    }\n\n    &&&& .ant-select-selection-item {\n      padding-left: ${theme.gridUnit * 3}px;\n    }\n  `}\n`;\nconst StyledStepTitle = styled.span`\n  ${({ theme: { typography: { sizes, weights } } }) => `\n      font-size: ${sizes.m}px;\n      font-weight: ${weights.bold};\n    `}\n`;\nconst StyledStepDescription = styled.div`\n  ${({ theme: { gridUnit } }) => `\n    margin-top: ${gridUnit * 4}px;\n    margin-bottom: ${gridUnit * 3}px;\n  `}\n`;\nexport class ChartCreation extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      vizType: null,\n      canCreateDataset: findPermission('can_write', 'Dataset', props.user.roles)\n    };\n    this.changeDatasource = this.changeDatasource.bind(this);\n    this.changeVizType = this.changeVizType.bind(this);\n    this.gotoSlice = this.gotoSlice.bind(this);\n    this.loadDatasources = this.loadDatasources.bind(this);\n    this.onVizTypeDoubleClick = this.onVizTypeDoubleClick.bind(this);\n  }\n  componentDidMount() {var _querystring$parse;\n    const params = (_querystring$parse = querystring.parse(window.location.search)) == null ? void 0 : _querystring$parse.dataset;\n    if (params) {\n      this.loadDatasources(params, 0, 1).then((r) => {\n        const datasource = r.data[0];\n        // override here to force styling of option label\n        // which expects a reactnode instead of string\n        // @ts-expect-error\n        datasource.label = datasource.customLabel;\n        this.setState({ datasource });\n      });\n      this.props.addSuccessToast(t('The dataset has been saved'));\n    }\n  }\n  exploreUrl() {var _this$state$datasourc;\n    const dashboardId = getUrlParam(URL_PARAMS.dashboardId);\n    let url = `/explore/?viz_type=${this.state.vizType}&datasource=${(_this$state$datasourc = this.state.datasource) == null ? void 0 : _this$state$datasourc.value}`;\n    if (isDefined(dashboardId)) {\n      url += `&dashboard_id=${dashboardId}`;\n    }\n    return url;\n  }\n  gotoSlice() {\n    this.props.history.push(this.exploreUrl());\n  }\n  changeDatasource(datasource) {\n    this.setState({ datasource });\n  }\n  changeVizType(vizType) {\n    this.setState({ vizType });\n  }\n  isBtnDisabled() {var _this$state$datasourc2;\n    return !((_this$state$datasourc2 = this.state.datasource) != null && _this$state$datasourc2.value && this.state.vizType);\n  }\n  onVizTypeDoubleClick() {\n    if (!this.isBtnDisabled()) {\n      this.gotoSlice();\n    }\n  }\n  loadDatasources(search, page, pageSize) {\n    const query = rison.encode({\n      columns: [\n      'id',\n      'table_name',\n      'datasource_type',\n      'database.database_name',\n      'schema'],\n\n      filters: [{ col: 'table_name', opr: 'ct', value: search }],\n      page,\n      page_size: pageSize,\n      order_column: 'table_name',\n      order_direction: 'asc'\n    });\n    return SupersetClient.get({\n      endpoint: `/api/v1/dataset/?q=${query}`\n    }).then((response) => {\n      const list = response.json.result.map((item) => ({\n        id: item.id,\n        value: `${item.id}__${item.datasource_type}`,\n        customLabel: DatasetSelectLabel(item),\n        label: item.table_name\n      }));\n      return {\n        data: list,\n        totalCount: response.json.count\n      };\n    });\n  }\n  render() {var _this$state$datasourc3;\n    const { theme } = this.props;\n    const isButtonDisabled = this.isBtnDisabled();\n    const VIEW_INSTRUCTIONS_TEXT = t('view instructions');\n    const datasetHelpText = this.state.canCreateDataset ? _jsxs(\"span\", { \"data-test\": \"dataset-write\", children: [\n      _jsx(Link, { to: \"/dataset/add/\", \"data-test\": \"add-chart-new-dataset\", children:\n        t('Add a dataset') }\n      ),\n      t('or'), ' ',\n      _jsxs(\"a\", { href: \"https://superset.apache.org/docs/creating-charts-dashboards/creating-your-first-dashboard/#registering-a-new-table\", rel: \"noopener noreferrer\", target: \"_blank\", \"data-test\": \"add-chart-new-dataset-instructions\", children: [\n        `${VIEW_INSTRUCTIONS_TEXT} `,\n        _jsx(Icons.Full, { iconSize: \"m\", iconColor: theme.colors.primary.dark1 })] }\n      ), \".\"] }\n\n    ) : _jsxs(\"span\", { \"data-test\": \"no-dataset-write\", children: [\n      _jsxs(\"a\", { href: \"https://superset.apache.org/docs/creating-charts-dashboards/creating-your-first-dashboard/#registering-a-new-table\", rel: \"noopener noreferrer\", target: \"_blank\", children: [\n        `${VIEW_INSTRUCTIONS_TEXT} `,\n        _jsx(Icons.Full, { iconSize: \"m\", iconColor: theme.colors.primary.dark1 })] }\n      ), \".\"] }\n\n    );\n    return _jsxs(StyledContainer, { children: [\n      _jsx(\"h3\", { children: t('Create a new chart') }),\n      _jsxs(Steps, { direction: \"vertical\", size: \"small\", children: [\n        _jsx(Steps.Step, { title: _jsx(StyledStepTitle, { children: t('Choose a dataset') }), status: (_this$state$datasourc3 = this.state.datasource) != null && _this$state$datasourc3.value ? 'finish' : 'process', description: _jsxs(StyledStepDescription, { className: \"dataset\", children: [\n            _jsx(AsyncSelect, { autoFocus: true, ariaLabel: t('Dataset'), name: \"select-datasource\", onChange: this.changeDatasource, options: this.loadDatasources, optionFilterProps: ['id', 'label'], placeholder: t('Choose a dataset'), showSearch: true, value: this.state.datasource }),\n            datasetHelpText] }\n          ) }),\n        _jsx(Steps.Step, { title: _jsx(StyledStepTitle, { children: t('Choose chart type') }), status: this.state.vizType ? 'finish' : 'process', description: _jsx(StyledStepDescription, { children:\n            _jsx(VizTypeGallery, { denyList: denyList, className: \"viz-gallery\", onChange: this.changeVizType, onDoubleClick: this.onVizTypeDoubleClick, selectedViz: this.state.vizType }) }\n          ) })] }\n      ),\n      _jsxs(\"div\", { className: \"footer\", children: [\n        isButtonDisabled && _jsx(\"span\", { children:\n          t('Please select both a Dataset and a Chart type to proceed') }\n        ),\n        _jsx(Button, { buttonStyle: \"primary\", disabled: isButtonDisabled, onClick: this.gotoSlice, children:\n          t('Create new chart') }\n        )] }\n      )] }\n    );\n  } // @ts-ignore\n  __reactstandin__regenerateByEval(key, code) {// @ts-ignore\n    this[key] = eval(code);}}const _default = withRouter(withToasts(withTheme(ChartCreation)));export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(ESTIMATED_NAV_HEIGHT, \"ESTIMATED_NAV_HEIGHT\", \"/Users/aryurkov/superset/superset-frontend/src/pages/ChartCreation/index.tsx\");reactHotLoader.register(ELEMENTS_EXCEPT_VIZ_GALLERY, \"ELEMENTS_EXCEPT_VIZ_GALLERY\", \"/Users/aryurkov/superset/superset-frontend/src/pages/ChartCreation/index.tsx\");reactHotLoader.register(bootstrapData, \"bootstrapData\", \"/Users/aryurkov/superset/superset-frontend/src/pages/ChartCreation/index.tsx\");reactHotLoader.register(denyList, \"denyList\", \"/Users/aryurkov/superset/superset-frontend/src/pages/ChartCreation/index.tsx\");reactHotLoader.register(StyledContainer, \"StyledContainer\", \"/Users/aryurkov/superset/superset-frontend/src/pages/ChartCreation/index.tsx\");reactHotLoader.register(StyledStepTitle, \"StyledStepTitle\", \"/Users/aryurkov/superset/superset-frontend/src/pages/ChartCreation/index.tsx\");reactHotLoader.register(StyledStepDescription, \"StyledStepDescription\", \"/Users/aryurkov/superset/superset-frontend/src/pages/ChartCreation/index.tsx\");reactHotLoader.register(ChartCreation, \"ChartCreation\", \"/Users/aryurkov/superset/superset-frontend/src/pages/ChartCreation/index.tsx\");reactHotLoader.register(_default, \"default\", \"/Users/aryurkov/superset/superset-frontend/src/pages/ChartCreation/index.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["PureComponent","rison","querystring","isDefined","styled","SupersetClient","t","withTheme","getUrlParam","FilterPlugins","URL_PARAMS","Link","withRouter","Button","AsyncSelect","Steps","withToasts","VizTypeGallery","MAX_ADVISABLE_VIZ_GALLERY_WIDTH","findPermission","getBootstrapData","DatasetSelectLabel","Icons","jsx","_jsx","jsxs","_jsxs","ESTIMATED_NAV_HEIGHT","ELEMENTS_EXCEPT_VIZ_GALLERY","bootstrapData","denyList","common","conf","VIZ_TYPE_DENYLIST","concat","Object","values","StyledContainer","div","theme","gridUnit","colors","grayscale","light5","light1","light2","StyledStepTitle","span","typography","sizes","weights","m","bold","StyledStepDescription","ChartCreation","constructor","props","state","vizType","canCreateDataset","user","roles","changeDatasource","bind","changeVizType","gotoSlice","loadDatasources","onVizTypeDoubleClick","componentDidMount","_querystring$parse","params","parse","window","location","search","dataset","then","r","datasource","data","label","customLabel","setState","addSuccessToast","exploreUrl","_this$state$datasourc","dashboardId","url","value","history","push","isBtnDisabled","_this$state$datasourc2","page","pageSize","query","encode","columns","filters","col","opr","page_size","order_column","order_direction","get","endpoint","response","list","json","result","map","item","id","datasource_type","table_name","totalCount","count","render","_this$state$datasourc3","isButtonDisabled","VIEW_INSTRUCTIONS_TEXT","datasetHelpText","children","to","href","rel","target","Full","iconSize","iconColor","primary","dark1","direction","size","Step","title","status","description","className","autoFocus","ariaLabel","name","onChange","options","optionFilterProps","placeholder","showSearch","onDoubleClick","selectedViz","buttonStyle","disabled","onClick","__reactstandin__regenerateByEval","key","code","eval","_default","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/Users/aryurkov/superset/superset-frontend/src/pages/ChartCreation/index.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { PureComponent, ReactNode } from 'react';\nimport rison from 'rison';\nimport querystring from 'query-string';\nimport {\n  isDefined,\n  JsonResponse,\n  styled,\n  SupersetClient,\n  t,\n} from '@superset-ui/core';\nimport { withTheme, Theme } from '@emotion/react';\nimport { getUrlParam } from 'src/utils/urlUtils';\nimport { FilterPlugins, URL_PARAMS } from 'src/constants';\nimport { Link, withRouter, RouteComponentProps } from 'react-router-dom';\nimport Button from 'src/components/Button';\nimport { AsyncSelect } from 'src/components';\nimport { Steps } from 'src/components/Steps';\nimport withToasts from 'src/components/MessageToasts/withToasts';\n\nimport VizTypeGallery, {\n  MAX_ADVISABLE_VIZ_GALLERY_WIDTH,\n} from 'src/explore/components/controls/VizTypeControl/VizTypeGallery';\nimport { findPermission } from 'src/utils/findPermission';\nimport { UserWithPermissionsAndRoles } from 'src/types/bootstrapTypes';\nimport getBootstrapData from 'src/utils/getBootstrapData';\nimport {\n  Dataset,\n  DatasetSelectLabel,\n} from 'src/features/datasets/DatasetSelectLabel';\nimport { Icons } from 'src/components/Icons';\n\nexport interface ChartCreationProps extends RouteComponentProps {\n  user: UserWithPermissionsAndRoles;\n  addSuccessToast: (arg: string) => void;\n  theme: Theme;\n}\n\nexport type ChartCreationState = {\n  datasource?: { label: string; value: string };\n  datasetName?: string | string[] | null;\n  vizType: string | null;\n  canCreateDataset: boolean;\n};\n\nconst ESTIMATED_NAV_HEIGHT = 56;\nconst ELEMENTS_EXCEPT_VIZ_GALLERY = ESTIMATED_NAV_HEIGHT + 250;\n\nconst bootstrapData = getBootstrapData();\nconst denyList: string[] = (\n  bootstrapData.common.conf.VIZ_TYPE_DENYLIST || []\n).concat(Object.values(FilterPlugins));\n\nconst StyledContainer = styled.div`\n  ${({ theme }) => `\n    flex: 1 1 auto;\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n    width: 100%;\n    max-width: ${MAX_ADVISABLE_VIZ_GALLERY_WIDTH}px;\n    max-height: calc(100vh - ${ESTIMATED_NAV_HEIGHT}px);\n    border-radius: ${theme.gridUnit}px;\n    background-color: ${theme.colors.grayscale.light5};\n    margin-left: auto;\n    margin-right: auto;\n    padding-left: ${theme.gridUnit * 4}px;\n    padding-right: ${theme.gridUnit * 4}px;\n    padding-bottom: ${theme.gridUnit * 4}px;\n\n    h3 {\n      padding-bottom: ${theme.gridUnit * 3}px;\n    }\n\n    & .dataset {\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n      margin-bottom: ${theme.gridUnit * 5}px;\n\n      & > div {\n        min-width: 200px;\n        width: 300px;\n      }\n\n      & > span {\n        color: ${theme.colors.grayscale.light1};\n        margin-left: ${theme.gridUnit * 4}px;\n      }\n    }\n\n    & .viz-gallery {\n      border: 1px solid ${theme.colors.grayscale.light2};\n      border-radius: ${theme.gridUnit}px;\n      margin: ${theme.gridUnit}px 0px;\n      max-height: calc(100vh - ${ELEMENTS_EXCEPT_VIZ_GALLERY}px);\n      flex: 1;\n    }\n\n    & .footer {\n      flex: 1;\n      display: flex;\n      flex-direction: row;\n      justify-content: flex-end;\n      align-items: center;\n\n      & > span {\n        color: ${theme.colors.grayscale.light1};\n        margin-right: ${theme.gridUnit * 4}px;\n      }\n    }\n\n    /* The following extra ampersands (&&&&) are used to boost selector specificity */\n\n    &&&& .antd5-steps-item-tail {\n      display: none;\n    }\n\n    &&&& .antd5-steps-item-icon {\n      margin-right: ${theme.gridUnit * 2}px;\n      width: ${theme.gridUnit * 5}px;\n      height: ${theme.gridUnit * 5}px;\n      line-height: ${theme.gridUnit * 5}px;\n    }\n\n    &&&& .antd5-steps-item-title {\n      line-height: ${theme.gridUnit * 5}px;\n    }\n\n    &&&& .antd5-steps-item-content {\n      overflow: unset;\n\n      .antd5-steps-item-description {\n        margin-top: ${theme.gridUnit}px;\n        padding-bottom: ${theme.gridUnit}px;\n      }\n    }\n\n    &&&& .antd5-tooltip-open {\n      display: inline;\n    }\n\n    &&&& .ant-select-selector {\n      padding: 0;\n    }\n\n    &&&& .ant-select-selection-placeholder {\n      padding-left: ${theme.gridUnit * 3}px;\n    }\n\n    &&&& .ant-select-selection-item {\n      padding-left: ${theme.gridUnit * 3}px;\n    }\n  `}\n`;\n\nconst StyledStepTitle = styled.span`\n  ${({\n    theme: {\n      typography: { sizes, weights },\n    },\n  }) => `\n      font-size: ${sizes.m}px;\n      font-weight: ${weights.bold};\n    `}\n`;\n\nconst StyledStepDescription = styled.div`\n  ${({ theme: { gridUnit } }) => `\n    margin-top: ${gridUnit * 4}px;\n    margin-bottom: ${gridUnit * 3}px;\n  `}\n`;\n\nexport class ChartCreation extends PureComponent<\n  ChartCreationProps,\n  ChartCreationState\n> {\n  constructor(props: ChartCreationProps) {\n    super(props);\n    this.state = {\n      vizType: null,\n      canCreateDataset: findPermission(\n        'can_write',\n        'Dataset',\n        props.user.roles,\n      ),\n    };\n\n    this.changeDatasource = this.changeDatasource.bind(this);\n    this.changeVizType = this.changeVizType.bind(this);\n    this.gotoSlice = this.gotoSlice.bind(this);\n    this.loadDatasources = this.loadDatasources.bind(this);\n    this.onVizTypeDoubleClick = this.onVizTypeDoubleClick.bind(this);\n  }\n\n  componentDidMount() {\n    const params = querystring.parse(window.location.search)?.dataset as string;\n    if (params) {\n      this.loadDatasources(params, 0, 1).then(r => {\n        const datasource = r.data[0];\n        // override here to force styling of option label\n        // which expects a reactnode instead of string\n        // @ts-expect-error\n        datasource.label = datasource.customLabel;\n        this.setState({ datasource });\n      });\n      this.props.addSuccessToast(t('The dataset has been saved'));\n    }\n  }\n\n  exploreUrl() {\n    const dashboardId = getUrlParam(URL_PARAMS.dashboardId);\n    let url = `/explore/?viz_type=${this.state.vizType}&datasource=${this.state.datasource?.value}`;\n    if (isDefined(dashboardId)) {\n      url += `&dashboard_id=${dashboardId}`;\n    }\n    return url;\n  }\n\n  gotoSlice() {\n    this.props.history.push(this.exploreUrl());\n  }\n\n  changeDatasource(datasource: { label: string; value: string }) {\n    this.setState({ datasource });\n  }\n\n  changeVizType(vizType: string | null) {\n    this.setState({ vizType });\n  }\n\n  isBtnDisabled() {\n    return !(this.state.datasource?.value && this.state.vizType);\n  }\n\n  onVizTypeDoubleClick() {\n    if (!this.isBtnDisabled()) {\n      this.gotoSlice();\n    }\n  }\n\n  loadDatasources(search: string, page: number, pageSize: number) {\n    const query = rison.encode({\n      columns: [\n        'id',\n        'table_name',\n        'datasource_type',\n        'database.database_name',\n        'schema',\n      ],\n      filters: [{ col: 'table_name', opr: 'ct', value: search }],\n      page,\n      page_size: pageSize,\n      order_column: 'table_name',\n      order_direction: 'asc',\n    });\n    return SupersetClient.get({\n      endpoint: `/api/v1/dataset/?q=${query}`,\n    }).then((response: JsonResponse) => {\n      const list: {\n        customLabel: ReactNode;\n        id: number;\n        label: string;\n        value: string;\n      }[] = response.json.result.map((item: Dataset) => ({\n        id: item.id,\n        value: `${item.id}__${item.datasource_type}`,\n        customLabel: DatasetSelectLabel(item),\n        label: item.table_name,\n      }));\n      return {\n        data: list,\n        totalCount: response.json.count,\n      };\n    });\n  }\n\n  render() {\n    const { theme } = this.props;\n    const isButtonDisabled = this.isBtnDisabled();\n    const VIEW_INSTRUCTIONS_TEXT = t('view instructions');\n    const datasetHelpText = this.state.canCreateDataset ? (\n      <span data-test=\"dataset-write\">\n        <Link to=\"/dataset/add/\" data-test=\"add-chart-new-dataset\">\n          {t('Add a dataset')}\n        </Link>\n        {t('or')}{' '}\n        <a\n          href=\"https://superset.apache.org/docs/creating-charts-dashboards/creating-your-first-dashboard/#registering-a-new-table\"\n          rel=\"noopener noreferrer\"\n          target=\"_blank\"\n          data-test=\"add-chart-new-dataset-instructions\"\n        >\n          {`${VIEW_INSTRUCTIONS_TEXT} `}\n          <Icons.Full iconSize=\"m\" iconColor={theme.colors.primary.dark1} />\n        </a>\n        .\n      </span>\n    ) : (\n      <span data-test=\"no-dataset-write\">\n        <a\n          href=\"https://superset.apache.org/docs/creating-charts-dashboards/creating-your-first-dashboard/#registering-a-new-table\"\n          rel=\"noopener noreferrer\"\n          target=\"_blank\"\n        >\n          {`${VIEW_INSTRUCTIONS_TEXT} `}\n          <Icons.Full iconSize=\"m\" iconColor={theme.colors.primary.dark1} />\n        </a>\n        .\n      </span>\n    );\n\n    return (\n      <StyledContainer>\n        <h3>{t('Create a new chart')}</h3>\n        <Steps direction=\"vertical\" size=\"small\">\n          <Steps.Step\n            title={<StyledStepTitle>{t('Choose a dataset')}</StyledStepTitle>}\n            status={this.state.datasource?.value ? 'finish' : 'process'}\n            description={\n              <StyledStepDescription className=\"dataset\">\n                <AsyncSelect\n                  autoFocus\n                  ariaLabel={t('Dataset')}\n                  name=\"select-datasource\"\n                  onChange={this.changeDatasource}\n                  options={this.loadDatasources}\n                  optionFilterProps={['id', 'label']}\n                  placeholder={t('Choose a dataset')}\n                  showSearch\n                  value={this.state.datasource}\n                />\n                {datasetHelpText}\n              </StyledStepDescription>\n            }\n          />\n          <Steps.Step\n            title={<StyledStepTitle>{t('Choose chart type')}</StyledStepTitle>}\n            status={this.state.vizType ? 'finish' : 'process'}\n            description={\n              <StyledStepDescription>\n                <VizTypeGallery\n                  denyList={denyList}\n                  className=\"viz-gallery\"\n                  onChange={this.changeVizType}\n                  onDoubleClick={this.onVizTypeDoubleClick}\n                  selectedViz={this.state.vizType}\n                />\n              </StyledStepDescription>\n            }\n          />\n        </Steps>\n        <div className=\"footer\">\n          {isButtonDisabled && (\n            <span>\n              {t('Please select both a Dataset and a Chart type to proceed')}\n            </span>\n          )}\n          <Button\n            buttonStyle=\"primary\"\n            disabled={isButtonDisabled}\n            onClick={this.gotoSlice}\n          >\n            {t('Create new chart')}\n          </Button>\n        </div>\n      </StyledContainer>\n    );\n  }\n}\n\nexport default withRouter(withToasts(withTheme(ChartCreation)));\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}