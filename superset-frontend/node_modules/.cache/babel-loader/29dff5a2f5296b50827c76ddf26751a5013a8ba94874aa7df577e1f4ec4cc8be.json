{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useState, useLayoutEffect } from 'react';\nimport { css, styled, SafeMarkdown } from '@superset-ui/core';\nimport InfoTooltipWithTrigger from './InfoTooltipWithTrigger';\nimport { ColumnTypeLabel } from './ColumnTypeLabel/ColumnTypeLabel';\nimport CertifiedIconWithTooltip from './CertifiedIconWithTooltip';\nimport Tooltip from './Tooltip';\nimport { getMetricTooltipNode } from './labelUtils';\nimport { SQLPopover } from './SQLPopover';import { jsx as _jsx, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nconst FlexRowContainer = styled.div`\n  align-items: center;\n  display: flex;\n\n  > svg {\n    margin-right: ${({ theme }) => theme.gridUnit}px;\n  }\n`;\nexport function MetricOption({ metric, labelRef, openInNewWindow = false, showFormula = true, showType = false, shouldShowTooltip = true, url = '' }) {\n  const verbose = metric.verbose_name || metric.metric_name || metric.label;\n  const link = url ? _jsx(\"a\", { href: url, target: openInNewWindow ? '_blank' : '', rel: \"noreferrer\", children:\n    verbose }\n  ) : verbose;\n  const label = _jsx(\"span\", { className: \"option-label metric-option-label\", css: (theme) => css`\n        margin-right: ${theme.gridUnit}px;\n      `, ref: labelRef, children:\n    link }\n  );\n  const warningMarkdown = metric.warning_markdown || metric.warning_text || metric.error_text;\n  const [tooltipText, setTooltipText] = useState(metric.metric_name);\n  useLayoutEffect(() => {\n    setTooltipText(getMetricTooltipNode(metric, labelRef));\n  }, [labelRef, metric]);\n  return _jsxs(FlexRowContainer, { className: \"metric-option\", children: [\n    showType && _jsx(ColumnTypeLabel, { type: \"expression\" }),\n    shouldShowTooltip ? _jsx(Tooltip, { id: \"metric-name-tooltip\", title: tooltipText, children:\n      label }\n    ) : label,\n    showFormula && metric.expression && _jsx(SQLPopover, { sqlExpression: metric.expression }),\n    metric.is_certified && _jsx(CertifiedIconWithTooltip, { metricName: metric.metric_name, certifiedBy: metric.certified_by, details: metric.certification_details }),\n    warningMarkdown && _jsx(InfoTooltipWithTrigger, { className: \"text-warning\", icon: \"warning\", tooltip: _jsx(SafeMarkdown, { source: warningMarkdown }), label: `warn-${metric.metric_name}`, iconsStyle: { marginLeft: 0 }, ...(metric.error_text && {\n        className: 'text-danger',\n        icon: 'exclamation-circle'\n      }) })] }\n  );\n}__signature__(MetricOption, \"useState{[tooltipText, setTooltipText](metric.metric_name)}\\nuseLayoutEffect{}\");;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(FlexRowContainer, \"FlexRowContainer\", \"/Users/aryurkov/superset/superset-frontend/packages/superset-ui-chart-controls/src/components/MetricOption.tsx\");reactHotLoader.register(MetricOption, \"MetricOption\", \"/Users/aryurkov/superset/superset-frontend/packages/superset-ui-chart-controls/src/components/MetricOption.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["useState","useLayoutEffect","css","styled","SafeMarkdown","InfoTooltipWithTrigger","ColumnTypeLabel","CertifiedIconWithTooltip","Tooltip","getMetricTooltipNode","SQLPopover","jsx","_jsx","jsxs","_jsxs","FlexRowContainer","div","theme","gridUnit","MetricOption","metric","labelRef","openInNewWindow","showFormula","showType","shouldShowTooltip","url","verbose","verbose_name","metric_name","label","link","href","target","rel","children","className","ref","warningMarkdown","warning_markdown","warning_text","error_text","tooltipText","setTooltipText","type","id","title","expression","sqlExpression","is_certified","metricName","certifiedBy","certified_by","details","certification_details","icon","tooltip","source","iconsStyle","marginLeft","__signature__","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/Users/aryurkov/superset/superset-frontend/packages/superset-ui-chart-controls/src/components/MetricOption.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useState, ReactNode, useLayoutEffect, RefObject } from 'react';\n\nimport {\n  css,\n  styled,\n  Metric,\n  SafeMarkdown,\n  SupersetTheme,\n} from '@superset-ui/core';\nimport InfoTooltipWithTrigger from './InfoTooltipWithTrigger';\nimport { ColumnTypeLabel } from './ColumnTypeLabel/ColumnTypeLabel';\nimport CertifiedIconWithTooltip from './CertifiedIconWithTooltip';\nimport Tooltip from './Tooltip';\nimport { getMetricTooltipNode } from './labelUtils';\nimport { SQLPopover } from './SQLPopover';\n\nconst FlexRowContainer = styled.div`\n  align-items: center;\n  display: flex;\n\n  > svg {\n    margin-right: ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nexport interface MetricOptionProps {\n  metric: Omit<Metric, 'id' | 'uuid'> & { label?: string };\n  openInNewWindow?: boolean;\n  showFormula?: boolean;\n  showType?: boolean;\n  url?: string;\n  labelRef?: RefObject<any>;\n  shouldShowTooltip?: boolean;\n}\n\nexport function MetricOption({\n  metric,\n  labelRef,\n  openInNewWindow = false,\n  showFormula = true,\n  showType = false,\n  shouldShowTooltip = true,\n  url = '',\n}: MetricOptionProps) {\n  const verbose = metric.verbose_name || metric.metric_name || metric.label;\n  const link = url ? (\n    <a href={url} target={openInNewWindow ? '_blank' : ''} rel=\"noreferrer\">\n      {verbose}\n    </a>\n  ) : (\n    verbose\n  );\n\n  const label = (\n    <span\n      className=\"option-label metric-option-label\"\n      css={(theme: SupersetTheme) => css`\n        margin-right: ${theme.gridUnit}px;\n      `}\n      ref={labelRef}\n    >\n      {link}\n    </span>\n  );\n\n  const warningMarkdown =\n    metric.warning_markdown || metric.warning_text || metric.error_text;\n\n  const [tooltipText, setTooltipText] = useState<ReactNode>(metric.metric_name);\n\n  useLayoutEffect(() => {\n    setTooltipText(getMetricTooltipNode(metric, labelRef));\n  }, [labelRef, metric]);\n\n  return (\n    <FlexRowContainer className=\"metric-option\">\n      {showType && <ColumnTypeLabel type=\"expression\" />}\n      {shouldShowTooltip ? (\n        <Tooltip id=\"metric-name-tooltip\" title={tooltipText}>\n          {label}\n        </Tooltip>\n      ) : (\n        label\n      )}\n      {showFormula && metric.expression && (\n        <SQLPopover sqlExpression={metric.expression} />\n      )}\n      {metric.is_certified && (\n        <CertifiedIconWithTooltip\n          metricName={metric.metric_name}\n          certifiedBy={metric.certified_by}\n          details={metric.certification_details}\n        />\n      )}\n      {warningMarkdown && (\n        <InfoTooltipWithTrigger\n          className=\"text-warning\"\n          icon=\"warning\"\n          tooltip={<SafeMarkdown source={warningMarkdown} />}\n          label={`warn-${metric.metric_name}`}\n          iconsStyle={{ marginLeft: 0 }}\n          {...(metric.error_text && {\n            className: 'text-danger',\n            icon: 'exclamation-circle',\n          })}\n        />\n      )}\n    </FlexRowContainer>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}