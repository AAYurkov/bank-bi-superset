{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport Modal from 'src/components/Modal';\nimport Button from 'src/components/Button';\nimport { Form } from 'src/components/Form';\nimport { useState, useCallback } from 'react';\nimport { t } from '@superset-ui/core';import { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nfunction FormModal({ show, onHide, title, onSave, children, initialValues = {}, formSubmitHandler, bodyStyle = {}, requiredFields = [] }) {\n  const [form] = Form.useForm();\n  const [isSaving, setIsSaving] = useState(false);\n  const resetForm = useCallback(() => {\n    form.resetFields();\n    setIsSaving(false);\n  }, [form]);\n  const [submitDisabled, setSubmitDisabled] = useState(true);\n  const handleClose = useCallback(() => {\n    resetForm();\n    onHide();\n  }, [onHide, resetForm]);\n  const handleSave = useCallback(() => {\n    resetForm();\n    onSave();\n  }, [onSave, resetForm]);\n  const handleFormSubmit = useCallback(async (values) => {\n    try {\n      setIsSaving(true);\n      await formSubmitHandler(values);\n      handleSave();\n    }\n    catch (err) {\n      console.error(err);\n    } finally\n    {\n      setIsSaving(false);\n    }\n  }, [formSubmitHandler, handleSave]);\n  const onFormChange = () => {\n    const hasErrors = form.getFieldsError().some(({ errors }) => errors.length);\n    const values = form.getFieldsValue();\n    const hasEmptyRequired = requiredFields.some((field) => !values[field]);\n    setSubmitDisabled(hasErrors || hasEmptyRequired);\n  };\n  return _jsx(Modal, { show: show, title: title, onHide: handleClose, bodyStyle: bodyStyle, footer: _jsxs(_Fragment, { children: [\n      _jsx(Button, { buttonStyle: \"secondary\", \"data-test\": \"modal-cancel-button\", onClick: handleClose, children:\n        t('Cancel') }\n      ),\n      _jsx(Button, { buttonStyle: \"primary\", htmlType: \"submit\", onClick: () => form.submit(), \"data-test\": \"form-modal-save-button\", disabled: isSaving || submitDisabled, children:\n        isSaving ? t('Saving...') : t('Save') }\n      )] }\n    ), children:\n    _jsx(Form, { form: form, layout: \"vertical\", onFinish: handleFormSubmit, initialValues: initialValues, onValuesChange: onFormChange, onFieldsChange: onFormChange, children:\n      typeof children === 'function' ? children(form) : children }\n    ) }\n  );\n}__signature__(FormModal, \"useForm{[form]}\\nuseState{[isSaving, setIsSaving](false)}\\nuseCallback{resetForm}\\nuseState{[submitDisabled, setSubmitDisabled](true)}\\nuseCallback{handleClose}\\nuseCallback{handleSave}\\nuseCallback{handleFormSubmit}\");const _default =\nFormModal;export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(FormModal, \"FormModal\", \"/Users/aryurkov/superset/superset-frontend/src/components/Modal/FormModal.tsx\");reactHotLoader.register(_default, \"default\", \"/Users/aryurkov/superset/superset-frontend/src/components/Modal/FormModal.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["Modal","Button","Form","useState","useCallback","t","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","FormModal","show","onHide","title","onSave","children","initialValues","formSubmitHandler","bodyStyle","requiredFields","form","useForm","isSaving","setIsSaving","resetForm","resetFields","submitDisabled","setSubmitDisabled","handleClose","handleSave","handleFormSubmit","values","err","console","error","onFormChange","hasErrors","getFieldsError","some","errors","length","getFieldsValue","hasEmptyRequired","field","footer","buttonStyle","onClick","htmlType","submit","disabled","layout","onFinish","onValuesChange","onFieldsChange","__signature__","_default","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/Users/aryurkov/superset/superset-frontend/src/components/Modal/FormModal.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport Modal, { ModalProps } from 'src/components/Modal';\nimport Button from 'src/components/Button';\nimport { Form } from 'src/components/Form';\nimport { useState, useCallback } from 'react';\nimport { t } from '@superset-ui/core';\n\nexport interface FormModalProps extends ModalProps {\n  initialValues: Object;\n  formSubmitHandler: (values: Object) => Promise<void>;\n  onSave: () => void;\n  requiredFields: string[];\n}\n\nfunction FormModal({\n  show,\n  onHide,\n  title,\n  onSave,\n  children,\n  initialValues = {},\n  formSubmitHandler,\n  bodyStyle = {},\n  requiredFields = [],\n}: FormModalProps) {\n  const [form] = Form.useForm();\n  const [isSaving, setIsSaving] = useState(false);\n  const resetForm = useCallback(() => {\n    form.resetFields();\n    setIsSaving(false);\n  }, [form]);\n  const [submitDisabled, setSubmitDisabled] = useState(true);\n\n  const handleClose = useCallback(() => {\n    resetForm();\n    onHide();\n  }, [onHide, resetForm]);\n\n  const handleSave = useCallback(() => {\n    resetForm();\n    onSave();\n  }, [onSave, resetForm]);\n\n  const handleFormSubmit = useCallback(\n    async values => {\n      try {\n        setIsSaving(true);\n        await formSubmitHandler(values);\n        handleSave();\n      } catch (err) {\n        console.error(err);\n      } finally {\n        setIsSaving(false);\n      }\n    },\n    [formSubmitHandler, handleSave],\n  );\n\n  const onFormChange = () => {\n    const hasErrors = form.getFieldsError().some(({ errors }) => errors.length);\n\n    const values = form.getFieldsValue();\n    const hasEmptyRequired = requiredFields.some(field => !values[field]);\n\n    setSubmitDisabled(hasErrors || hasEmptyRequired);\n  };\n\n  return (\n    <Modal\n      show={show}\n      title={title}\n      onHide={handleClose}\n      bodyStyle={bodyStyle}\n      footer={\n        <>\n          <Button\n            buttonStyle=\"secondary\"\n            data-test=\"modal-cancel-button\"\n            onClick={handleClose}\n          >\n            {t('Cancel')}\n          </Button>\n          <Button\n            buttonStyle=\"primary\"\n            htmlType=\"submit\"\n            onClick={() => form.submit()}\n            data-test=\"form-modal-save-button\"\n            disabled={isSaving || submitDisabled}\n          >\n            {isSaving ? t('Saving...') : t('Save')}\n          </Button>\n        </>\n      }\n    >\n      <Form\n        form={form}\n        layout=\"vertical\"\n        onFinish={handleFormSubmit}\n        initialValues={initialValues}\n        onValuesChange={onFormChange}\n        onFieldsChange={onFormChange}\n      >\n        {typeof children === 'function' ? children(form) : children}\n      </Form>\n    </Modal>\n  );\n}\n\nexport default FormModal;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}