{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, useTheme, getClientErrorObject, SupersetClient, css } from '@superset-ui/core';\nimport Button from 'src/components/Button';\nimport { Icons } from 'src/components/Icons';\nimport withToasts from 'src/components/MessageToasts/withToasts';\nimport CopyToClipboard from 'src/components/CopyToClipboard';\nimport useQueryEditor from 'src/SqlLab/hooks/useQueryEditor';\nimport { LOG_ACTIONS_SQLLAB_COPY_LINK } from 'src/logger/LogUtils';\nimport useLogAction from 'src/logger/useLogAction';import { jsx as _jsx, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nconst ShareSqlLabQuery = ({ queryEditorId, addDangerToast }) => {\n  const theme = useTheme();\n  const logAction = useLogAction({ queryEditorId });\n  const { dbId, name, schema, autorun, sql, templateParams } = useQueryEditor(queryEditorId, ['dbId', 'name', 'schema', 'autorun', 'sql', 'templateParams']);\n  const getCopyUrlForPermalink = (callback) => {\n    const sharedQuery = { dbId, name, schema, autorun, sql, templateParams };\n    return SupersetClient.post({\n      endpoint: '/api/v1/sqllab/permalink',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(sharedQuery)\n    }).\n    then(({ json }) => {\n      callback(json.url);\n    }).\n    catch((response) => {\n      getClientErrorObject(response).then(() => {\n        addDangerToast(t('There was an error with your request'));\n      });\n    });\n  };\n  const getCopyUrl = (callback) => {\n    logAction(LOG_ACTIONS_SQLLAB_COPY_LINK, {\n      shortcut: false\n    });\n    return getCopyUrlForPermalink(callback);\n  };\n  const buildButton = () => {\n    const tooltip = t('Copy query link to your clipboard');\n    return _jsxs(Button, { buttonSize: \"small\", tooltip: tooltip, css: css`\n          span > :first-of-type {\n            margin-right: 0;\n          }\n        `, children: [\n      _jsx(Icons.LinkOutlined, { iconColor: theme.colors.primary.base, iconSize: \"m\" }),\n      t('Copy link')] }\n    );\n  };\n  return _jsx(CopyToClipboard, { getText: getCopyUrl, wrapped: false, copyNode: buildButton() });\n};__signature__(ShareSqlLabQuery, \"useTheme{theme}\\nuseLogAction{logAction}\\nuseQueryEditor{{ dbId, name, schema, autorun, sql, templateParams }}\", () => [useTheme, useLogAction, useQueryEditor]);const _default =\nwithToasts(ShareSqlLabQuery);export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(ShareSqlLabQuery, \"ShareSqlLabQuery\", \"/Users/aryurkov/superset/superset-frontend/src/SqlLab/components/ShareSqlLabQuery/index.tsx\");reactHotLoader.register(_default, \"default\", \"/Users/aryurkov/superset/superset-frontend/src/SqlLab/components/ShareSqlLabQuery/index.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["t","useTheme","getClientErrorObject","SupersetClient","css","Button","Icons","withToasts","CopyToClipboard","useQueryEditor","LOG_ACTIONS_SQLLAB_COPY_LINK","useLogAction","jsx","_jsx","jsxs","_jsxs","ShareSqlLabQuery","queryEditorId","addDangerToast","theme","logAction","dbId","name","schema","autorun","sql","templateParams","getCopyUrlForPermalink","callback","sharedQuery","post","endpoint","headers","body","JSON","stringify","then","json","url","catch","response","getCopyUrl","shortcut","buildButton","tooltip","buttonSize","children","LinkOutlined","iconColor","colors","primary","base","iconSize","getText","wrapped","copyNode","__signature__","_default","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/Users/aryurkov/superset/superset-frontend/src/SqlLab/components/ShareSqlLabQuery/index.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  t,\n  useTheme,\n  getClientErrorObject,\n  SupersetClient,\n  css,\n} from '@superset-ui/core';\nimport Button from 'src/components/Button';\nimport { Icons } from 'src/components/Icons';\nimport withToasts from 'src/components/MessageToasts/withToasts';\nimport CopyToClipboard from 'src/components/CopyToClipboard';\nimport useQueryEditor from 'src/SqlLab/hooks/useQueryEditor';\nimport { LOG_ACTIONS_SQLLAB_COPY_LINK } from 'src/logger/LogUtils';\nimport useLogAction from 'src/logger/useLogAction';\n\ninterface ShareSqlLabQueryProps {\n  queryEditorId: string;\n  addDangerToast: (msg: string) => void;\n}\n\nconst ShareSqlLabQuery = ({\n  queryEditorId,\n  addDangerToast,\n}: ShareSqlLabQueryProps) => {\n  const theme = useTheme();\n  const logAction = useLogAction({ queryEditorId });\n  const { dbId, name, schema, autorun, sql, templateParams } = useQueryEditor(\n    queryEditorId,\n    ['dbId', 'name', 'schema', 'autorun', 'sql', 'templateParams'],\n  );\n\n  const getCopyUrlForPermalink = (callback: Function) => {\n    const sharedQuery = { dbId, name, schema, autorun, sql, templateParams };\n\n    return SupersetClient.post({\n      endpoint: '/api/v1/sqllab/permalink',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(sharedQuery),\n    })\n      .then(({ json }) => {\n        callback(json.url);\n      })\n      .catch(response => {\n        getClientErrorObject(response).then(() => {\n          addDangerToast(t('There was an error with your request'));\n        });\n      });\n  };\n\n  const getCopyUrl = (callback: Function) => {\n    logAction(LOG_ACTIONS_SQLLAB_COPY_LINK, {\n      shortcut: false,\n    });\n    return getCopyUrlForPermalink(callback);\n  };\n\n  const buildButton = () => {\n    const tooltip = t('Copy query link to your clipboard');\n    return (\n      <Button\n        buttonSize=\"small\"\n        tooltip={tooltip}\n        css={css`\n          span > :first-of-type {\n            margin-right: 0;\n          }\n        `}\n      >\n        <Icons.LinkOutlined\n          iconColor={theme.colors.primary.base}\n          iconSize=\"m\"\n        />\n        {t('Copy link')}\n      </Button>\n    );\n  };\n\n  return (\n    <CopyToClipboard\n      getText={getCopyUrl}\n      wrapped={false}\n      copyNode={buildButton()}\n    />\n  );\n};\n\nexport default withToasts(ShareSqlLabQuery);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}