{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { memo, Fragment, useEffect, useCallback, useMemo, useRef, useState } from 'react';\nimport { css, t, isNativeFilterWithDataMask } from '@superset-ui/core';\nimport { createHtmlPortalNode, InPortal, OutPortal } from 'react-reverse-portal';\nimport { useSelector } from 'react-redux';\nimport { useDashboardHasTabs, useSelectFiltersInScope } from 'src/dashboard/components/nativeFilters/state';\nimport { FilterBarOrientation } from 'src/dashboard/types';\nimport DropdownContainer from 'src/components/DropdownContainer';\nimport { Icons } from 'src/components/Icons';\nimport { useChartIds } from 'src/dashboard/util/charts/useChartIds';\nimport { useChartLayoutItems } from 'src/dashboard/util/useChartLayoutItems';\nimport { FiltersOutOfScopeCollapsible } from '../FiltersOutOfScopeCollapsible';\nimport { useFilterControlFactory } from '../useFilterControlFactory';\nimport { FiltersDropdownContent } from '../FiltersDropdownContent';\nimport crossFiltersSelector from '../CrossFilters/selectors';\nimport CrossFilter from '../CrossFilters/CrossFilter';\nimport { useFilterOutlined } from '../useFilterOutlined';\nimport { useChartsVerboseMaps } from '../utils';import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"@emotion/react/jsx-runtime\";\nconst FilterControls = ({ dataMaskSelected, onFilterSelectionChange }) => {\n  const filterBarOrientation = useSelector(({ dashboardInfo }) => dashboardInfo.filterBarOrientation);\n  const { outlinedFilterId, lastUpdated } = useFilterOutlined();\n  const [overflowedIds, setOverflowedIds] = useState([]);\n  const popoverRef = useRef(null);\n  const dataMask = useSelector((state) => state.dataMask);\n  const chartIds = useChartIds();\n  const chartLayoutItems = useChartLayoutItems();\n  const verboseMaps = useChartsVerboseMaps();\n  const selectedCrossFilters = useMemo(() => crossFiltersSelector({\n    dataMask,\n    chartIds,\n    chartLayoutItems,\n    verboseMaps\n  }), [chartIds, chartLayoutItems, dataMask, verboseMaps]);\n  const { filterControlFactory, filtersWithValues } = useFilterControlFactory(dataMaskSelected, onFilterSelectionChange);\n  const portalNodes = useMemo(() => {\n    const nodes = new Array(filtersWithValues.length);\n    for (let i = 0; i < filtersWithValues.length; i += 1) {\n      nodes[i] = createHtmlPortalNode();\n    }\n    return nodes;\n  }, [filtersWithValues.length]);\n  const filterIds = new Set(filtersWithValues.map((item) => item.id));\n  const [filtersInScope, filtersOutOfScope] = useSelectFiltersInScope(filtersWithValues);\n  const hasRequiredFirst = useMemo(() => filtersWithValues.some((filter) => filter.requiredFirst), [filtersWithValues]);\n  const dashboardHasTabs = useDashboardHasTabs();\n  const showCollapsePanel = dashboardHasTabs && filtersWithValues.length > 0;\n  const renderer = useCallback(({ id }, index) => {\n    const filterIndex = filtersWithValues.findIndex((f) => f.id === id);\n    const key = index != null ? index : id;\n    return (\n      // Empty text node is to ensure there's always an element preceding\n      // the OutPortal, otherwise react-reverse-portal crashes\n      _jsxs(Fragment, { children: [\n        '' /* eslint-disable-line react/jsx-curly-brace-presence */,\n        _jsx(OutPortal, { node: portalNodes[filterIndex], inView: true })] }, key\n      ));\n  }, [filtersWithValues, portalNodes]);\n  const renderVerticalContent = useCallback(() => _jsxs(_Fragment, { children: [\n    filtersInScope.map(renderer),\n    showCollapsePanel && _jsx(FiltersOutOfScopeCollapsible, { filtersOutOfScope: filtersOutOfScope, forceRender: hasRequiredFirst, hasTopMargin: filtersInScope.length > 0, renderer: renderer })] }\n  ), [\n  filtersInScope,\n  renderer,\n  showCollapsePanel,\n  filtersOutOfScope,\n  hasRequiredFirst]\n  );\n  const overflowedFiltersInScope = useMemo(() => filtersInScope.filter(({ id }) => overflowedIds == null ? void 0 : overflowedIds.includes(id)), [filtersInScope, overflowedIds]);\n  const overflowedCrossFilters = useMemo(() => selectedCrossFilters.filter(({ emitterId, name }) => overflowedIds == null ? void 0 : overflowedIds.includes(`${name}${emitterId}`)), [overflowedIds, selectedCrossFilters]);\n  const activeOverflowedFiltersInScope = useMemo(() => {\n    const activeOverflowedFilters = overflowedFiltersInScope.filter((filter) => isNativeFilterWithDataMask(filter));\n    return [...activeOverflowedFilters, ...overflowedCrossFilters];\n  }, [overflowedCrossFilters, overflowedFiltersInScope]);\n  const rendererCrossFilter = useCallback((crossFilter, orientation, last) => _jsx(CrossFilter, { filter: crossFilter, orientation: orientation, last: filtersInScope.length > 0 &&\n    `${last.name}${last.emitterId}` ===\n    `${crossFilter.name}${crossFilter.emitterId}` }), [filtersInScope.length]);\n  const items = useMemo(() => {\n    const crossFilters = selectedCrossFilters.map((c) => ({\n      // a combination of filter name and chart id to account\n      // for multiple cross filters from the same chart in the future\n      id: `${c.name}${c.emitterId}`,\n      element: rendererCrossFilter(c, FilterBarOrientation.Horizontal, selectedCrossFilters.at(-1))\n    }));\n    const nativeFiltersInScope = filtersInScope.map((filter, index) => ({\n      id: filter.id,\n      element: _jsx(\"div\", { className: \"filter-item-wrapper\", css: css`\n            flex-shrink: 0;\n          `, children:\n        renderer(filter, index) }\n      )\n    }));\n    return [...crossFilters, ...nativeFiltersInScope];\n  }, [filtersInScope, renderer, rendererCrossFilter, selectedCrossFilters]);\n  const renderHorizontalContent = useCallback(() => _jsx(\"div\", { css: (theme) => css`\n          padding: 0 ${theme.gridUnit * 4}px;\n          min-width: 0;\n          flex: 1;\n        `, children:\n    _jsx(DropdownContainer, { items: items, dropdownTriggerIcon: _jsx(Icons.FilterOutlined, { css: css`\n                && {\n                  margin-right: -4px;\n                  display: flex;\n                }\n              ` }), dropdownTriggerText: t('More filters'), dropdownTriggerCount: activeOverflowedFiltersInScope.length, dropdownTriggerTooltip: activeOverflowedFiltersInScope.length === 0 ?\n      t('No applied filters') :\n      t('Applied filters: %s', activeOverflowedFiltersInScope.\n      map((filter) => filter.name).\n      join(', ')), dropdownContent: overflowedFiltersInScope.length ||\n      overflowedCrossFilters.length ||\n      filtersOutOfScope.length && showCollapsePanel ?\n      () => _jsx(FiltersDropdownContent, { overflowedCrossFilters: overflowedCrossFilters, filtersInScope: overflowedFiltersInScope, filtersOutOfScope: filtersOutOfScope, renderer: renderer, rendererCrossFilter: rendererCrossFilter, showCollapsePanel: showCollapsePanel, forceRenderOutOfScope: hasRequiredFirst }) :\n      undefined, forceRender: hasRequiredFirst, ref: popoverRef, onOverflowingStateChange: ({ overflowed: nextOverflowedIds }) => {\n        if (nextOverflowedIds.length !== overflowedIds.length ||\n        overflowedIds.reduce((a, b, i) => a || b !== nextOverflowedIds[i], false)) {\n          setOverflowedIds(nextOverflowedIds);\n        }\n      } }) }\n  ), [\n  items,\n  activeOverflowedFiltersInScope,\n  overflowedFiltersInScope,\n  overflowedCrossFilters,\n  filtersOutOfScope,\n  showCollapsePanel,\n  renderer,\n  rendererCrossFilter,\n  hasRequiredFirst,\n  overflowedIds]\n  );\n  const overflowedByIndex = useMemo(() => {\n    const filtersOutOfScopeIds = new Set(filtersOutOfScope.map(({ id }) => id));\n    const overflowedFiltersInScopeIds = new Set(overflowedFiltersInScope.map(({ id }) => id));\n    return filtersWithValues.map((filter) => filtersOutOfScopeIds.has(filter.id) ||\n    overflowedFiltersInScopeIds.has(filter.id));\n  }, [filtersOutOfScope, filtersWithValues, overflowedFiltersInScope]);\n  useEffect(() => {\n    if (outlinedFilterId && overflowedIds.includes(outlinedFilterId)) {var _popoverRef$current;\n      popoverRef == null ? void 0 : (_popoverRef$current = popoverRef.current) == null ? void 0 : _popoverRef$current.open();\n    }\n  }, [outlinedFilterId, lastUpdated, popoverRef, overflowedIds]);\n  return _jsxs(_Fragment, { children: [\n    portalNodes.\n    filter((node, index) => filterIds.has(filtersWithValues[index].id)).\n    map((node, index) => _jsx(InPortal, { node: node, children:\n      filterControlFactory(index, filterBarOrientation, overflowedByIndex[index]) }, filtersWithValues[index].id\n    )),\n    filterBarOrientation === FilterBarOrientation.Vertical &&\n    renderVerticalContent(),\n    filterBarOrientation === FilterBarOrientation.Horizontal &&\n    renderHorizontalContent()] }\n  );\n};__signature__(FilterControls, \"useSelector{filterBarOrientation}\\nuseFilterOutlined{{ outlinedFilterId, lastUpdated }}\\nuseState{[overflowedIds, setOverflowedIds]([])}\\nuseRef{popoverRef}\\nuseSelector{dataMask}\\nuseChartIds{chartIds}\\nuseChartLayoutItems{chartLayoutItems}\\nuseChartsVerboseMaps{verboseMaps}\\nuseMemo{selectedCrossFilters}\\nuseFilterControlFactory{{ filterControlFactory, filtersWithValues }}\\nuseMemo{portalNodes}\\nuseSelectFiltersInScope{[filtersInScope, filtersOutOfScope]}\\nuseMemo{hasRequiredFirst}\\nuseDashboardHasTabs{dashboardHasTabs}\\nuseCallback{renderer}\\nuseCallback{renderVerticalContent}\\nuseMemo{overflowedFiltersInScope}\\nuseMemo{overflowedCrossFilters}\\nuseMemo{activeOverflowedFiltersInScope}\\nuseCallback{rendererCrossFilter}\\nuseMemo{items}\\nuseCallback{renderHorizontalContent}\\nuseMemo{overflowedByIndex}\\nuseEffect{}\", () => [useSelector, useFilterOutlined, useSelector, useChartIds, useChartLayoutItems, useChartsVerboseMaps, useFilterControlFactory, useSelectFiltersInScope, useDashboardHasTabs]);const _default = /*#__PURE__*/\nmemo(FilterControls);export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(FilterControls, \"FilterControls\", \"/Users/aryurkov/superset/superset-frontend/src/dashboard/components/nativeFilters/FilterBar/FilterControls/FilterControls.tsx\");reactHotLoader.register(_default, \"default\", \"/Users/aryurkov/superset/superset-frontend/src/dashboard/components/nativeFilters/FilterBar/FilterControls/FilterControls.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["memo","Fragment","useEffect","useCallback","useMemo","useRef","useState","css","t","isNativeFilterWithDataMask","createHtmlPortalNode","InPortal","OutPortal","useSelector","useDashboardHasTabs","useSelectFiltersInScope","FilterBarOrientation","DropdownContainer","Icons","useChartIds","useChartLayoutItems","FiltersOutOfScopeCollapsible","useFilterControlFactory","FiltersDropdownContent","crossFiltersSelector","CrossFilter","useFilterOutlined","useChartsVerboseMaps","jsx","_jsx","jsxs","_jsxs","_Fragment","FilterControls","dataMaskSelected","onFilterSelectionChange","filterBarOrientation","dashboardInfo","outlinedFilterId","lastUpdated","overflowedIds","setOverflowedIds","popoverRef","dataMask","state","chartIds","chartLayoutItems","verboseMaps","selectedCrossFilters","filterControlFactory","filtersWithValues","portalNodes","nodes","Array","length","i","filterIds","Set","map","item","id","filtersInScope","filtersOutOfScope","hasRequiredFirst","some","filter","requiredFirst","dashboardHasTabs","showCollapsePanel","renderer","index","filterIndex","findIndex","f","key","children","node","inView","renderVerticalContent","forceRender","hasTopMargin","overflowedFiltersInScope","includes","overflowedCrossFilters","emitterId","name","activeOverflowedFiltersInScope","activeOverflowedFilters","rendererCrossFilter","crossFilter","orientation","last","items","crossFilters","c","element","Horizontal","at","nativeFiltersInScope","className","renderHorizontalContent","theme","gridUnit","dropdownTriggerIcon","FilterOutlined","dropdownTriggerText","dropdownTriggerCount","dropdownTriggerTooltip","join","dropdownContent","forceRenderOutOfScope","undefined","ref","onOverflowingStateChange","overflowed","nextOverflowedIds","reduce","a","b","overflowedByIndex","filtersOutOfScopeIds","overflowedFiltersInScopeIds","has","_popoverRef$current","current","open","Vertical","__signature__","_default","reactHotLoader","reactHotLoaderGlobal","default","register","leaveModule","module"],"sources":["/Users/aryurkov/superset/superset-frontend/src/dashboard/components/nativeFilters/FilterBar/FilterControls/FilterControls.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  memo,\n  Fragment,\n  FC,\n  useEffect,\n  useCallback,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport {\n  DataMask,\n  DataMaskStateWithId,\n  Filter,\n  Divider,\n  css,\n  SupersetTheme,\n  t,\n  isNativeFilterWithDataMask,\n} from '@superset-ui/core';\nimport {\n  createHtmlPortalNode,\n  InPortal,\n  OutPortal,\n} from 'react-reverse-portal';\nimport { useSelector } from 'react-redux';\nimport {\n  useDashboardHasTabs,\n  useSelectFiltersInScope,\n} from 'src/dashboard/components/nativeFilters/state';\nimport { FilterBarOrientation, RootState } from 'src/dashboard/types';\nimport DropdownContainer, {\n  Ref as DropdownContainerRef,\n} from 'src/components/DropdownContainer';\nimport { Icons } from 'src/components/Icons';\nimport { useChartIds } from 'src/dashboard/util/charts/useChartIds';\nimport { useChartLayoutItems } from 'src/dashboard/util/useChartLayoutItems';\nimport { FiltersOutOfScopeCollapsible } from '../FiltersOutOfScopeCollapsible';\nimport { useFilterControlFactory } from '../useFilterControlFactory';\nimport { FiltersDropdownContent } from '../FiltersDropdownContent';\nimport crossFiltersSelector from '../CrossFilters/selectors';\nimport CrossFilter from '../CrossFilters/CrossFilter';\nimport { useFilterOutlined } from '../useFilterOutlined';\nimport { useChartsVerboseMaps } from '../utils';\n\ntype FilterControlsProps = {\n  dataMaskSelected: DataMaskStateWithId;\n  onFilterSelectionChange: (filter: Filter, dataMask: DataMask) => void;\n};\n\nconst FilterControls: FC<FilterControlsProps> = ({\n  dataMaskSelected,\n  onFilterSelectionChange,\n}) => {\n  const filterBarOrientation = useSelector<RootState, FilterBarOrientation>(\n    ({ dashboardInfo }) => dashboardInfo.filterBarOrientation,\n  );\n\n  const { outlinedFilterId, lastUpdated } = useFilterOutlined();\n\n  const [overflowedIds, setOverflowedIds] = useState<string[]>([]);\n  const popoverRef = useRef<DropdownContainerRef>(null);\n\n  const dataMask = useSelector<RootState, DataMaskStateWithId>(\n    state => state.dataMask,\n  );\n  const chartIds = useChartIds();\n  const chartLayoutItems = useChartLayoutItems();\n  const verboseMaps = useChartsVerboseMaps();\n\n  const selectedCrossFilters = useMemo(\n    () =>\n      crossFiltersSelector({\n        dataMask,\n        chartIds,\n        chartLayoutItems,\n        verboseMaps,\n      }),\n    [chartIds, chartLayoutItems, dataMask, verboseMaps],\n  );\n  const { filterControlFactory, filtersWithValues } = useFilterControlFactory(\n    dataMaskSelected,\n    onFilterSelectionChange,\n  );\n  const portalNodes = useMemo(() => {\n    const nodes = new Array(filtersWithValues.length);\n    for (let i = 0; i < filtersWithValues.length; i += 1) {\n      nodes[i] = createHtmlPortalNode();\n    }\n    return nodes;\n  }, [filtersWithValues.length]);\n\n  const filterIds = new Set(filtersWithValues.map(item => item.id));\n\n  const [filtersInScope, filtersOutOfScope] =\n    useSelectFiltersInScope(filtersWithValues);\n\n  const hasRequiredFirst = useMemo(\n    () => filtersWithValues.some(filter => filter.requiredFirst),\n    [filtersWithValues],\n  );\n\n  const dashboardHasTabs = useDashboardHasTabs();\n  const showCollapsePanel = dashboardHasTabs && filtersWithValues.length > 0;\n\n  const renderer = useCallback(\n    ({ id }: Filter | Divider, index: number | undefined) => {\n      const filterIndex = filtersWithValues.findIndex(f => f.id === id);\n      const key = index ?? id;\n      return (\n        // Empty text node is to ensure there's always an element preceding\n        // the OutPortal, otherwise react-reverse-portal crashes\n        <Fragment key={key}>\n          {'' /* eslint-disable-line react/jsx-curly-brace-presence */}\n          <OutPortal node={portalNodes[filterIndex]} inView />\n        </Fragment>\n      );\n    },\n    [filtersWithValues, portalNodes],\n  );\n\n  const renderVerticalContent = useCallback(\n    () => (\n      <>\n        {filtersInScope.map(renderer)}\n        {showCollapsePanel && (\n          <FiltersOutOfScopeCollapsible\n            filtersOutOfScope={filtersOutOfScope}\n            forceRender={hasRequiredFirst}\n            hasTopMargin={filtersInScope.length > 0}\n            renderer={renderer}\n          />\n        )}\n      </>\n    ),\n    [\n      filtersInScope,\n      renderer,\n      showCollapsePanel,\n      filtersOutOfScope,\n      hasRequiredFirst,\n    ],\n  );\n\n  const overflowedFiltersInScope = useMemo(\n    () => filtersInScope.filter(({ id }) => overflowedIds?.includes(id)),\n    [filtersInScope, overflowedIds],\n  );\n\n  const overflowedCrossFilters = useMemo(\n    () =>\n      selectedCrossFilters.filter(({ emitterId, name }) =>\n        overflowedIds?.includes(`${name}${emitterId}`),\n      ),\n    [overflowedIds, selectedCrossFilters],\n  );\n\n  const activeOverflowedFiltersInScope = useMemo(() => {\n    const activeOverflowedFilters = overflowedFiltersInScope.filter(filter =>\n      isNativeFilterWithDataMask(filter),\n    );\n    return [...activeOverflowedFilters, ...overflowedCrossFilters];\n  }, [overflowedCrossFilters, overflowedFiltersInScope]);\n\n  const rendererCrossFilter = useCallback(\n    (crossFilter, orientation, last) => (\n      <CrossFilter\n        filter={crossFilter}\n        orientation={orientation}\n        last={\n          filtersInScope.length > 0 &&\n          `${last.name}${last.emitterId}` ===\n            `${crossFilter.name}${crossFilter.emitterId}`\n        }\n      />\n    ),\n    [filtersInScope.length],\n  );\n\n  const items = useMemo(() => {\n    const crossFilters = selectedCrossFilters.map(c => ({\n      // a combination of filter name and chart id to account\n      // for multiple cross filters from the same chart in the future\n      id: `${c.name}${c.emitterId}`,\n      element: rendererCrossFilter(\n        c,\n        FilterBarOrientation.Horizontal,\n        selectedCrossFilters.at(-1),\n      ),\n    }));\n    const nativeFiltersInScope = filtersInScope.map((filter, index) => ({\n      id: filter.id,\n      element: (\n        <div\n          className=\"filter-item-wrapper\"\n          css={css`\n            flex-shrink: 0;\n          `}\n        >\n          {renderer(filter, index)}\n        </div>\n      ),\n    }));\n    return [...crossFilters, ...nativeFiltersInScope];\n  }, [filtersInScope, renderer, rendererCrossFilter, selectedCrossFilters]);\n\n  const renderHorizontalContent = useCallback(\n    () => (\n      <div\n        css={(theme: SupersetTheme) => css`\n          padding: 0 ${theme.gridUnit * 4}px;\n          min-width: 0;\n          flex: 1;\n        `}\n      >\n        <DropdownContainer\n          items={items}\n          dropdownTriggerIcon={\n            <Icons.FilterOutlined\n              css={css`\n                && {\n                  margin-right: -4px;\n                  display: flex;\n                }\n              `}\n            />\n          }\n          dropdownTriggerText={t('More filters')}\n          dropdownTriggerCount={activeOverflowedFiltersInScope.length}\n          dropdownTriggerTooltip={\n            activeOverflowedFiltersInScope.length === 0\n              ? t('No applied filters')\n              : t(\n                  'Applied filters: %s',\n                  activeOverflowedFiltersInScope\n                    .map(filter => filter.name)\n                    .join(', '),\n                )\n          }\n          dropdownContent={\n            overflowedFiltersInScope.length ||\n            overflowedCrossFilters.length ||\n            (filtersOutOfScope.length && showCollapsePanel)\n              ? () => (\n                  <FiltersDropdownContent\n                    overflowedCrossFilters={overflowedCrossFilters}\n                    filtersInScope={overflowedFiltersInScope}\n                    filtersOutOfScope={filtersOutOfScope}\n                    renderer={renderer}\n                    rendererCrossFilter={rendererCrossFilter}\n                    showCollapsePanel={showCollapsePanel}\n                    forceRenderOutOfScope={hasRequiredFirst}\n                  />\n                )\n              : undefined\n          }\n          forceRender={hasRequiredFirst}\n          ref={popoverRef}\n          onOverflowingStateChange={({ overflowed: nextOverflowedIds }) => {\n            if (\n              nextOverflowedIds.length !== overflowedIds.length ||\n              overflowedIds.reduce(\n                (a, b, i) => a || b !== nextOverflowedIds[i],\n                false,\n              )\n            ) {\n              setOverflowedIds(nextOverflowedIds);\n            }\n          }}\n        />\n      </div>\n    ),\n    [\n      items,\n      activeOverflowedFiltersInScope,\n      overflowedFiltersInScope,\n      overflowedCrossFilters,\n      filtersOutOfScope,\n      showCollapsePanel,\n      renderer,\n      rendererCrossFilter,\n      hasRequiredFirst,\n      overflowedIds,\n    ],\n  );\n\n  const overflowedByIndex = useMemo(() => {\n    const filtersOutOfScopeIds = new Set(filtersOutOfScope.map(({ id }) => id));\n    const overflowedFiltersInScopeIds = new Set(\n      overflowedFiltersInScope.map(({ id }) => id),\n    );\n\n    return filtersWithValues.map(\n      filter =>\n        filtersOutOfScopeIds.has(filter.id) ||\n        overflowedFiltersInScopeIds.has(filter.id),\n    );\n  }, [filtersOutOfScope, filtersWithValues, overflowedFiltersInScope]);\n\n  useEffect(() => {\n    if (outlinedFilterId && overflowedIds.includes(outlinedFilterId)) {\n      popoverRef?.current?.open();\n    }\n  }, [outlinedFilterId, lastUpdated, popoverRef, overflowedIds]);\n\n  return (\n    <>\n      {portalNodes\n        .filter((node, index) => filterIds.has(filtersWithValues[index].id))\n        .map((node, index) => (\n          <InPortal node={node} key={filtersWithValues[index].id}>\n            {filterControlFactory(\n              index,\n              filterBarOrientation,\n              overflowedByIndex[index],\n            )}\n          </InPortal>\n        ))}\n      {filterBarOrientation === FilterBarOrientation.Vertical &&\n        renderVerticalContent()}\n      {filterBarOrientation === FilterBarOrientation.Horizontal &&\n        renderHorizontalContent()}\n    </>\n  );\n};\n\nexport default memo(FilterControls);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}