{"ast":null,"code":"import _isUndefined from \"lodash/isUndefined\";import _debounce from \"lodash/debounce\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-disable no-param-reassign */\nimport { useCallback, useEffect, useMemo, useState } from 'react';\nimport { AppSection, ensureIsArray, getColumnLabel, finestTemporalGrainFormatter, t, tn, styled } from '@superset-ui/core';\n\nimport { useImmerReducer } from 'use-immer';\nimport { Select } from 'src/components';\n// eslint-disable-next-line no-restricted-imports\nimport { Space } from 'antd'; // Import Space directly from antd\nimport { SLOW_DEBOUNCE } from 'src/constants';\nimport { hasOption, propertyComparator } from 'src/components/Select/utils';\nimport { FilterBarOrientation } from 'src/dashboard/types';\nimport { getDataRecordFormatter, getSelectExtraFormData } from '../../utils';\nimport { FilterPluginStyle, StatusMessage, StyledFormItem } from '../common';import { jsx as _jsx, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nfunction reducer(draft, action) {\n  switch (action.type) {\n    case 'ownState':\n      draft.ownState = {\n        ...draft.ownState,\n        ...action.ownState\n      };\n      return draft;\n    case 'filterState':\n      if (JSON.stringify(draft.extraFormData) !==\n      JSON.stringify(action.extraFormData)) {\n        draft.extraFormData = action.extraFormData;\n      }\n      if (JSON.stringify(draft.filterState) !== JSON.stringify(action.filterState)) {\n        draft.filterState = { ...draft.filterState, ...action.filterState };\n      }\n      return draft;\n    default:\n      return draft;\n  }\n}\nconst StyledSpace = styled(Space)`\n  display: flex;\n  align-items: center;\n  width: 100%;\n\n  .exclude-select {\n    width: 80px;\n    flex-shrink: 0;\n  }\n\n  &.ant-space {\n    .ant-space-item {\n      width: ${({ $inverseSelection }) => !$inverseSelection ? '100%' : 'auto'};\n    }\n  }\n`;\nexport default function PluginFilterSelect(props) {\n  const { coltypeMap, data, filterState, formData, height, isRefreshing, width, setDataMask, setHoveredFilter, unsetHoveredFilter, setFocusedFilter, unsetFocusedFilter, setFilterActive, appSection, showOverflow, parentRef, inputRef, filterBarOrientation } = props;\n  const { enableEmptyFilter, creatable, multiSelect, showSearch, inverseSelection, defaultToFirstItem, searchAllOptions } = formData;\n  const groupby = useMemo(() => ensureIsArray(formData.groupby).map(getColumnLabel), [formData.groupby]);\n  const [col] = groupby;\n  const [initialColtypeMap] = useState(coltypeMap);\n  const [search, setSearch] = useState('');\n  const [dataMask, dispatchDataMask] = useImmerReducer(reducer, {\n    extraFormData: {},\n    filterState\n  });\n  const datatype = coltypeMap[col];\n  const labelFormatter = useMemo(() => getDataRecordFormatter({\n    timeFormatter: finestTemporalGrainFormatter(data.map((el) => el[col]))\n  }), [data, col]);\n  const [excludeFilterValues, setExcludeFilterValues] = useState(_isUndefined(filterState == null ? void 0 : filterState.excludeFilterValues) ?\n  true :\n  filterState == null ? void 0 : filterState.excludeFilterValues);\n  const updateDataMask = useCallback((values) => {\n    const emptyFilter = enableEmptyFilter && !inverseSelection && !(values != null && values.length);\n    const suffix = inverseSelection && values != null && values.length ? t(' (excluded)') : '';\n    dispatchDataMask({\n      type: 'filterState',\n      extraFormData: getSelectExtraFormData(col, values, emptyFilter, excludeFilterValues && inverseSelection),\n      filterState: {\n        ...filterState,\n        label: values != null && values.length ?\n        `${(values || []).\n        map((value) => labelFormatter(value, datatype)).\n        join(', ')}${suffix}` :\n        undefined,\n        value: appSection === AppSection.FilterConfigModal && defaultToFirstItem ?\n        undefined :\n        values,\n        excludeFilterValues\n      }\n    });\n  },\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  [\n  appSection,\n  col,\n  datatype,\n  defaultToFirstItem,\n  dispatchDataMask,\n  enableEmptyFilter,\n  inverseSelection,\n  excludeFilterValues,\n  JSON.stringify(filterState),\n  labelFormatter]\n  );\n  const isDisabled = appSection === AppSection.FilterConfigModal && defaultToFirstItem;\n  const onSearch = useMemo(() => _debounce((search) => {\n    setSearch(search);\n    if (searchAllOptions) {\n      dispatchDataMask({\n        type: 'ownState',\n        ownState: {\n          coltypeMap: initialColtypeMap,\n          search\n        }\n      });\n    }\n  }, SLOW_DEBOUNCE), [dispatchDataMask, initialColtypeMap, searchAllOptions]);\n  const handleBlur = useCallback(() => {\n    unsetFocusedFilter();\n    onSearch('');\n  }, [onSearch, unsetFocusedFilter]);\n  const handleChange = useCallback((value) => {\n    const values = value === null ? [null] : ensureIsArray(value);\n    if (values.length === 0) {\n      updateDataMask(null);\n    } else\n    {\n      updateDataMask(values);\n    }\n  }, [updateDataMask]);\n  const placeholderText = data.length === 0 ?\n  t('No data') :\n  tn('%s option', '%s options', data.length, data.length);\n  const formItemExtra = useMemo(() => {\n    if (filterState.validateMessage) {\n      return _jsx(StatusMessage, { status: filterState.validateStatus, children:\n        filterState.validateMessage }\n      );\n    }\n    return undefined;\n  }, [filterState.validateMessage, filterState.validateStatus]);\n  const uniqueOptions = useMemo(() => {\n    const allOptions = new Set([...data.map((el) => el[col])]);\n    return [...allOptions].map((value) => ({\n      label: labelFormatter(value, datatype),\n      value,\n      isNewOption: false\n    }));\n  }, [data, datatype, col, labelFormatter]);\n  const options = useMemo(() => {\n    if (search && !multiSelect && !hasOption(search, uniqueOptions, true)) {\n      uniqueOptions.unshift({\n        label: search,\n        value: search,\n        isNewOption: true\n      });\n    }\n    return uniqueOptions;\n  }, [multiSelect, search, uniqueOptions]);\n  const sortComparator = useCallback((a, b) => {\n    const labelComparator = propertyComparator('label');\n    if (formData.sortAscending) {\n      return labelComparator(a, b);\n    }\n    return labelComparator(b, a);\n  }, [formData.sortAscending]);\n  useEffect(() => {\n    if (defaultToFirstItem && filterState.value === undefined) {\n      // initialize to first value if set to default to first item\n      const firstItem = data[0] ?\n      groupby.map((col) => data[0][col]) :\n      null;\n      // firstItem[0] !== undefined for a case when groupby changed but new data still not fetched\n      // TODO: still need repopulate default value in config modal when column changed\n      if ((firstItem == null ? void 0 : firstItem[0]) !== undefined) {\n        updateDataMask(firstItem);\n      }\n    } else\n    if (isDisabled) {\n      // empty selection if filter is disabled\n      updateDataMask(null);\n    } else\n    {\n      // reset data mask based on filter state\n      updateDataMask(filterState.value);\n    }\n  }, [\n  col,\n  isDisabled,\n  defaultToFirstItem,\n  enableEmptyFilter,\n  inverseSelection,\n  excludeFilterValues,\n  updateDataMask,\n  data,\n  groupby,\n  JSON.stringify(filterState.value)]\n  );\n  useEffect(() => {\n    setDataMask(dataMask);\n  }, [JSON.stringify(dataMask)]);\n  useEffect(() => {var _filterState$value;\n    dispatchDataMask({\n      type: 'filterState',\n      extraFormData: getSelectExtraFormData(col, filterState.value, !((_filterState$value = filterState.value) != null && _filterState$value.length), excludeFilterValues && inverseSelection),\n      filterState: {\n        ...filterState,\n        excludeFilterValues\n      }\n    });\n  }, [excludeFilterValues]);\n  const handleExclusionToggle = (value) => {\n    setExcludeFilterValues(value === 'true');\n  };\n  return _jsx(FilterPluginStyle, { height: height, width: width, children:\n    _jsx(StyledFormItem, { validateStatus: filterState.validateStatus, extra: formItemExtra, children:\n      _jsxs(StyledSpace, { $inverseSelection: inverseSelection, children: [\n        inverseSelection && _jsx(Select, { className: \"exclude-select\", value: `${excludeFilterValues}`, options: [\n          { value: 'true', label: t('is not') },\n          { value: 'false', label: t('is') }],\n          onChange: handleExclusionToggle }),\n        _jsx(Select, { name: formData.nativeFilterId, allowClear: true, allowNewOptions: !searchAllOptions && creatable !== false, allowSelectAll: !searchAllOptions, value: filterState.value || [], disabled: isDisabled, getPopupContainer: showOverflow ?\n          () => (parentRef == null ? void 0 : parentRef.current) || document.body :\n          (trigger) => (trigger == null ? void 0 : trigger.parentNode) || document.body, showSearch: showSearch, mode: multiSelect ? 'multiple' : 'single', placeholder: placeholderText, onClear: () => onSearch(''), onSearch: onSearch, onBlur: handleBlur, onFocus: setFocusedFilter, onMouseEnter: setHoveredFilter, onMouseLeave: unsetHoveredFilter\n          // @ts-ignore\n          , onChange: handleChange, ref: inputRef, loading: isRefreshing, oneLine: filterBarOrientation === FilterBarOrientation.Horizontal, invertSelection: inverseSelection && excludeFilterValues, options: options, sortComparator: sortComparator, onDropdownVisibleChange: setFilterActive, className: \"select-container\" })] }\n      ) }\n    ) }\n  );\n}__signature__(PluginFilterSelect, \"useMemo{groupby}\\nuseState{[initialColtypeMap](coltypeMap)}\\nuseState{[search, setSearch]('')}\\nuseImmerReducer{[dataMask, dispatchDataMask]}\\nuseMemo{labelFormatter}\\nuseState{[excludeFilterValues, setExcludeFilterValues](isUndefined(filterState?.excludeFilterValues)\\n        ? true\\n        : filterState?.excludeFilterValues)}\\nuseCallback{updateDataMask}\\nuseMemo{onSearch}\\nuseCallback{handleBlur}\\nuseCallback{handleChange}\\nuseMemo{formItemExtra}\\nuseMemo{uniqueOptions}\\nuseMemo{options}\\nuseCallback{sortComparator}\\nuseEffect{}\\nuseEffect{}\\nuseEffect{}\", () => [useImmerReducer]);;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(reducer, \"reducer\", \"/Users/aryurkov/superset/superset-frontend/src/filters/components/Select/SelectFilterPlugin.tsx\");reactHotLoader.register(StyledSpace, \"StyledSpace\", \"/Users/aryurkov/superset/superset-frontend/src/filters/components/Select/SelectFilterPlugin.tsx\");reactHotLoader.register(PluginFilterSelect, \"PluginFilterSelect\", \"/Users/aryurkov/superset/superset-frontend/src/filters/components/Select/SelectFilterPlugin.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["useCallback","useEffect","useMemo","useState","AppSection","ensureIsArray","getColumnLabel","finestTemporalGrainFormatter","t","tn","styled","useImmerReducer","Select","Space","SLOW_DEBOUNCE","hasOption","propertyComparator","FilterBarOrientation","getDataRecordFormatter","getSelectExtraFormData","FilterPluginStyle","StatusMessage","StyledFormItem","jsx","_jsx","jsxs","_jsxs","reducer","draft","action","type","ownState","JSON","stringify","extraFormData","filterState","StyledSpace","$inverseSelection","PluginFilterSelect","props","coltypeMap","data","formData","height","isRefreshing","width","setDataMask","setHoveredFilter","unsetHoveredFilter","setFocusedFilter","unsetFocusedFilter","setFilterActive","appSection","showOverflow","parentRef","inputRef","filterBarOrientation","enableEmptyFilter","creatable","multiSelect","showSearch","inverseSelection","defaultToFirstItem","searchAllOptions","groupby","map","col","initialColtypeMap","search","setSearch","dataMask","dispatchDataMask","datatype","labelFormatter","timeFormatter","el","excludeFilterValues","setExcludeFilterValues","_isUndefined","updateDataMask","values","emptyFilter","length","suffix","label","value","join","undefined","FilterConfigModal","isDisabled","onSearch","_debounce","handleBlur","handleChange","placeholderText","formItemExtra","validateMessage","status","validateStatus","children","uniqueOptions","allOptions","Set","isNewOption","options","unshift","sortComparator","a","b","labelComparator","sortAscending","firstItem","_filterState$value","handleExclusionToggle","extra","className","onChange","name","nativeFilterId","allowClear","allowNewOptions","allowSelectAll","disabled","getPopupContainer","current","document","body","trigger","parentNode","mode","placeholder","onClear","onBlur","onFocus","onMouseEnter","onMouseLeave","ref","loading","oneLine","Horizontal","invertSelection","onDropdownVisibleChange","__signature__","reactHotLoader","reactHotLoaderGlobal","default","register","leaveModule","module"],"sources":["/Users/aryurkov/superset/superset-frontend/src/filters/components/Select/SelectFilterPlugin.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-disable no-param-reassign */\nimport { useCallback, useEffect, useMemo, useState } from 'react';\nimport {\n  AppSection,\n  DataMask,\n  ensureIsArray,\n  ExtraFormData,\n  GenericDataType,\n  getColumnLabel,\n  JsonObject,\n  finestTemporalGrainFormatter,\n  t,\n  tn,\n  styled,\n} from '@superset-ui/core';\n// eslint-disable-next-line no-restricted-imports\nimport { LabeledValue as AntdLabeledValue } from 'antd/lib/select'; // TODO: Remove antd\nimport { debounce, isUndefined } from 'lodash';\nimport { useImmerReducer } from 'use-immer';\nimport { Select } from 'src/components';\n// eslint-disable-next-line no-restricted-imports\nimport { Space } from 'antd'; // Import Space directly from antd\nimport { SLOW_DEBOUNCE } from 'src/constants';\nimport { hasOption, propertyComparator } from 'src/components/Select/utils';\nimport { FilterBarOrientation } from 'src/dashboard/types';\nimport { getDataRecordFormatter, getSelectExtraFormData } from '../../utils';\nimport { FilterPluginStyle, StatusMessage, StyledFormItem } from '../common';\nimport { PluginFilterSelectProps, SelectValue } from './types';\n\ntype DataMaskAction =\n  | { type: 'ownState'; ownState: JsonObject }\n  | {\n      type: 'filterState';\n      extraFormData: ExtraFormData;\n      filterState: {\n        value: SelectValue;\n        label?: string;\n        excludeFilterValues?: boolean;\n      };\n    };\n\nfunction reducer(draft: DataMask, action: DataMaskAction) {\n  switch (action.type) {\n    case 'ownState':\n      draft.ownState = {\n        ...draft.ownState,\n        ...action.ownState,\n      };\n      return draft;\n    case 'filterState':\n      if (\n        JSON.stringify(draft.extraFormData) !==\n        JSON.stringify(action.extraFormData)\n      ) {\n        draft.extraFormData = action.extraFormData;\n      }\n      if (\n        JSON.stringify(draft.filterState) !== JSON.stringify(action.filterState)\n      ) {\n        draft.filterState = { ...draft.filterState, ...action.filterState };\n      }\n\n      return draft;\n    default:\n      return draft;\n  }\n}\n\nconst StyledSpace = styled(Space)<{ $inverseSelection: boolean }>`\n  display: flex;\n  align-items: center;\n  width: 100%;\n\n  .exclude-select {\n    width: 80px;\n    flex-shrink: 0;\n  }\n\n  &.ant-space {\n    .ant-space-item {\n      width: ${({ $inverseSelection }) =>\n        !$inverseSelection ? '100%' : 'auto'};\n    }\n  }\n`;\n\nexport default function PluginFilterSelect(props: PluginFilterSelectProps) {\n  const {\n    coltypeMap,\n    data,\n    filterState,\n    formData,\n    height,\n    isRefreshing,\n    width,\n    setDataMask,\n    setHoveredFilter,\n    unsetHoveredFilter,\n    setFocusedFilter,\n    unsetFocusedFilter,\n    setFilterActive,\n    appSection,\n    showOverflow,\n    parentRef,\n    inputRef,\n    filterBarOrientation,\n  } = props;\n  const {\n    enableEmptyFilter,\n    creatable,\n    multiSelect,\n    showSearch,\n    inverseSelection,\n    defaultToFirstItem,\n    searchAllOptions,\n  } = formData;\n\n  const groupby = useMemo(\n    () => ensureIsArray(formData.groupby).map(getColumnLabel),\n    [formData.groupby],\n  );\n  const [col] = groupby;\n  const [initialColtypeMap] = useState(coltypeMap);\n  const [search, setSearch] = useState('');\n  const [dataMask, dispatchDataMask] = useImmerReducer(reducer, {\n    extraFormData: {},\n    filterState,\n  });\n  const datatype: GenericDataType = coltypeMap[col];\n  const labelFormatter = useMemo(\n    () =>\n      getDataRecordFormatter({\n        timeFormatter: finestTemporalGrainFormatter(data.map(el => el[col])),\n      }),\n    [data, col],\n  );\n  const [excludeFilterValues, setExcludeFilterValues] = useState(\n    isUndefined(filterState?.excludeFilterValues)\n      ? true\n      : filterState?.excludeFilterValues,\n  );\n\n  const updateDataMask = useCallback(\n    (values: SelectValue) => {\n      const emptyFilter =\n        enableEmptyFilter && !inverseSelection && !values?.length;\n\n      const suffix = inverseSelection && values?.length ? t(' (excluded)') : '';\n      dispatchDataMask({\n        type: 'filterState',\n        extraFormData: getSelectExtraFormData(\n          col,\n          values,\n          emptyFilter,\n          excludeFilterValues && inverseSelection,\n        ),\n        filterState: {\n          ...filterState,\n          label: values?.length\n            ? `${(values || [])\n                .map(value => labelFormatter(value, datatype))\n                .join(', ')}${suffix}`\n            : undefined,\n          value:\n            appSection === AppSection.FilterConfigModal && defaultToFirstItem\n              ? undefined\n              : values,\n          excludeFilterValues,\n        },\n      });\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [\n      appSection,\n      col,\n      datatype,\n      defaultToFirstItem,\n      dispatchDataMask,\n      enableEmptyFilter,\n      inverseSelection,\n      excludeFilterValues,\n      JSON.stringify(filterState),\n      labelFormatter,\n    ],\n  );\n\n  const isDisabled =\n    appSection === AppSection.FilterConfigModal && defaultToFirstItem;\n\n  const onSearch = useMemo(\n    () =>\n      debounce((search: string) => {\n        setSearch(search);\n        if (searchAllOptions) {\n          dispatchDataMask({\n            type: 'ownState',\n            ownState: {\n              coltypeMap: initialColtypeMap,\n              search,\n            },\n          });\n        }\n      }, SLOW_DEBOUNCE),\n    [dispatchDataMask, initialColtypeMap, searchAllOptions],\n  );\n\n  const handleBlur = useCallback(() => {\n    unsetFocusedFilter();\n    onSearch('');\n  }, [onSearch, unsetFocusedFilter]);\n\n  const handleChange = useCallback(\n    (value?: SelectValue | number | string) => {\n      const values = value === null ? [null] : ensureIsArray(value);\n\n      if (values.length === 0) {\n        updateDataMask(null);\n      } else {\n        updateDataMask(values);\n      }\n    },\n    [updateDataMask],\n  );\n\n  const placeholderText =\n    data.length === 0\n      ? t('No data')\n      : tn('%s option', '%s options', data.length, data.length);\n\n  const formItemExtra = useMemo(() => {\n    if (filterState.validateMessage) {\n      return (\n        <StatusMessage status={filterState.validateStatus}>\n          {filterState.validateMessage}\n        </StatusMessage>\n      );\n    }\n    return undefined;\n  }, [filterState.validateMessage, filterState.validateStatus]);\n\n  const uniqueOptions = useMemo(() => {\n    const allOptions = new Set([...data.map(el => el[col])]);\n    return [...allOptions].map((value: string) => ({\n      label: labelFormatter(value, datatype),\n      value,\n      isNewOption: false,\n    }));\n  }, [data, datatype, col, labelFormatter]);\n\n  const options = useMemo(() => {\n    if (search && !multiSelect && !hasOption(search, uniqueOptions, true)) {\n      uniqueOptions.unshift({\n        label: search,\n        value: search,\n        isNewOption: true,\n      });\n    }\n    return uniqueOptions;\n  }, [multiSelect, search, uniqueOptions]);\n\n  const sortComparator = useCallback(\n    (a: AntdLabeledValue, b: AntdLabeledValue) => {\n      const labelComparator = propertyComparator('label');\n      if (formData.sortAscending) {\n        return labelComparator(a, b);\n      }\n      return labelComparator(b, a);\n    },\n    [formData.sortAscending],\n  );\n\n  useEffect(() => {\n    if (defaultToFirstItem && filterState.value === undefined) {\n      // initialize to first value if set to default to first item\n      const firstItem: SelectValue = data[0]\n        ? (groupby.map(col => data[0][col]) as string[])\n        : null;\n      // firstItem[0] !== undefined for a case when groupby changed but new data still not fetched\n      // TODO: still need repopulate default value in config modal when column changed\n      if (firstItem?.[0] !== undefined) {\n        updateDataMask(firstItem);\n      }\n    } else if (isDisabled) {\n      // empty selection if filter is disabled\n      updateDataMask(null);\n    } else {\n      // reset data mask based on filter state\n      updateDataMask(filterState.value);\n    }\n  }, [\n    col,\n    isDisabled,\n    defaultToFirstItem,\n    enableEmptyFilter,\n    inverseSelection,\n    excludeFilterValues,\n    updateDataMask,\n    data,\n    groupby,\n    JSON.stringify(filterState.value),\n  ]);\n\n  useEffect(() => {\n    setDataMask(dataMask);\n  }, [JSON.stringify(dataMask)]);\n\n  useEffect(() => {\n    dispatchDataMask({\n      type: 'filterState',\n      extraFormData: getSelectExtraFormData(\n        col,\n        filterState.value,\n        !filterState.value?.length,\n        excludeFilterValues && inverseSelection,\n      ),\n      filterState: {\n        ...(filterState as {\n          value: SelectValue;\n          label?: string;\n          excludeFilterValues?: boolean;\n        }),\n        excludeFilterValues,\n      },\n    });\n  }, [excludeFilterValues]);\n\n  const handleExclusionToggle = (value: string) => {\n    setExcludeFilterValues(value === 'true');\n  };\n\n  return (\n    <FilterPluginStyle height={height} width={width}>\n      <StyledFormItem\n        validateStatus={filterState.validateStatus}\n        extra={formItemExtra}\n      >\n        <StyledSpace $inverseSelection={inverseSelection}>\n          {inverseSelection && (\n            <Select\n              className=\"exclude-select\"\n              value={`${excludeFilterValues}`}\n              options={[\n                { value: 'true', label: t('is not') },\n                { value: 'false', label: t('is') },\n              ]}\n              onChange={handleExclusionToggle}\n            />\n          )}\n          <Select\n            name={formData.nativeFilterId}\n            allowClear\n            allowNewOptions={!searchAllOptions && creatable !== false}\n            allowSelectAll={!searchAllOptions}\n            value={filterState.value || []}\n            disabled={isDisabled}\n            getPopupContainer={\n              showOverflow\n                ? () => (parentRef?.current as HTMLElement) || document.body\n                : (trigger: HTMLElement) =>\n                    (trigger?.parentNode as HTMLElement) || document.body\n            }\n            showSearch={showSearch}\n            mode={multiSelect ? 'multiple' : 'single'}\n            placeholder={placeholderText}\n            onClear={() => onSearch('')}\n            onSearch={onSearch}\n            onBlur={handleBlur}\n            onFocus={setFocusedFilter}\n            onMouseEnter={setHoveredFilter}\n            onMouseLeave={unsetHoveredFilter}\n            // @ts-ignore\n            onChange={handleChange}\n            ref={inputRef}\n            loading={isRefreshing}\n            oneLine={filterBarOrientation === FilterBarOrientation.Horizontal}\n            invertSelection={inverseSelection && excludeFilterValues}\n            options={options}\n            sortComparator={sortComparator}\n            onDropdownVisibleChange={setFilterActive}\n            className=\"select-container\"\n          />\n        </StyledSpace>\n      </StyledFormItem>\n    </FilterPluginStyle>\n  );\n}\n"],"mappings":"8XAAA;;;;;;;;;;;;;;;;;;AAkBA;AACA,SAASA,WAAW,EAAEC,SAAS,EAAEC,OAAO,EAAEC,QAAQ,QAAQ,OAAO;AACjE,SACEC,UAAU,EAEVC,aAAa,EAGbC,cAAc,EAEdC,4BAA4B,EAC5BC,CAAC,EACDC,EAAE,EACFC,MAAM,QACD,mBAAmB;;AAI1B,SAASC,eAAe,QAAQ,WAAW;AAC3C,SAASC,MAAM,QAAQ,gBAAgB;AACvC;AACA,SAASC,KAAK,QAAQ,MAAM,CAAC,CAAC;AAC9B,SAASC,aAAa,QAAQ,eAAe;AAC7C,SAASC,SAAS,EAAEC,kBAAkB,QAAQ,6BAA6B;AAC3E,SAASC,oBAAoB,QAAQ,qBAAqB;AAC1D,SAASC,sBAAsB,EAAEC,sBAAsB,QAAQ,aAAa;AAC5E,SAASC,iBAAiB,EAAEC,aAAa,EAAEC,cAAc,QAAQ,WAAW,CAAC,SAAAC,GAAA,IAAAC,IAAA,EAAAC,IAAA,IAAAC,KAAA;AAe7E,SAASC,OAAOA,CAACC,KAAe,EAAEC,MAAsB;EACtD,QAAQA,MAAM,CAACC,IAAI;IACjB,KAAK,UAAU;MACbF,KAAK,CAACG,QAAQ,GAAG;QACf,GAAGH,KAAK,CAACG,QAAQ;QACjB,GAAGF,MAAM,CAACE;OACX;MACD,OAAOH,KAAK;IACd,KAAK,aAAa;MAChB,IACEI,IAAI,CAACC,SAAS,CAACL,KAAK,CAACM,aAAa,CAAC;MACnCF,IAAI,CAACC,SAAS,CAACJ,MAAM,CAACK,aAAa,CAAC,EACpC;QACAN,KAAK,CAACM,aAAa,GAAGL,MAAM,CAACK,aAAa;;MAE5C,IACEF,IAAI,CAACC,SAAS,CAACL,KAAK,CAACO,WAAW,CAAC,KAAKH,IAAI,CAACC,SAAS,CAACJ,MAAM,CAACM,WAAW,CAAC,EACxE;QACAP,KAAK,CAACO,WAAW,GAAG,EAAE,GAAGP,KAAK,CAACO,WAAW,EAAE,GAAGN,MAAM,CAACM,WAAW,EAAE;;MAGrE,OAAOP,KAAK;IACd;MACE,OAAOA,KAAK;;AAElB;AAEA,MAAMQ,WAAW,GAAG1B,MAAM,CAACG,KAAK,CAAiC;;;;;;;;;;;;eAYlD,CAAC,EAAEwB,iBAAiB,EAAE,KAC7B,CAACA,iBAAiB,GAAG,MAAM,GAAG,MAAM;;;CAG3C;AAED,eAAc,SAAUC,kBAAkBA,CAACC,KAA8B;EACvE,MAAM,EACJC,UAAU,EACVC,IAAI,EACJN,WAAW,EACXO,QAAQ,EACRC,MAAM,EACNC,YAAY,EACZC,KAAK,EACLC,WAAW,EACXC,gBAAgB,EAChBC,kBAAkB,EAClBC,gBAAgB,EAChBC,kBAAkB,EAClBC,eAAe,EACfC,UAAU,EACVC,YAAY,EACZC,SAAS,EACTC,QAAQ,EACRC,oBAAoB,EACrB,GAAGjB,KAAK;EACT,MAAM,EACJkB,iBAAiB,EACjBC,SAAS,EACTC,WAAW,EACXC,UAAU,EACVC,gBAAgB,EAChBC,kBAAkB,EAClBC,gBAAgB,EACjB,GAAGrB,QAAQ;EAEZ,MAAMsB,OAAO,GAAG9D,OAAO,CACrB,MAAMG,aAAa,CAACqC,QAAQ,CAACsB,OAAO,CAAC,CAACC,GAAG,CAAC3D,cAAc,CAAC,EACzD,CAACoC,QAAQ,CAACsB,OAAO,CAAC,CACnB;EACD,MAAM,CAACE,GAAG,CAAC,GAAGF,OAAO;EACrB,MAAM,CAACG,iBAAiB,CAAC,GAAGhE,QAAQ,CAACqC,UAAU,CAAC;EAChD,MAAM,CAAC4B,MAAM,EAAEC,SAAS,CAAC,GAAGlE,QAAQ,CAAC,EAAE,CAAC;EACxC,MAAM,CAACmE,QAAQ,EAAEC,gBAAgB,CAAC,GAAG5D,eAAe,CAACgB,OAAO,EAAE;IAC5DO,aAAa,EAAE,EAAE;IACjBC;GACD,CAAC;EACF,MAAMqC,QAAQ,GAAoBhC,UAAU,CAAC0B,GAAG,CAAC;EACjD,MAAMO,cAAc,GAAGvE,OAAO,CAC5B,MACEgB,sBAAsB,CAAC;IACrBwD,aAAa,EAAEnE,4BAA4B,CAACkC,IAAI,CAACwB,GAAG,CAAC,CAAAU,EAAE,KAAIA,EAAE,CAACT,GAAG,CAAC,CAAC;GACpE,CAAC,EACJ,CAACzB,IAAI,EAAEyB,GAAG,CAAC,CACZ;EACD,MAAM,CAACU,mBAAmB,EAAEC,sBAAsB,CAAC,GAAG1E,QAAQ,CAC5D2E,YAAA,CAAY3C,WAAW,oBAAXA,WAAW,CAAEyC,mBAAmB,CAAC;EACzC,IAAI;EACJzC,WAAW,oBAAXA,WAAW,CAAEyC,mBAAmB,CACrC;EAED,MAAMG,cAAc,GAAG/E,WAAW,CAChC,CAACgF,MAAmB,KAAI;IACtB,MAAMC,WAAW,GACfxB,iBAAiB,IAAI,CAACI,gBAAgB,IAAI,EAACmB,MAAM,YAANA,MAAM,CAAEE,MAAM;IAE3D,MAAMC,MAAM,GAAGtB,gBAAgB,IAAImB,MAAM,YAANA,MAAM,CAAEE,MAAM,GAAG1E,CAAC,CAAC,aAAa,CAAC,GAAG,EAAE;IACzE+D,gBAAgB,CAAC;MACfzC,IAAI,EAAE,aAAa;MACnBI,aAAa,EAAEf,sBAAsB,CACnC+C,GAAG,EACHc,MAAM,EACNC,WAAW,EACXL,mBAAmB,IAAIf,gBAAgB,CACxC;MACD1B,WAAW,EAAE;QACX,GAAGA,WAAW;QACdiD,KAAK,EAAEJ,MAAM,YAANA,MAAM,CAAEE,MAAM;QACjB,GAAG,CAACF,MAAM,IAAI,EAAE;QACbf,GAAG,CAAC,CAAAoB,KAAK,KAAIZ,cAAc,CAACY,KAAK,EAAEb,QAAQ,CAAC,CAAC;QAC7Cc,IAAI,CAAC,IAAI,CAAC,GAAGH,MAAM,EAAE;QACxBI,SAAS;QACbF,KAAK,EACHjC,UAAU,KAAKhD,UAAU,CAACoF,iBAAiB,IAAI1B,kBAAkB;QAC7DyB,SAAS;QACTP,MAAM;QACZJ;;KAEH,CAAC;EACJ,CAAC;EACD;EACA;EACExB,UAAU;EACVc,GAAG;EACHM,QAAQ;EACRV,kBAAkB;EAClBS,gBAAgB;EAChBd,iBAAiB;EACjBI,gBAAgB;EAChBe,mBAAmB;EACnB5C,IAAI,CAACC,SAAS,CAACE,WAAW,CAAC;EAC3BsC,cAAc;EACf,CACF;EAED,MAAMgB,UAAU,GACdrC,UAAU,KAAKhD,UAAU,CAACoF,iBAAiB,IAAI1B,kBAAkB;EAEnE,MAAM4B,QAAQ,GAAGxF,OAAO,CACtB,MACEyF,SAAA,CAAS,CAACvB,MAAc,KAAI;IAC1BC,SAAS,CAACD,MAAM,CAAC;IACjB,IAAIL,gBAAgB,EAAE;MACpBQ,gBAAgB,CAAC;QACfzC,IAAI,EAAE,UAAU;QAChBC,QAAQ,EAAE;UACRS,UAAU,EAAE2B,iBAAiB;UAC7BC;;OAEH,CAAC;;EAEN,CAAC,EAAEtD,aAAa,CAAC,EACnB,CAACyD,gBAAgB,EAAEJ,iBAAiB,EAAEJ,gBAAgB,CAAC,CACxD;EAED,MAAM6B,UAAU,GAAG5F,WAAW,CAAC,MAAK;IAClCkD,kBAAkB,EAAE;IACpBwC,QAAQ,CAAC,EAAE,CAAC;EACd,CAAC,EAAE,CAACA,QAAQ,EAAExC,kBAAkB,CAAC,CAAC;EAElC,MAAM2C,YAAY,GAAG7F,WAAW,CAC9B,CAACqF,KAAqC,KAAI;IACxC,MAAML,MAAM,GAAGK,KAAK,KAAK,IAAI,GAAG,CAAC,IAAI,CAAC,GAAGhF,aAAa,CAACgF,KAAK,CAAC;IAE7D,IAAIL,MAAM,CAACE,MAAM,KAAK,CAAC,EAAE;MACvBH,cAAc,CAAC,IAAI,CAAC;KACrB;IAAM;MACLA,cAAc,CAACC,MAAM,CAAC;;EAE1B,CAAC,EACD,CAACD,cAAc,CAAC,CACjB;EAED,MAAMe,eAAe,GACnBrD,IAAI,CAACyC,MAAM,KAAK,CAAC;EACb1E,CAAC,CAAC,SAAS,CAAC;EACZC,EAAE,CAAC,WAAW,EAAE,YAAY,EAAEgC,IAAI,CAACyC,MAAM,EAAEzC,IAAI,CAACyC,MAAM,CAAC;EAE7D,MAAMa,aAAa,GAAG7F,OAAO,CAAC,MAAK;IACjC,IAAIiC,WAAW,CAAC6D,eAAe,EAAE;MAC/B,OACExE,IAAA,CAACH,aAAa,IAAC4E,MAAM,EAAE9D,WAAW,CAAC+D,cAAe,EAAAC,QAAA;QAC/ChE,WAAW,CAAC6D,eAAe;MACf,CAAC;;IAGpB,OAAOT,SAAS;EAClB,CAAC,EAAE,CAACpD,WAAW,CAAC6D,eAAe,EAAE7D,WAAW,CAAC+D,cAAc,CAAC,CAAC;EAE7D,MAAME,aAAa,GAAGlG,OAAO,CAAC,MAAK;IACjC,MAAMmG,UAAU,GAAG,IAAIC,GAAG,CAAC,CAAC,GAAG7D,IAAI,CAACwB,GAAG,CAAC,CAAAU,EAAE,KAAIA,EAAE,CAACT,GAAG,CAAC,CAAC,CAAC,CAAC;IACxD,OAAO,CAAC,GAAGmC,UAAU,CAAC,CAACpC,GAAG,CAAC,CAACoB,KAAa,MAAM;MAC7CD,KAAK,EAAEX,cAAc,CAACY,KAAK,EAAEb,QAAQ,CAAC;MACtCa,KAAK;MACLkB,WAAW,EAAE;KACd,CAAC,CAAC;EACL,CAAC,EAAE,CAAC9D,IAAI,EAAE+B,QAAQ,EAAEN,GAAG,EAAEO,cAAc,CAAC,CAAC;EAEzC,MAAM+B,OAAO,GAAGtG,OAAO,CAAC,MAAK;IAC3B,IAAIkE,MAAM,IAAI,CAACT,WAAW,IAAI,CAAC5C,SAAS,CAACqD,MAAM,EAAEgC,aAAa,EAAE,IAAI,CAAC,EAAE;MACrEA,aAAa,CAACK,OAAO,CAAC;QACpBrB,KAAK,EAAEhB,MAAM;QACbiB,KAAK,EAAEjB,MAAM;QACbmC,WAAW,EAAE;OACd,CAAC;;IAEJ,OAAOH,aAAa;EACtB,CAAC,EAAE,CAACzC,WAAW,EAAES,MAAM,EAAEgC,aAAa,CAAC,CAAC;EAExC,MAAMM,cAAc,GAAG1G,WAAW,CAChC,CAAC2G,CAAmB,EAAEC,CAAmB,KAAI;IAC3C,MAAMC,eAAe,GAAG7F,kBAAkB,CAAC,OAAO,CAAC;IACnD,IAAI0B,QAAQ,CAACoE,aAAa,EAAE;MAC1B,OAAOD,eAAe,CAACF,CAAC,EAAEC,CAAC,CAAC;;IAE9B,OAAOC,eAAe,CAACD,CAAC,EAAED,CAAC,CAAC;EAC9B,CAAC,EACD,CAACjE,QAAQ,CAACoE,aAAa,CAAC,CACzB;EAED7G,SAAS,CAAC,MAAK;IACb,IAAI6D,kBAAkB,IAAI3B,WAAW,CAACkD,KAAK,KAAKE,SAAS,EAAE;MACzD;MACA,MAAMwB,SAAS,GAAgBtE,IAAI,CAAC,CAAC,CAAC;MACjCuB,OAAO,CAACC,GAAG,CAAC,CAAAC,GAAG,KAAIzB,IAAI,CAAC,CAAC,CAAC,CAACyB,GAAG,CAAC,CAAc;MAC9C,IAAI;MACR;MACA;MACA,IAAI,CAAA6C,SAAS,oBAATA,SAAS,CAAG,CAAC,CAAC,MAAKxB,SAAS,EAAE;QAChCR,cAAc,CAACgC,SAAS,CAAC;;KAE5B;IAAM,IAAItB,UAAU,EAAE;MACrB;MACAV,cAAc,CAAC,IAAI,CAAC;KACrB;IAAM;MACL;MACAA,cAAc,CAAC5C,WAAW,CAACkD,KAAK,CAAC;;EAErC,CAAC,EAAE;EACDnB,GAAG;EACHuB,UAAU;EACV3B,kBAAkB;EAClBL,iBAAiB;EACjBI,gBAAgB;EAChBe,mBAAmB;EACnBG,cAAc;EACdtC,IAAI;EACJuB,OAAO;EACPhC,IAAI,CAACC,SAAS,CAACE,WAAW,CAACkD,KAAK,CAAC;EAClC,CAAC;EAEFpF,SAAS,CAAC,MAAK;IACb6C,WAAW,CAACwB,QAAQ,CAAC;EACvB,CAAC,EAAE,CAACtC,IAAI,CAACC,SAAS,CAACqC,QAAQ,CAAC,CAAC,CAAC;EAE9BrE,SAAS,CAAC,MAAK,KAAA+G,kBAAA;IACbzC,gBAAgB,CAAC;MACfzC,IAAI,EAAE,aAAa;MACnBI,aAAa,EAAEf,sBAAsB,CACnC+C,GAAG,EACH/B,WAAW,CAACkD,KAAK,EACjB,GAAA2B,kBAAA,GAAC7E,WAAW,CAACkD,KAAK,aAAjB2B,kBAAA,CAAmB9B,MAAM,GAC1BN,mBAAmB,IAAIf,gBAAgB,CACxC;MACD1B,WAAW,EAAE;QACX,GAAIA,WAIF;QACFyC;;KAEH,CAAC;EACJ,CAAC,EAAE,CAACA,mBAAmB,CAAC,CAAC;EAEzB,MAAMqC,qBAAqB,GAAGA,CAAC5B,KAAa,KAAI;IAC9CR,sBAAsB,CAACQ,KAAK,KAAK,MAAM,CAAC;EAC1C,CAAC;EAED,OACE7D,IAAA,CAACJ,iBAAiB,IAACuB,MAAM,EAAEA,MAAO,EAACE,KAAK,EAAEA,KAAM,EAAAsD,QAAA;IAC9C3E,IAAA,CAACF,cAAc,IACb4E,cAAc,EAAE/D,WAAW,CAAC+D,cAAe,EAC3CgB,KAAK,EAAEnB,aAAc,EAAAI,QAAA;MAErBzE,KAAA,CAACU,WAAW,IAACC,iBAAiB,EAAEwB,gBAAiB,EAAAsC,QAAA;QAC9CtC,gBAAgB,IACfrC,IAAA,CAACZ,MAAM,IACLuG,SAAS,EAAC,gBAAgB,EAC1B9B,KAAK,EAAE,GAAGT,mBAAmB,EAAG,EAChC4B,OAAO,EAAE;UACP,EAAEnB,KAAK,EAAE,MAAM,EAAED,KAAK,EAAE5E,CAAC,CAAC,QAAQ,CAAC,EAAE;UACrC,EAAE6E,KAAK,EAAE,OAAO,EAAED,KAAK,EAAE5E,CAAC,CAAC,IAAI,CAAC,EAAE,CAClC;UACF4G,QAAQ,EAAEH,qBAAsB,GAEnC;QACDzF,IAAA,CAACZ,MAAM,IACLyG,IAAI,EAAE3E,QAAQ,CAAC4E,cAAe,EAC9BC,UAAU,QACVC,eAAe,EAAE,CAACzD,gBAAgB,IAAIL,SAAS,KAAK,KAAM,EAC1D+D,cAAc,EAAE,CAAC1D,gBAAiB,EAClCsB,KAAK,EAAElD,WAAW,CAACkD,KAAK,IAAI,EAAG,EAC/BqC,QAAQ,EAAEjC,UAAW,EACrBkC,iBAAiB,EACftE,YAAY;UACR,MAAO,CAAAC,SAAS,oBAATA,SAAS,CAAEsE,OAAuB,KAAIC,QAAQ,CAACC,IAAI;UAC1D,CAACC,OAAoB,KAClB,CAAAA,OAAO,oBAAPA,OAAO,CAAEC,UAA0B,KAAIH,QAAQ,CAACC,IACxD,EACDlE,UAAU,EAAEA,UAAW,EACvBqE,IAAI,EAAEtE,WAAW,GAAG,UAAU,GAAG,QAAS,EAC1CuE,WAAW,EAAEpC,eAAgB,EAC7BqC,OAAO,EAAEA,CAAA,KAAMzC,QAAQ,CAAC,EAAE,CAAE,EAC5BA,QAAQ,EAAEA,QAAS,EACnB0C,MAAM,EAAExC,UAAW,EACnByC,OAAO,EAAEpF,gBAAiB,EAC1BqF,YAAY,EAAEvF,gBAAiB,EAC/BwF,YAAY,EAAEvF;UACd;UAAA,EACAoE,QAAQ,EAAEvB,YAAa,EACvB2C,GAAG,EAAEjF,QAAS,EACdkF,OAAO,EAAE7F,YAAa,EACtB8F,OAAO,EAAElF,oBAAoB,KAAKvC,oBAAoB,CAAC0H,UAAW,EAClEC,eAAe,EAAE/E,gBAAgB,IAAIe,mBAAoB,EACzD4B,OAAO,EAAEA,OAAQ,EACjBE,cAAc,EAAEA,cAAe,EAC/BmC,uBAAuB,EAAE1F,eAAgB,EACzCgE,SAAS,EAAC,kBAAkB,GAEhC;MAAa,CACf;IAAgB,CAClB;EAAmB,CAAC;AAExB,CAAC2B,aAAA,CA3SuBxG,kBAAkB,ikBAsCH3B,eAAe,sBAAAoI,cAAA,UAAAC,oBAAA,mBAAAA,oBAAA,CAAAC,OAAA,GAAA1D,SAAA,MAAAwD,cAAA,WAAAA,cAAA,CAAAG,QAAA,CAnF7CvH,OAAO,gHAAAoH,cAAA,CAAAG,QAAA,CA2BV9G,WAAW,oHAAA2G,cAAA,CAAAG,QAAA,CAkBO5G,kBAAkB,mJAAA6G,WAAA,UAAAH,oBAAA,mBAAAA,oBAAA,CAAAG,WAAA,GAAA5D,SAAA,CAAA4D,WAAA,IAAAA,WAAA,CAAAC,MAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}