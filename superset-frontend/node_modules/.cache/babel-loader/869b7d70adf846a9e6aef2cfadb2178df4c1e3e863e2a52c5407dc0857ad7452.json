{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { isFeatureEnabled, FeatureFlag, t, css } from '@superset-ui/core';\nimport { Link, useHistory } from 'react-router-dom';\nimport ConfirmStatusChange from 'src/components/ConfirmStatusChange';\nimport { Icons } from 'src/components/Icons';\nimport ListViewCard from 'src/components/ListViewCard';\nimport Label from 'src/components/Label';\nimport { Dropdown } from 'src/components/Dropdown';\nimport { Menu } from 'src/components/Menu';\nimport FaveStar from 'src/components/FaveStar';\nimport FacePile from 'src/components/FacePile';\nimport { handleChartDelete, CardStyles } from 'src/views/CRUD/utils';\nimport Button from 'src/components/Button';\nimport { assetUrl } from 'src/utils/assetUrl';import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"@emotion/react/jsx-runtime\";\nexport default function ChartCard({ chart, hasPerm, openChartEditModal, bulkSelectEnabled, addDangerToast, addSuccessToast, refreshData, loading, showThumbnails, saveFavoriteStatus, favoriteStatus, chartFilter, userId, handleBulkChartExport }) {\n  const history = useHistory();\n  const canEdit = hasPerm('can_write');\n  const canDelete = hasPerm('can_write');\n  const canExport = hasPerm('can_export');\n  const menu = _jsxs(Menu, { children: [\n    canEdit && _jsx(Menu.Item, { children:\n      _jsxs(\"div\", { \"data-test\": \"chart-list-edit-option\", role: \"button\", tabIndex: 0, onClick: () => openChartEditModal(chart), children: [\n        _jsx(Icons.EditOutlined, { iconSize: \"l\", css: css`\n                vertical-align: text-top;\n              ` }), ' ',\n        t('Edit')] }\n      ) }\n    ),\n    canExport && _jsx(Menu.Item, { children:\n      _jsxs(\"div\", { role: \"button\", tabIndex: 0, onClick: () => handleBulkChartExport([chart]), children: [\n        _jsx(Icons.UploadOutlined, { iconSize: \"l\", css: css`\n                vertical-align: text-top;\n              ` }), ' ',\n        t('Export')] }\n      ) }\n    ),\n    canDelete && _jsx(Menu.Item, { children:\n      _jsx(ConfirmStatusChange, { title: t('Please confirm'), description: _jsxs(_Fragment, { children: [\n          t('Are you sure you want to delete'), \" \", _jsx(\"b\", { children: chart.slice_name }), \"?\"] }\n\n        ), onConfirm: () => handleChartDelete(chart, addSuccessToast, addDangerToast, refreshData, chartFilter, userId), children:\n        (confirmDelete) => _jsxs(\"div\", { \"data-test\": \"chart-list-delete-option\", role: \"button\", tabIndex: 0, className: \"action-button\", onClick: confirmDelete, children: [\n          _jsx(Icons.DeleteOutlined, { iconSize: \"l\", css: css`\n                    vertical-align: text-top;\n                  ` }), ' ',\n          t('Delete')] }\n        ) }\n      ) }\n    )] }\n  );\n  return _jsx(CardStyles, { onClick: () => {\n      if (!bulkSelectEnabled && chart.url) {\n        history.push(chart.url);\n      }\n    }, children:\n    _jsx(ListViewCard, { loading: loading, title: chart.slice_name, certifiedBy: chart.certified_by, certificationDetails: chart.certification_details, cover: !isFeatureEnabled(FeatureFlag.Thumbnails) || !showThumbnails ? _jsx(_Fragment, {}) : null, url: bulkSelectEnabled ? undefined : chart.url, imgURL: chart.thumbnail_url || '', imgFallbackURL: assetUrl('/static/assets/images/chart-card-fallback.svg'), description: t('Modified %s', chart.changed_on_delta_humanized), coverLeft: _jsx(FacePile, { users: chart.owners || [] }), coverRight: _jsx(Label, { type: \"secondary\", children: chart.datasource_name_text }), linkComponent: Link, actions: _jsxs(ListViewCard.Actions, { onClick: (e) => {\n          e.stopPropagation();\n          e.preventDefault();\n        }, children: [\n        userId && _jsx(FaveStar, { itemId: chart.id, saveFaveStar: saveFavoriteStatus, isStarred: favoriteStatus }),\n        _jsx(Dropdown, { dropdownRender: () => menu, trigger: ['click', 'hover'], children:\n          _jsx(Button, { buttonSize: \"xsmall\", type: \"link\", children:\n            _jsx(Icons.MoreOutlined, { iconSize: \"xl\" }) }\n          ) }\n        )] }\n      ) }) }\n  );\n}__signature__(ChartCard, \"useHistory{history}\", () => [useHistory]);;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(ChartCard, \"ChartCard\", \"/Users/aryurkov/superset/superset-frontend/src/features/charts/ChartCard.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["isFeatureEnabled","FeatureFlag","t","css","Link","useHistory","ConfirmStatusChange","Icons","ListViewCard","Label","Dropdown","Menu","FaveStar","FacePile","handleChartDelete","CardStyles","Button","assetUrl","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ChartCard","chart","hasPerm","openChartEditModal","bulkSelectEnabled","addDangerToast","addSuccessToast","refreshData","loading","showThumbnails","saveFavoriteStatus","favoriteStatus","chartFilter","userId","handleBulkChartExport","history","canEdit","canDelete","canExport","menu","children","Item","role","tabIndex","onClick","EditOutlined","iconSize","UploadOutlined","title","description","slice_name","onConfirm","confirmDelete","className","DeleteOutlined","url","push","certifiedBy","certified_by","certificationDetails","certification_details","cover","Thumbnails","undefined","imgURL","thumbnail_url","imgFallbackURL","changed_on_delta_humanized","coverLeft","users","owners","coverRight","type","datasource_name_text","linkComponent","actions","Actions","e","stopPropagation","preventDefault","itemId","id","saveFaveStar","isStarred","dropdownRender","trigger","buttonSize","MoreOutlined","__signature__","reactHotLoader","reactHotLoaderGlobal","default","register","leaveModule","module"],"sources":["/Users/aryurkov/superset/superset-frontend/src/features/charts/ChartCard.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { isFeatureEnabled, FeatureFlag, t, css } from '@superset-ui/core';\nimport { Link, useHistory } from 'react-router-dom';\nimport ConfirmStatusChange from 'src/components/ConfirmStatusChange';\nimport { Icons } from 'src/components/Icons';\nimport Chart from 'src/types/Chart';\n\nimport ListViewCard from 'src/components/ListViewCard';\nimport Label from 'src/components/Label';\nimport { Dropdown } from 'src/components/Dropdown';\nimport { Menu } from 'src/components/Menu';\nimport FaveStar from 'src/components/FaveStar';\nimport FacePile from 'src/components/FacePile';\nimport { handleChartDelete, CardStyles } from 'src/views/CRUD/utils';\nimport Button from 'src/components/Button';\nimport { assetUrl } from 'src/utils/assetUrl';\n\ninterface ChartCardProps {\n  chart: Chart;\n  hasPerm: (perm: string) => boolean;\n  openChartEditModal: (chart: Chart) => void;\n  bulkSelectEnabled: boolean;\n  addDangerToast: (msg: string) => void;\n  addSuccessToast: (msg: string) => void;\n  refreshData: () => void;\n  loading?: boolean;\n  saveFavoriteStatus: (id: number, isStarred: boolean) => void;\n  favoriteStatus: boolean;\n  chartFilter?: string;\n  userId?: string | number;\n  showThumbnails?: boolean;\n  handleBulkChartExport: (chartsToExport: Chart[]) => void;\n}\n\nexport default function ChartCard({\n  chart,\n  hasPerm,\n  openChartEditModal,\n  bulkSelectEnabled,\n  addDangerToast,\n  addSuccessToast,\n  refreshData,\n  loading,\n  showThumbnails,\n  saveFavoriteStatus,\n  favoriteStatus,\n  chartFilter,\n  userId,\n  handleBulkChartExport,\n}: ChartCardProps) {\n  const history = useHistory();\n  const canEdit = hasPerm('can_write');\n  const canDelete = hasPerm('can_write');\n  const canExport = hasPerm('can_export');\n  const menu = (\n    <Menu>\n      {canEdit && (\n        <Menu.Item>\n          <div\n            data-test=\"chart-list-edit-option\"\n            role=\"button\"\n            tabIndex={0}\n            onClick={() => openChartEditModal(chart)}\n          >\n            <Icons.EditOutlined\n              iconSize=\"l\"\n              css={css`\n                vertical-align: text-top;\n              `}\n            />{' '}\n            {t('Edit')}\n          </div>\n        </Menu.Item>\n      )}\n      {canExport && (\n        <Menu.Item>\n          <div\n            role=\"button\"\n            tabIndex={0}\n            onClick={() => handleBulkChartExport([chart])}\n          >\n            <Icons.UploadOutlined\n              iconSize=\"l\"\n              css={css`\n                vertical-align: text-top;\n              `}\n            />{' '}\n            {t('Export')}\n          </div>\n        </Menu.Item>\n      )}\n      {canDelete && (\n        <Menu.Item>\n          <ConfirmStatusChange\n            title={t('Please confirm')}\n            description={\n              <>\n                {t('Are you sure you want to delete')} <b>{chart.slice_name}</b>\n                ?\n              </>\n            }\n            onConfirm={() =>\n              handleChartDelete(\n                chart,\n                addSuccessToast,\n                addDangerToast,\n                refreshData,\n                chartFilter,\n                userId,\n              )\n            }\n          >\n            {confirmDelete => (\n              <div\n                data-test=\"chart-list-delete-option\"\n                role=\"button\"\n                tabIndex={0}\n                className=\"action-button\"\n                onClick={confirmDelete}\n              >\n                <Icons.DeleteOutlined\n                  iconSize=\"l\"\n                  css={css`\n                    vertical-align: text-top;\n                  `}\n                />{' '}\n                {t('Delete')}\n              </div>\n            )}\n          </ConfirmStatusChange>\n        </Menu.Item>\n      )}\n    </Menu>\n  );\n  return (\n    <CardStyles\n      onClick={() => {\n        if (!bulkSelectEnabled && chart.url) {\n          history.push(chart.url);\n        }\n      }}\n    >\n      <ListViewCard\n        loading={loading}\n        title={chart.slice_name}\n        certifiedBy={chart.certified_by}\n        certificationDetails={chart.certification_details}\n        cover={\n          !isFeatureEnabled(FeatureFlag.Thumbnails) || !showThumbnails ? (\n            <></>\n          ) : null\n        }\n        url={bulkSelectEnabled ? undefined : chart.url}\n        imgURL={chart.thumbnail_url || ''}\n        imgFallbackURL={assetUrl(\n          '/static/assets/images/chart-card-fallback.svg',\n        )}\n        description={t('Modified %s', chart.changed_on_delta_humanized)}\n        coverLeft={<FacePile users={chart.owners || []} />}\n        coverRight={\n          <Label type=\"secondary\">{chart.datasource_name_text}</Label>\n        }\n        linkComponent={Link}\n        actions={\n          <ListViewCard.Actions\n            onClick={e => {\n              e.stopPropagation();\n              e.preventDefault();\n            }}\n          >\n            {userId && (\n              <FaveStar\n                itemId={chart.id}\n                saveFaveStar={saveFavoriteStatus}\n                isStarred={favoriteStatus}\n              />\n            )}\n            <Dropdown dropdownRender={() => menu} trigger={['click', 'hover']}>\n              <Button buttonSize=\"xsmall\" type=\"link\">\n                <Icons.MoreOutlined iconSize=\"xl\" />\n              </Button>\n            </Dropdown>\n          </ListViewCard.Actions>\n        }\n      />\n    </CardStyles>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}