{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport parseCookie from 'src/utils/parseCookie';\nimport rison from 'rison';\nimport { nanoid } from 'nanoid';\nimport { ensureAppRoot } from './pathUtils';\nexport default function handleResourceExport(resource, ids, done, interval = 200) {\n  const token = nanoid();\n  const url = ensureAppRoot(`/api/v1/${resource}/export/?q=${rison.encode(ids)}&token=${token}`);\n  // create new iframe for export\n  const iframe = document.createElement('iframe');\n  iframe.style.display = 'none';\n  iframe.src = url;\n  document.body.appendChild(iframe);\n  const timer = window.setInterval(() => {\n    const cookie = parseCookie();\n    if (cookie[token] === 'done') {\n      window.clearInterval(timer);\n      document.body.removeChild(iframe);\n      done();\n    }\n  }, interval);\n};(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(handleResourceExport, \"handleResourceExport\", \"/Users/aryurkov/superset/superset-frontend/src/utils/export.ts\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["parseCookie","rison","nanoid","ensureAppRoot","handleResourceExport","resource","ids","done","interval","token","url","encode","iframe","document","createElement","style","display","src","body","appendChild","timer","window","setInterval","cookie","clearInterval","removeChild","reactHotLoader","reactHotLoaderGlobal","default","undefined","register","leaveModule","module"],"sources":["/Users/aryurkov/superset/superset-frontend/src/utils/export.ts"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport parseCookie from 'src/utils/parseCookie';\nimport rison from 'rison';\nimport { nanoid } from 'nanoid';\nimport { ensureAppRoot } from './pathUtils';\n\nexport default function handleResourceExport(\n  resource: string,\n  ids: number[],\n  done: () => void,\n  interval = 200,\n): void {\n  const token = nanoid();\n  const url = ensureAppRoot(\n    `/api/v1/${resource}/export/?q=${rison.encode(ids)}&token=${token}`,\n  );\n\n  // create new iframe for export\n  const iframe = document.createElement('iframe');\n  iframe.style.display = 'none';\n  iframe.src = url;\n  document.body.appendChild(iframe);\n\n  const timer = window.setInterval(() => {\n    const cookie: { [cookieId: string]: string } = parseCookie();\n    if (cookie[token] === 'done') {\n      window.clearInterval(timer);\n      document.body.removeChild(iframe);\n      done();\n    }\n  }, interval);\n}\n"],"mappings":"wSAAA;;;;;;;;;;;;;;;;;;AAkBA,OAAOA,WAAW,MAAM,uBAAuB;AAC/C,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,MAAM,QAAQ,QAAQ;AAC/B,SAASC,aAAa,QAAQ,aAAa;AAE3C,eAAc,SAAUC,oBAAoBA,CAC1CC,QAAgB,EAChBC,GAAa,EACbC,IAAgB,EAChBC,QAAQ,GAAG,GAAG;EAEd,MAAMC,KAAK,GAAGP,MAAM,EAAE;EACtB,MAAMQ,GAAG,GAAGP,aAAa,CACvB,WAAWE,QAAQ,cAAcJ,KAAK,CAACU,MAAM,CAACL,GAAG,CAAC,UAAUG,KAAK,EAAE,CACpE;EAED;EACA,MAAMG,MAAM,GAAGC,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC;EAC/CF,MAAM,CAACG,KAAK,CAACC,OAAO,GAAG,MAAM;EAC7BJ,MAAM,CAACK,GAAG,GAAGP,GAAG;EAChBG,QAAQ,CAACK,IAAI,CAACC,WAAW,CAACP,MAAM,CAAC;EAEjC,MAAMQ,KAAK,GAAGC,MAAM,CAACC,WAAW,CAAC,MAAK;IACpC,MAAMC,MAAM,GAAmCvB,WAAW,EAAE;IAC5D,IAAIuB,MAAM,CAACd,KAAK,CAAC,KAAK,MAAM,EAAE;MAC5BY,MAAM,CAACG,aAAa,CAACJ,KAAK,CAAC;MAC3BP,QAAQ,CAACK,IAAI,CAACO,WAAW,CAACb,MAAM,CAAC;MACjCL,IAAI,EAAE;;EAEV,CAAC,EAAEC,QAAQ,CAAC;AACd,CAAC,mBAAAkB,cAAA,UAAAC,oBAAA,mBAAAA,oBAAA,CAAAC,OAAA,GAAAC,SAAA,MAAAH,cAAA,WAAAA,cAAA,CAAAI,QAAA,CAzBuB1B,oBAAoB,oHAAA2B,WAAA,UAAAJ,oBAAA,mBAAAA,oBAAA,CAAAI,WAAA,GAAAF,SAAA,CAAAE,WAAA,IAAAA,WAAA,CAAAC,MAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}