{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-disable camelcase */\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { isAdhocColumn, t, styled, css, DatasourceType } from '@superset-ui/core';\nimport { isSavedExpression } from '@superset-ui/chart-controls';\nimport Tabs from 'src/components/Tabs';\nimport Button from 'src/components/Button';\nimport { Select } from 'src/components';\nimport { Form, FormItem } from 'src/components/Form';\nimport sqlKeywords from 'src/SqlLab/utils/sqlKeywords';\nimport { SQLEditor } from 'src/components/AsyncAceEditor';\nimport { EmptyState } from 'src/components/EmptyState';\nimport { getColumnKeywords } from 'src/explore/controlUtils/getColumnKeywords';\nimport { StyledColumnOption } from 'src/explore/components/optionRenderers';\nimport { POPOVER_INITIAL_HEIGHT, POPOVER_INITIAL_WIDTH } from 'src/explore/constants';\nimport useResizeButton from './useResizeButton';import { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nconst StyledSelect = styled(Select)`\n  .metric-option {\n    & > svg {\n      min-width: ${({ theme }) => `${theme.gridUnit * 4}px`};\n    }\n    & > .option-label {\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n  }\n`;\nconst getInitialColumnValues = (editedColumn) => {\n  if (!editedColumn) {\n    return [undefined, undefined, undefined];\n  }\n  if (isAdhocColumn(editedColumn)) {\n    return [editedColumn, undefined, undefined];\n  }\n  if (isSavedExpression(editedColumn)) {\n    return [undefined, editedColumn, undefined];\n  }\n  return [undefined, undefined, editedColumn];\n};\nconst ColumnSelectPopover = ({ columns, editedColumn, getCurrentTab, hasCustomLabel, isTemporal, label, onChange, onClose, setDatasetModal, setLabel, disabledTabs = new Set() }) => {\n  const datasourceType = useSelector((state) => state.explore.datasource.type);\n  const [initialLabel] = useState(label);\n  const [initialAdhocColumn, initialCalculatedColumn, initialSimpleColumn] = getInitialColumnValues(editedColumn);\n  const [adhocColumn, setAdhocColumn] = useState(initialAdhocColumn);\n  const [selectedCalculatedColumn, setSelectedCalculatedColumn] = useState(initialCalculatedColumn);\n  const [selectedSimpleColumn, setSelectedSimpleColumn] = useState(initialSimpleColumn);\n  const [selectedTab, setSelectedTab] = useState(null);\n  const [resizeButton, width, height] = useResizeButton(POPOVER_INITIAL_WIDTH, POPOVER_INITIAL_HEIGHT);\n  const sqlEditorRef = useRef(null);\n  const [calculatedColumns, simpleColumns] = useMemo(() => columns == null ? void 0 : columns.reduce((acc, column) => {\n    if (column.expression) {\n      acc[0].push(column);\n    } else\n    {\n      acc[1].push(column);\n    }\n    return acc;\n  }, [[], []]), [columns]);\n  const onSqlExpressionChange = useCallback((sqlExpression) => {\n    setAdhocColumn({ label, sqlExpression, expressionType: 'SQL' });\n    setSelectedSimpleColumn(undefined);\n    setSelectedCalculatedColumn(undefined);\n  }, [label]);\n  const onCalculatedColumnChange = useCallback((selectedColumnName) => {\n    const selectedColumn = calculatedColumns.find((col) => col.column_name === selectedColumnName);\n    setSelectedCalculatedColumn(selectedColumn);\n    setSelectedSimpleColumn(undefined);\n    setAdhocColumn(undefined);\n    setLabel((selectedColumn == null ? void 0 : selectedColumn.verbose_name) || (selectedColumn == null ? void 0 : selectedColumn.column_name) || '');\n  }, [calculatedColumns, setLabel]);\n  const onSimpleColumnChange = useCallback((selectedColumnName) => {\n    const selectedColumn = simpleColumns.find((col) => col.column_name === selectedColumnName);\n    setSelectedCalculatedColumn(undefined);\n    setSelectedSimpleColumn(selectedColumn);\n    setAdhocColumn(undefined);\n    setLabel((selectedColumn == null ? void 0 : selectedColumn.verbose_name) || (selectedColumn == null ? void 0 : selectedColumn.column_name) || '');\n  }, [setLabel, simpleColumns]);\n  const defaultActiveTabKey = initialAdhocColumn ?\n  'sqlExpression' :\n  selectedCalculatedColumn ?\n  'saved' :\n  'simple';\n  useEffect(() => {\n    getCurrentTab(defaultActiveTabKey);\n    setSelectedTab(defaultActiveTabKey);\n  }, [defaultActiveTabKey, getCurrentTab, setSelectedTab]);\n  useEffect(() => {\n    /* if the adhoc column is not set (because it was never edited) but the\n     * tab is selected and the label has changed, then we need to set the\n     * adhoc column manually */\n    if (adhocColumn === undefined &&\n    selectedTab === 'sqlExpression' &&\n    hasCustomLabel) {\n      const sqlExpression = (selectedSimpleColumn == null ? void 0 : selectedSimpleColumn.column_name) || (\n      selectedCalculatedColumn == null ? void 0 : selectedCalculatedColumn.expression) ||\n      '';\n      setAdhocColumn({ label, sqlExpression, expressionType: 'SQL' });\n    }\n  }, [\n  adhocColumn,\n  defaultActiveTabKey,\n  hasCustomLabel,\n  getCurrentTab,\n  label,\n  selectedCalculatedColumn,\n  selectedSimpleColumn,\n  selectedTab]\n  );\n  const onSave = useCallback(() => {\n    if (adhocColumn && adhocColumn.label !== label) {\n      adhocColumn.label = label;\n    }\n    const selectedColumn = adhocColumn || selectedCalculatedColumn || selectedSimpleColumn;\n    if (!selectedColumn) {\n      return;\n    }\n    onChange(selectedColumn);\n    onClose();\n  }, [\n  adhocColumn,\n  label,\n  onChange,\n  onClose,\n  selectedCalculatedColumn,\n  selectedSimpleColumn]\n  );\n  const onResetStateAndClose = useCallback(() => {\n    setSelectedCalculatedColumn(initialCalculatedColumn);\n    setSelectedSimpleColumn(initialSimpleColumn);\n    setAdhocColumn(initialAdhocColumn);\n    onClose();\n  }, [\n  initialAdhocColumn,\n  initialCalculatedColumn,\n  initialSimpleColumn,\n  onClose]\n  );\n  const onTabChange = useCallback((tab) => {var _sqlEditorRef$current;\n    getCurrentTab(tab);\n    setSelectedTab(tab);\n    // @ts-ignore\n    (_sqlEditorRef$current = sqlEditorRef.current) == null ? void 0 : _sqlEditorRef$current.editor.focus();\n  }, [getCurrentTab]);\n  const onSqlEditorFocus = useCallback(() => {var _sqlEditorRef$current2;\n    // @ts-ignore\n    (_sqlEditorRef$current2 = sqlEditorRef.current) == null ? void 0 : _sqlEditorRef$current2.editor.resize();\n  }, []);\n  const setDatasetAndClose = () => {\n    if (setDatasetModal) {\n      setDatasetModal(true);\n    }\n    onClose();\n  };\n  const stateIsValid = adhocColumn || selectedCalculatedColumn || selectedSimpleColumn;\n  const hasUnsavedChanges = initialLabel !== label ||\n  (selectedCalculatedColumn == null ? void 0 : selectedCalculatedColumn.column_name) !== (\n  initialCalculatedColumn == null ? void 0 : initialCalculatedColumn.column_name) ||\n  (selectedSimpleColumn == null ? void 0 : selectedSimpleColumn.column_name) !== (initialSimpleColumn == null ? void 0 : initialSimpleColumn.column_name) ||\n  (adhocColumn == null ? void 0 : adhocColumn.sqlExpression) !== (initialAdhocColumn == null ? void 0 : initialAdhocColumn.sqlExpression);\n  const savedExpressionsLabel = t('Saved expressions');\n  const simpleColumnsLabel = t('Column');\n  const keywords = useMemo(() => sqlKeywords.concat(getColumnKeywords(columns)), [columns]);\n  return _jsxs(Form, { layout: \"vertical\", id: \"metrics-edit-popover\", children: [\n    _jsxs(Tabs, { id: \"adhoc-metric-edit-tabs\", defaultActiveKey: defaultActiveTabKey, onChange: onTabChange, className: \"adhoc-metric-edit-tabs\", allowOverflow: true, css: css`\n          height: ${height}px;\n          width: ${width}px;\n        `, children: [\n      _jsx(Tabs.TabPane, { tab: t('Saved'), disabled: disabledTabs.has('saved'), children:\n        calculatedColumns.length > 0 ? _jsx(FormItem, { label: savedExpressionsLabel, children:\n          _jsx(StyledSelect, { ariaLabel: savedExpressionsLabel, value: selectedCalculatedColumn == null ? void 0 : selectedCalculatedColumn.column_name, onChange: onCalculatedColumnChange, allowClear: true, autoFocus: !selectedCalculatedColumn, placeholder: t('%s column(s)', calculatedColumns.length), options: calculatedColumns.map((calculatedColumn) => ({\n              value: calculatedColumn.column_name,\n              label: calculatedColumn.verbose_name ||\n              calculatedColumn.column_name,\n              customLabel: _jsx(StyledColumnOption, { column: calculatedColumn, showType: true }),\n              key: calculatedColumn.column_name\n            })) }) }\n        ) : datasourceType === DatasourceType.Table ? _jsx(EmptyState, { image: \"empty.svg\", size: \"small\", title: isTemporal ?\n          t('No temporal columns found') :\n          t('No saved expressions found'), description: isTemporal ?\n          t('Add calculated temporal columns to dataset in \"Edit datasource\" modal') :\n          t('Add calculated columns to dataset in \"Edit datasource\" modal') }) : _jsx(EmptyState, { image: \"empty.svg\", size: \"small\", title: isTemporal ?\n          t('No temporal columns found') :\n          t('No saved expressions found'), description: isTemporal ? _jsxs(_Fragment, { children: [\n            _jsx(\"span\", { role: \"button\", tabIndex: 0, onClick: setDatasetAndClose, children:\n              t('Create a dataset') }\n            ), ' ',\n            t(' to mark a column as a time column')] }\n          ) : _jsxs(_Fragment, { children: [\n            _jsx(\"span\", { role: \"button\", tabIndex: 0, onClick: setDatasetAndClose, children:\n              t('Create a dataset') }\n            ), ' ',\n            t(' to add calculated columns')] }\n          ) }) }, \"saved\"\n      ),\n      _jsx(Tabs.TabPane, { tab: t('Simple'), disabled: disabledTabs.has('simple'), children:\n        isTemporal && simpleColumns.length === 0 ? _jsx(EmptyState, { image: \"empty.svg\", size: \"small\", title: t('No temporal columns found'), description: datasourceType === DatasourceType.Table ? t('Mark a column as temporal in \"Edit datasource\" modal') : _jsxs(_Fragment, { children: [\n            _jsx(\"span\", { role: \"button\", tabIndex: 0, onClick: setDatasetAndClose, children:\n              t('Create a dataset') }\n            ), ' ',\n            t(' to mark a column as a time column')] }\n          ) }) : _jsx(FormItem, { label: simpleColumnsLabel, children:\n          _jsx(Select, { ariaLabel: simpleColumnsLabel, value: selectedSimpleColumn == null ? void 0 : selectedSimpleColumn.column_name, onChange: onSimpleColumnChange, allowClear: true, autoFocus: !selectedSimpleColumn, placeholder: t('%s column(s)', simpleColumns.length), options: simpleColumns.map((simpleColumn) => ({\n              value: simpleColumn.column_name,\n              label: simpleColumn.verbose_name || simpleColumn.column_name,\n              customLabel: _jsx(StyledColumnOption, { column: simpleColumn, showType: true }),\n              key: simpleColumn.column_name\n            })) }) }\n        ) }, \"simple\"\n      ),\n\n      _jsx(Tabs.TabPane, { tab: t('Custom SQL'), disabled: disabledTabs.has('sqlExpression'), children:\n        _jsx(SQLEditor, { value: (adhocColumn == null ? void 0 : adhocColumn.sqlExpression) || (\n          selectedSimpleColumn == null ? void 0 : selectedSimpleColumn.column_name) || (\n          selectedCalculatedColumn == null ? void 0 : selectedCalculatedColumn.expression), onFocus: onSqlEditorFocus, showLoadingForImport: true, onChange: onSqlExpressionChange, width: \"100%\", height: `${height - 80}px`, showGutter: false, editorProps: { $blockScrolling: true }, enableLiveAutocompletion: true, className: \"filter-sql-editor\", wrapEnabled: true, ref: sqlEditorRef, keywords: keywords }) }, \"sqlExpression\"\n      )] }\n    ),\n    _jsxs(\"div\", { children: [\n      _jsx(Button, { buttonSize: \"small\", onClick: onResetStateAndClose, cta: true, children:\n        t('Close') }\n      ),\n      _jsx(Button, { disabled: !stateIsValid || !hasUnsavedChanges, buttonStyle: \"primary\", buttonSize: \"small\", onClick: onSave, \"data-test\": \"ColumnEdit#save\", cta: true, children:\n        t('Save') }\n      ),\n      resizeButton] }\n    )] }\n  );\n};__signature__(ColumnSelectPopover, \"useSelector{datasourceType}\\nuseState{[initialLabel](label)}\\nuseState{[adhocColumn, setAdhocColumn](initialAdhocColumn)}\\nuseState{[selectedCalculatedColumn, setSelectedCalculatedColumn](initialCalculatedColumn)}\\nuseState{[selectedSimpleColumn, setSelectedSimpleColumn](initialSimpleColumn)}\\nuseState{[selectedTab, setSelectedTab](null)}\\nuseResizeButton{[resizeButton, width, height]}\\nuseRef{sqlEditorRef}\\nuseMemo{[calculatedColumns, simpleColumns]}\\nuseCallback{onSqlExpressionChange}\\nuseCallback{onCalculatedColumnChange}\\nuseCallback{onSimpleColumnChange}\\nuseEffect{}\\nuseEffect{}\\nuseCallback{onSave}\\nuseCallback{onResetStateAndClose}\\nuseCallback{onTabChange}\\nuseCallback{onSqlEditorFocus}\\nuseMemo{keywords}\", () => [useSelector, useResizeButton]);const _default =\nColumnSelectPopover;export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(StyledSelect, \"StyledSelect\", \"/Users/aryurkov/superset/superset-frontend/src/explore/components/controls/DndColumnSelectControl/ColumnSelectPopover.tsx\");reactHotLoader.register(getInitialColumnValues, \"getInitialColumnValues\", \"/Users/aryurkov/superset/superset-frontend/src/explore/components/controls/DndColumnSelectControl/ColumnSelectPopover.tsx\");reactHotLoader.register(ColumnSelectPopover, \"ColumnSelectPopover\", \"/Users/aryurkov/superset/superset-frontend/src/explore/components/controls/DndColumnSelectControl/ColumnSelectPopover.tsx\");reactHotLoader.register(_default, \"default\", \"/Users/aryurkov/superset/superset-frontend/src/explore/components/controls/DndColumnSelectControl/ColumnSelectPopover.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"names":["useCallback","useEffect","useMemo","useRef","useState","useSelector","isAdhocColumn","t","styled","css","DatasourceType","isSavedExpression","Tabs","Button","Select","Form","FormItem","sqlKeywords","SQLEditor","EmptyState","getColumnKeywords","StyledColumnOption","POPOVER_INITIAL_HEIGHT","POPOVER_INITIAL_WIDTH","useResizeButton","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","StyledSelect","theme","gridUnit","getInitialColumnValues","editedColumn","undefined","ColumnSelectPopover","columns","getCurrentTab","hasCustomLabel","isTemporal","label","onChange","onClose","setDatasetModal","setLabel","disabledTabs","Set","datasourceType","state","explore","datasource","type","initialLabel","initialAdhocColumn","initialCalculatedColumn","initialSimpleColumn","adhocColumn","setAdhocColumn","selectedCalculatedColumn","setSelectedCalculatedColumn","selectedSimpleColumn","setSelectedSimpleColumn","selectedTab","setSelectedTab","resizeButton","width","height","sqlEditorRef","calculatedColumns","simpleColumns","reduce","acc","column","expression","push","onSqlExpressionChange","sqlExpression","expressionType","onCalculatedColumnChange","selectedColumnName","selectedColumn","find","col","column_name","verbose_name","onSimpleColumnChange","defaultActiveTabKey","onSave","onResetStateAndClose","onTabChange","tab","_sqlEditorRef$current","current","editor","focus","onSqlEditorFocus","_sqlEditorRef$current2","resize","setDatasetAndClose","stateIsValid","hasUnsavedChanges","savedExpressionsLabel","simpleColumnsLabel","keywords","concat","layout","id","children","defaultActiveKey","className","allowOverflow","TabPane","disabled","has","length","ariaLabel","value","allowClear","autoFocus","placeholder","options","map","calculatedColumn","customLabel","showType","key","Table","image","size","title","description","role","tabIndex","onClick","simpleColumn","onFocus","showLoadingForImport","showGutter","editorProps","$blockScrolling","enableLiveAutocompletion","wrapEnabled","ref","buttonSize","cta","buttonStyle","__signature__","_default","reactHotLoader","reactHotLoaderGlobal","default","register","leaveModule","module"],"sources":["/Users/aryurkov/superset/superset-frontend/src/explore/components/controls/DndColumnSelectControl/ColumnSelectPopover.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-disable camelcase */\nimport {\n  Dispatch,\n  SetStateAction,\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport { useSelector } from 'react-redux';\nimport {\n  AdhocColumn,\n  isAdhocColumn,\n  t,\n  styled,\n  css,\n  DatasourceType,\n} from '@superset-ui/core';\nimport { ColumnMeta, isSavedExpression } from '@superset-ui/chart-controls';\nimport Tabs from 'src/components/Tabs';\nimport Button from 'src/components/Button';\nimport { Select } from 'src/components';\n\nimport { Form, FormItem } from 'src/components/Form';\nimport sqlKeywords from 'src/SqlLab/utils/sqlKeywords';\nimport { SQLEditor } from 'src/components/AsyncAceEditor';\nimport { EmptyState } from 'src/components/EmptyState';\nimport { getColumnKeywords } from 'src/explore/controlUtils/getColumnKeywords';\nimport { StyledColumnOption } from 'src/explore/components/optionRenderers';\nimport {\n  POPOVER_INITIAL_HEIGHT,\n  POPOVER_INITIAL_WIDTH,\n} from 'src/explore/constants';\nimport { ExplorePageState } from 'src/explore/types';\nimport useResizeButton from './useResizeButton';\n\nconst StyledSelect = styled(Select)`\n  .metric-option {\n    & > svg {\n      min-width: ${({ theme }) => `${theme.gridUnit * 4}px`};\n    }\n    & > .option-label {\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n  }\n`;\n\nexport interface ColumnSelectPopoverProps {\n  columns: ColumnMeta[];\n  editedColumn?: ColumnMeta | AdhocColumn;\n  onChange: (column: ColumnMeta | AdhocColumn) => void;\n  onClose: () => void;\n  hasCustomLabel: boolean;\n  setLabel: (title: string) => void;\n  getCurrentTab: (tab: string) => void;\n  label: string;\n  isTemporal?: boolean;\n  setDatasetModal?: Dispatch<SetStateAction<boolean>>;\n  disabledTabs?: Set<string>;\n}\n\nconst getInitialColumnValues = (\n  editedColumn?: ColumnMeta | AdhocColumn,\n): [AdhocColumn?, ColumnMeta?, ColumnMeta?] => {\n  if (!editedColumn) {\n    return [undefined, undefined, undefined];\n  }\n  if (isAdhocColumn(editedColumn)) {\n    return [editedColumn, undefined, undefined];\n  }\n  if (isSavedExpression(editedColumn)) {\n    return [undefined, editedColumn, undefined];\n  }\n  return [undefined, undefined, editedColumn];\n};\n\nconst ColumnSelectPopover = ({\n  columns,\n  editedColumn,\n  getCurrentTab,\n  hasCustomLabel,\n  isTemporal,\n  label,\n  onChange,\n  onClose,\n  setDatasetModal,\n  setLabel,\n  disabledTabs = new Set<'saved' | 'simple' | 'sqlExpression'>(),\n}: ColumnSelectPopoverProps) => {\n  const datasourceType = useSelector<ExplorePageState, string | undefined>(\n    state => state.explore.datasource.type,\n  );\n  const [initialLabel] = useState(label);\n  const [initialAdhocColumn, initialCalculatedColumn, initialSimpleColumn] =\n    getInitialColumnValues(editedColumn);\n\n  const [adhocColumn, setAdhocColumn] = useState<AdhocColumn | undefined>(\n    initialAdhocColumn,\n  );\n  const [selectedCalculatedColumn, setSelectedCalculatedColumn] = useState<\n    ColumnMeta | undefined\n  >(initialCalculatedColumn);\n  const [selectedSimpleColumn, setSelectedSimpleColumn] = useState<\n    ColumnMeta | undefined\n  >(initialSimpleColumn);\n  const [selectedTab, setSelectedTab] = useState<string | null>(null);\n\n  const [resizeButton, width, height] = useResizeButton(\n    POPOVER_INITIAL_WIDTH,\n    POPOVER_INITIAL_HEIGHT,\n  );\n\n  const sqlEditorRef = useRef(null);\n\n  const [calculatedColumns, simpleColumns] = useMemo(\n    () =>\n      columns?.reduce(\n        (acc: [ColumnMeta[], ColumnMeta[]], column: ColumnMeta) => {\n          if (column.expression) {\n            acc[0].push(column);\n          } else {\n            acc[1].push(column);\n          }\n          return acc;\n        },\n        [[], []],\n      ),\n    [columns],\n  );\n\n  const onSqlExpressionChange = useCallback(\n    sqlExpression => {\n      setAdhocColumn({ label, sqlExpression, expressionType: 'SQL' });\n      setSelectedSimpleColumn(undefined);\n      setSelectedCalculatedColumn(undefined);\n    },\n    [label],\n  );\n\n  const onCalculatedColumnChange = useCallback(\n    selectedColumnName => {\n      const selectedColumn = calculatedColumns.find(\n        col => col.column_name === selectedColumnName,\n      );\n      setSelectedCalculatedColumn(selectedColumn);\n      setSelectedSimpleColumn(undefined);\n      setAdhocColumn(undefined);\n      setLabel(\n        selectedColumn?.verbose_name || selectedColumn?.column_name || '',\n      );\n    },\n    [calculatedColumns, setLabel],\n  );\n\n  const onSimpleColumnChange = useCallback(\n    selectedColumnName => {\n      const selectedColumn = simpleColumns.find(\n        col => col.column_name === selectedColumnName,\n      );\n      setSelectedCalculatedColumn(undefined);\n      setSelectedSimpleColumn(selectedColumn);\n      setAdhocColumn(undefined);\n      setLabel(\n        selectedColumn?.verbose_name || selectedColumn?.column_name || '',\n      );\n    },\n    [setLabel, simpleColumns],\n  );\n\n  const defaultActiveTabKey = initialAdhocColumn\n    ? 'sqlExpression'\n    : selectedCalculatedColumn\n      ? 'saved'\n      : 'simple';\n\n  useEffect(() => {\n    getCurrentTab(defaultActiveTabKey);\n    setSelectedTab(defaultActiveTabKey);\n  }, [defaultActiveTabKey, getCurrentTab, setSelectedTab]);\n\n  useEffect(() => {\n    /* if the adhoc column is not set (because it was never edited) but the\n     * tab is selected and the label has changed, then we need to set the\n     * adhoc column manually */\n    if (\n      adhocColumn === undefined &&\n      selectedTab === 'sqlExpression' &&\n      hasCustomLabel\n    ) {\n      const sqlExpression =\n        selectedSimpleColumn?.column_name ||\n        selectedCalculatedColumn?.expression ||\n        '';\n      setAdhocColumn({ label, sqlExpression, expressionType: 'SQL' });\n    }\n  }, [\n    adhocColumn,\n    defaultActiveTabKey,\n    hasCustomLabel,\n    getCurrentTab,\n    label,\n    selectedCalculatedColumn,\n    selectedSimpleColumn,\n    selectedTab,\n  ]);\n\n  const onSave = useCallback(() => {\n    if (adhocColumn && adhocColumn.label !== label) {\n      adhocColumn.label = label;\n    }\n    const selectedColumn =\n      adhocColumn || selectedCalculatedColumn || selectedSimpleColumn;\n    if (!selectedColumn) {\n      return;\n    }\n    onChange(selectedColumn);\n    onClose();\n  }, [\n    adhocColumn,\n    label,\n    onChange,\n    onClose,\n    selectedCalculatedColumn,\n    selectedSimpleColumn,\n  ]);\n\n  const onResetStateAndClose = useCallback(() => {\n    setSelectedCalculatedColumn(initialCalculatedColumn);\n    setSelectedSimpleColumn(initialSimpleColumn);\n    setAdhocColumn(initialAdhocColumn);\n    onClose();\n  }, [\n    initialAdhocColumn,\n    initialCalculatedColumn,\n    initialSimpleColumn,\n    onClose,\n  ]);\n\n  const onTabChange = useCallback(\n    tab => {\n      getCurrentTab(tab);\n      setSelectedTab(tab);\n      // @ts-ignore\n      sqlEditorRef.current?.editor.focus();\n    },\n    [getCurrentTab],\n  );\n\n  const onSqlEditorFocus = useCallback(() => {\n    // @ts-ignore\n    sqlEditorRef.current?.editor.resize();\n  }, []);\n\n  const setDatasetAndClose = () => {\n    if (setDatasetModal) {\n      setDatasetModal(true);\n    }\n    onClose();\n  };\n\n  const stateIsValid =\n    adhocColumn || selectedCalculatedColumn || selectedSimpleColumn;\n  const hasUnsavedChanges =\n    initialLabel !== label ||\n    selectedCalculatedColumn?.column_name !==\n      initialCalculatedColumn?.column_name ||\n    selectedSimpleColumn?.column_name !== initialSimpleColumn?.column_name ||\n    adhocColumn?.sqlExpression !== initialAdhocColumn?.sqlExpression;\n\n  const savedExpressionsLabel = t('Saved expressions');\n  const simpleColumnsLabel = t('Column');\n  const keywords = useMemo(\n    () => sqlKeywords.concat(getColumnKeywords(columns)),\n    [columns],\n  );\n\n  return (\n    <Form layout=\"vertical\" id=\"metrics-edit-popover\">\n      <Tabs\n        id=\"adhoc-metric-edit-tabs\"\n        defaultActiveKey={defaultActiveTabKey}\n        onChange={onTabChange}\n        className=\"adhoc-metric-edit-tabs\"\n        allowOverflow\n        css={css`\n          height: ${height}px;\n          width: ${width}px;\n        `}\n      >\n        <Tabs.TabPane\n          key=\"saved\"\n          tab={t('Saved')}\n          disabled={disabledTabs.has('saved')}\n        >\n          {calculatedColumns.length > 0 ? (\n            <FormItem label={savedExpressionsLabel}>\n              <StyledSelect\n                ariaLabel={savedExpressionsLabel}\n                value={selectedCalculatedColumn?.column_name}\n                onChange={onCalculatedColumnChange}\n                allowClear\n                autoFocus={!selectedCalculatedColumn}\n                placeholder={t('%s column(s)', calculatedColumns.length)}\n                options={calculatedColumns.map(calculatedColumn => ({\n                  value: calculatedColumn.column_name,\n                  label:\n                    calculatedColumn.verbose_name ||\n                    calculatedColumn.column_name,\n                  customLabel: (\n                    <StyledColumnOption column={calculatedColumn} showType />\n                  ),\n                  key: calculatedColumn.column_name,\n                }))}\n              />\n            </FormItem>\n          ) : datasourceType === DatasourceType.Table ? (\n            <EmptyState\n              image=\"empty.svg\"\n              size=\"small\"\n              title={\n                isTemporal\n                  ? t('No temporal columns found')\n                  : t('No saved expressions found')\n              }\n              description={\n                isTemporal\n                  ? t(\n                      'Add calculated temporal columns to dataset in \"Edit datasource\" modal',\n                    )\n                  : t(\n                      'Add calculated columns to dataset in \"Edit datasource\" modal',\n                    )\n              }\n            />\n          ) : (\n            <EmptyState\n              image=\"empty.svg\"\n              size=\"small\"\n              title={\n                isTemporal\n                  ? t('No temporal columns found')\n                  : t('No saved expressions found')\n              }\n              description={\n                isTemporal ? (\n                  <>\n                    <span\n                      role=\"button\"\n                      tabIndex={0}\n                      onClick={setDatasetAndClose}\n                    >\n                      {t('Create a dataset')}\n                    </span>{' '}\n                    {t(' to mark a column as a time column')}\n                  </>\n                ) : (\n                  <>\n                    <span\n                      role=\"button\"\n                      tabIndex={0}\n                      onClick={setDatasetAndClose}\n                    >\n                      {t('Create a dataset')}\n                    </span>{' '}\n                    {t(' to add calculated columns')}\n                  </>\n                )\n              }\n            />\n          )}\n        </Tabs.TabPane>\n        <Tabs.TabPane\n          key=\"simple\"\n          tab={t('Simple')}\n          disabled={disabledTabs.has('simple')}\n        >\n          {isTemporal && simpleColumns.length === 0 ? (\n            <EmptyState\n              image=\"empty.svg\"\n              size=\"small\"\n              title={t('No temporal columns found')}\n              description={\n                datasourceType === DatasourceType.Table ? (\n                  t('Mark a column as temporal in \"Edit datasource\" modal')\n                ) : (\n                  <>\n                    <span\n                      role=\"button\"\n                      tabIndex={0}\n                      onClick={setDatasetAndClose}\n                    >\n                      {t('Create a dataset')}\n                    </span>{' '}\n                    {t(' to mark a column as a time column')}\n                  </>\n                )\n              }\n            />\n          ) : (\n            <FormItem label={simpleColumnsLabel}>\n              <Select\n                ariaLabel={simpleColumnsLabel}\n                value={selectedSimpleColumn?.column_name}\n                onChange={onSimpleColumnChange}\n                allowClear\n                autoFocus={!selectedSimpleColumn}\n                placeholder={t('%s column(s)', simpleColumns.length)}\n                options={simpleColumns.map(simpleColumn => ({\n                  value: simpleColumn.column_name,\n                  label: simpleColumn.verbose_name || simpleColumn.column_name,\n                  customLabel: (\n                    <StyledColumnOption column={simpleColumn} showType />\n                  ),\n                  key: simpleColumn.column_name,\n                }))}\n              />\n            </FormItem>\n          )}\n        </Tabs.TabPane>\n\n        <Tabs.TabPane\n          key=\"sqlExpression\"\n          tab={t('Custom SQL')}\n          disabled={disabledTabs.has('sqlExpression')}\n        >\n          <SQLEditor\n            value={\n              adhocColumn?.sqlExpression ||\n              selectedSimpleColumn?.column_name ||\n              selectedCalculatedColumn?.expression\n            }\n            onFocus={onSqlEditorFocus}\n            showLoadingForImport\n            onChange={onSqlExpressionChange}\n            width=\"100%\"\n            height={`${height - 80}px`}\n            showGutter={false}\n            editorProps={{ $blockScrolling: true }}\n            enableLiveAutocompletion\n            className=\"filter-sql-editor\"\n            wrapEnabled\n            ref={sqlEditorRef}\n            keywords={keywords}\n          />\n        </Tabs.TabPane>\n      </Tabs>\n      <div>\n        <Button buttonSize=\"small\" onClick={onResetStateAndClose} cta>\n          {t('Close')}\n        </Button>\n        <Button\n          disabled={!stateIsValid || !hasUnsavedChanges}\n          buttonStyle=\"primary\"\n          buttonSize=\"small\"\n          onClick={onSave}\n          data-test=\"ColumnEdit#save\"\n          cta\n        >\n          {t('Save')}\n        </Button>\n        {resizeButton}\n      </div>\n    </Form>\n  );\n};\n\nexport default ColumnSelectPopover;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}